!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CompressionActions=e()}(function(){return function o(n,a,r){function s(t,e){if(!a[t]){if(!n[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(l)return l(t,!0);throw(i=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",i}i=a[t]={exports:{}},n[t][0].call(i.exports,function(e){return s(n[t][1][e]||e)},i,i.exports,o,n,a,r)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<r.length;e++)s(r[e]);return s}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Callbacks=i.CompressionDialog=void 0;var o=u(e("pydio")),n=u(e("create-react-class")),a=u(e("pydio/http/api")),r=e("cells-sdk"),s=u(e("pydio/util/path")),l=e("material-ui");function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=o.default.requireLib("hoc"),p=o.ModernTextField,d=o.ModernSelectField,n=(0,n.default)({displayName:"CompressionDialog",mixins:[PydioReactUI.ActionDialogMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],getDefaultProps:function(){var e=["zip","tar","tar.gz"];return pydio.Parameters.get("multipleFilesDownloadEnabled")||e.pop(),{dialogTitleId:313,legendId:314,dialogIsModal:!0,formats:e}},getInitialState:function(){var e,t=this.props.userSelection;t.isUnique()?(e=s.default.getBasename(t.getUniqueFileName()),t.hasDir()||(e=e.substr(0,e.lastIndexOf(".")))):""===(e=s.default.getBasename(t.getContextNode().getPath()))&&(e="Archive");t=this.props.formats[0];return{archiveBase:e,compression:t,fileName:this.buildUniqueFileName(e,t)}},buildUniqueFileName:function(e,t){for(var i=0,o=e,n=e;this.props.userSelection.fileNameExists(o+"."+t,!0);)0<i&&(o=n+"-"+i),i++;return o},textFieldChange:function(e,t){this.setState({archiveBase:t,fileName:this.buildUniqueFileName(t,this.state.compression)})},selectFieldChange:function(e,t,i){this.setState({compression:i,fileName:this.buildUniqueFileName(this.state.archiveBase,i)})},submit:function(){var t=this,e=this.props.userSelection.getFileNames(),i=this.props.pydio.user.getActiveRepositoryObject().getSlug(),o=(o=i+this.props.userSelection.getContextNode().getPath()+"/"+this.state.fileName+"."+this.state.compression).replace("//","/"),o=r.RestUserJobRequest.constructFromObject({JobName:"compress",JsonParameters:JSON.stringify({archiveName:o,format:this.state.compression,nodes:e.map(function(e){return i+e})})}),e=new r.JobsServiceApi(a.default.getRestClient());console.log("Sending background job",o),e.userCreateJob("compress",o).then(function(e){t.dismiss()})},render:function(){var e=this.props.formats.map(function(e){return React.createElement(l.MenuItem,{value:e,primaryText:"."+e})}),t=this.props.pydio.MessageHash,i=this.state,o=i.compression,n=i.fileName,i={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"};return React.createElement("div",{style:{display:"flex"}},React.createElement(p,{style:{width:210,marginRight:10},onChange:this.textFieldChange,value:n,floatingLabelText:t["compression.4"],floatingLabelStyle:i}),React.createElement(d,{style:{width:160},onChange:this.selectFieldChange,value:o,floatingLabelText:t["compression.3"],floatingLabelStyle:i},e))}});i.CompressionDialog=n,i.Callbacks=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,o;return t=e,o=[{key:"compressUI",value:function(e){var t=e.getPydio(),e=t.getUserSelection();t.Parameters.get("multipleFilesDownloadEnabled")&&t.UI.openComponentInModal("CompressionActions","CompressionDialog",{userSelection:e})}},{key:"extract",value:function(e){var t=e.getPydio(),i=t.getUserSelection();i.isEmpty()||(e=i.getUniqueFileName(),"gz"===(i=s.default.getFileExtension(e))&&(i="tar.gz"),t=t.user.getActiveRepositoryObject().getSlug(),i=r.RestUserJobRequest.constructFromObject({JobName:"extract",JsonParameters:JSON.stringify({node:t+e,format:i,target:""})}),new r.JobsServiceApi(a.default.getRestClient()).userCreateJob("extract",i))}}],(i=null)&&c(t.prototype,i),o&&c(t,o),e}()},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/path":"pydio/util/path"}]},{},[1])(1)});