!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).FSActions=e()}(function(){return function i(a,n,r){function l(t,e){if(!n[t]){if(!a[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(s)return s(t,!0);throw(o=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",o}o=n[t]={exports:{}},a[t][0].call(o.exports,function(e){return l(a[t][1][e]||e)},o,o.exports,i,a,n,r)}return n[t].exports}for(var s="function"==typeof require&&require,e=0;e<r.length;e++)l(r[e]);return l}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=e("pydio/util/func"),r=e("pydio/util/dom"),l=e("pydio/util/lang");o.default=function(a){return function(){var e,t,o=r.getUrlFromBase(),i=a.repositoryId||(a.user?a.user.activeRepository:null);!a.user||(t=a.user.repositories.get(i).getSlug())&&(i="ws-"+t),e=l.trimRight(o,"/")+"/"+i+a.getUserSelection().getUniqueNode().getPath(),a.UI.openComponentInModal("PydioReactUI","PromptDialog",{dialogTitleId:369,fieldLabelId:296,defaultValue:e,submitValue:n.Empty})}},t.exports=o.default},{"pydio/util/dom":"pydio/util/dom","pydio/util/func":"pydio/util/func","pydio/util/lang":"pydio/util/lang"}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=e("pydio/http/api");o.default=function(l){return function(e,t,o,i){var a=l.user.getActiveRepositoryObject().getSlug(),n=a;!i||(i=l.user.getRepositoriesList().get(i))&&(n=i.getSlug());var r=t.getSelectedNodes(),o={nodes:r.map(function(e){return a+e.getPath()}),target:n+o,targetParent:!0};s.getRestClient().userJob(e,o).then(function(o){"move"===e?r.forEach(function(e){var t=l.MessageHash["background.move."+(e.isLeaf()?"file":"folder")];e.getMetadata().set("pending_operation",t),e.getMetadata().set("pending_operation_uuid",o.JobUuid),e.notify("meta_replaced",e)}):l.UI.displayMessage("SUCCESS",l.MessageHash["background.copy.selection"]),l.getContextHolder().setSelectedNodes([])}).catch(function(e){e=e.Detail||e.message||e;l.UI.displayMessage("ERROR",e)})}},t.exports=o.default},{"pydio/http/api":"pydio/http/api"}],3:[function(a,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(i){var e=i.MessageHash;return function(){var o=i.getUserSelection();i.UI.openComponentInModal("FSActions","TreeDialog",{isMove:!1,dialogTitle:e[159],submitValue:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];a("./applyCopyOrMove")(i)("copy",o,e,t)}})}},e.exports=t.default},{"./applyCopyOrMove":2}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("pydio/http/api"),n=(i=a)&&i.__esModule?i:{default:i},r=e("cells-sdk");o.default=function(a){var t=a.MessageHash;return function(){var e=t[176];0===a.getContextHolder().getContextNode().getPath().indexOf("/recycle_bin")&&(e=t[177]),a.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{message:e,dialogTitleId:7,validCallback:function(){var e=a.getContextHolder().getSelectedNodes(),o=a.user.getActiveRepositoryObject().getSlug(),t=new r.RestDeleteNodesRequest,i=new r.TreeServiceApi(n.default.getRestClient());t.Nodes=e.map(function(e){var t=new r.TreeNode;return t.Path=o+e.getPath(),t}),i.deleteNodes(t).then(function(t){t.DeleteJobs&&t.DeleteJobs.length&&e.forEach(function(e){e.getMetadata().set("pending_operation",t.DeleteJobs[0].Label),e.getMetadata().set("pending_operation_uuid",t.DeleteJobs[0].Uuid),e.notify("meta_replaced",e)}),a.getContextHolder().setSelectedNodes([])}).catch(function(e){a.UI.displayMessage("ERROR",e.Title||e.message)})}})}},t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=e("pydio/http/api");o.default=function(t){return function(){var e=t.getUserSelection();i.getClient().downloadSelection(e)}},t.exports=o.default},{"pydio/http/api":"pydio/http/api"}],6:[function(o,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){return function(){var e=t.getContextHolder();e.setSelectedNodes([e.getRootNode()]),o("./download")(t)()}},e.exports=t.default},{"./download":5}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("pydio/http/api"),n=(i=a)&&i.__esModule?i:{default:i},r=e("cells-sdk");o.default=function(a){var e=a.MessageHash;return function(){a.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{message:e[177],dialogTitleId:220,validCallback:function(){var e=a.user.getActiveRepositoryObject().getSlug(),t=new r.RestDeleteNodesRequest,o=new r.TreeServiceApi(n.default.getRestClient()),i=new r.TreeNode;i.Path=e+"/recycle_bin",t.Nodes=[i],o.deleteNodes(t).then(function(e){e.DeleteJobs&&e.DeleteJobs.forEach(function(e){a.UI.displayMessage("SUCCESS",e.Label)}),a.getContextHolder().requireContextChange(a.getContextHolder().getRootNode())}).catch(function(e){a.UI.displayMessage("ERROR",e.Title||e.message)})}})}},t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],8:[function(o,i,a){!function(t){!function(){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=t.pydio,e={ls:o("./ls")(e),mkdir:o("./mkdir")(e),deleteAction:o("./deleteAction")(e),rename:o("./rename")(e),applyCopyOrMove:o("./applyCopyOrMove")(e),copy:o("./copy")(e),move:o("./move")(e),upload:o("./upload")(e),download:o("./download")(e),downloadAll:o("./downloadAll")(e),emptyRecycle:o("./emptyRecycle")(e),restore:o("./restore")(e),openInEditor:o("./openInEditor")(e),ajxpLink:o("./ajxpLink")(e),openOtherEditorPicker:o("./openOtherEditorPicker")(e),lock:o("./lock")(e)};a.default=e,i.exports=a.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ajxpLink":1,"./applyCopyOrMove":2,"./copy":3,"./deleteAction":4,"./download":5,"./downloadAll":6,"./emptyRecycle":7,"./lock":9,"./ls":10,"./mkdir":11,"./move":12,"./openInEditor":13,"./openOtherEditorPicker":14,"./rename":15,"./restore":16,"./upload":17}],9:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("pydio/http/api"),r=(i=a)&&i.__esModule?i:{default:i},l=e("cells-sdk");o.default=function(n){return function(){var e=new l.UserMetaServiceApi(r.default.getRestClient()),t=new l.IdmUpdateUserMetaRequest,o=n.getContextHolder().getUniqueNode(),i=new l.IdmUserMeta;i.NodeUuid=o.getMetadata().get("uuid"),i.Namespace="content_lock",i.JsonValue=n.user.id;var a=o.getMetadata().get("sl_locked");t.Operation=a?"DELETE":"PUT",t.MetaDatas=[i],e.updateUserMeta(t).then(function(e){n.getContextHolder().requireNodeReload(o)})}},t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],10:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return function(){e.goTo(e.getUserSelection().getUniqueNode())}},t.exports=o.default},{}],11:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var n=i(e("pydio/http/api")),r=i(e("pydio/util/lang")),l=e("cells-sdk");o.default=function(a){return function(){a.UI.openComponentInModal("PydioReactUI","PromptDialog",{dialogTitleId:154,legendId:155,fieldLabelId:173,dialogSize:"sm",submitValue:function(e){if(-1!==e.indexOf("/")){var t=a.MessageHash["filename.forbidden.slash"];throw a.UI.displayMessage("ERROR",t),new Error(t)}var o=new l.TreeServiceApi(n.default.getRestClient()),i=new l.RestCreateNodesRequest,t=a.user.getActiveRepositoryObject().getSlug()+r.default.trimRight(a.getContextNode().getPath(),"/")+"/"+e,e=new l.TreeNode;e.Path=t,e.Type=l.TreeNodeType.constructFromObject("COLLECTION"),i.Nodes=[e],o.createNodes(i).then(function(e){console&&console.debug("Created nodes",e.Children)})}})}},t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang"}],12:[function(u,e,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(u("pydio/util/path")),a=o(u("pydio/util/lang")),c=u("pydio").requireLib("components").DNDActionParameter;t.default=function(l){function s(e,t){var o=t.getMetadata().has("repository_id");if(t.isLeaf()||t.getPath()===e.getPath()||!o&&a.default.trimRight(t.getPath(),"/")===i.default.getDirname(e.getPath()))throw new Error("Cannot drop on leaf or on same path");if(t.getMetadata().has("virtual_root"))throw new Error("Cannot drop on virtual root");if(e.getMetadata().has("ws_root"))throw new Error("Cannot move roots around");if("true"===t.getMetadata().get("node_readonly")||t.getMetadata().has("workspaceEntry")&&!t.getMetadata().get("workspaceEntry").allowCrossRepositoryCopy)throw new Error("Cannot drop on this branch (readonly)")}var d=l.MessageHash;return function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(t&&t instanceof c){if(t.getStep()===c.STEP_CAN_DROP){var o=t.getTarget(),i=t.getSource();return s(i,o),!1}if(t.getStep()===c.STEP_END_DRAG){try{s(t.getSource(),t.getTarget())}catch(e){return}var a=e.getDataModel(),i=t.getTarget().getPath(),o=null;if(t.getTarget().getMetadata().has("repository_id")){var o=t.getTarget().getMetadata().get("repository_id"),n=t.getTarget().getMetadata().get("workspaceEntry");if(n&&"cell"===n.getRepositoryType())return void l.UI.openComponentInModal("FSActions","CrossWsDropDialog",{target:t.getTarget(),source:t.getSource(),dropEffect:t.getDropEffect()||"move",cellWs:n})}e=u("./applyCopyOrMove")(l),n=t.getSource();-1===a.getSelectedNodes().indexOf(n)?((n=new PydioDataModel).setContextNode(a.getContextNode()),n.setSelectedNodes([t.getSource()]),e(t.getDropEffect()||"move",n,i,o)):e(t.getDropEffect()||"move",a,i,o)}}else{var r=l.getUserSelection();l.UI.openComponentInModal("FSActions","TreeDialog",{isMove:!0,dialogTitle:d[160],submitValue:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];u("./applyCopyOrMove")(l)("move",r,e,t)}})}}},e.exports=t.default},{"./applyCopyOrMove":2,pydio:"pydio","pydio/util/lang":"pydio/util/lang","pydio/util/path":"pydio/util/path"}],13:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(o){return function(e,t){t=t&&t.length?t[0]:null;o.UI.openCurrentSelectionInEditor(t)}},t.exports=o.default},{}],14:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return function(){e.UI.openComponentInModal("FSActions","OtherEditorPickerDialog",{selection:e.getUserSelection(),pydio:e})}},t.exports=o.default},{}],15:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var r=i(e("pydio/http/api")),l=i(e("pydio/util/path"));o.default=function(n){return function(){function t(o,i){if(o=o||n.getUserSelection().getUniqueNode(),-1!==i.indexOf("/"))throw new Error(n.MessageHash["filename.forbidden.slash"]);var e={nodes:[e=n.user.getActiveRepositoryObject().getSlug()+o.getPath()],target:l.default.getDirname(e)+"/"+i,targetParent:!1};r.default.getRestClient().userJob("move",e).then(function(e){var t=n.MessageHash["rename.processing"].replace("%1",o.getLabel()).replace("%2",i);n.UI.displayMessage("SUCCESS",t),a.getMetadata().set("pending_operation",t),a.getMetadata().set("pending_operation_uuid",e.JobUuid),a.notify("meta_replaced",a),n.getContextHolder().setSelectedNodes([])}).catch(function(e){e=e.Detail||e.message||e;n.UI.displayMessage("ERROR",e)})}var e,a=n.getUserSelection().getSelectedNodes()[0];a&&((e=a.notify("node_action",{type:"prompt-rename",callback:function(e){t(a,e)}}))&&!0===e[0]||!a.getParent()||a.getParent().notify("child_node_action",{type:"prompt-rename",child:a,callback:function(e){t(a,e)}}))}},t.exports=o.default},{"pydio/http/api":"pydio/http/api","pydio/util/path":"pydio/util/path"}],16:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("pydio/http/api"),n=(i=a)&&i.__esModule?i:{default:i},r=e("cells-sdk");o.default=function(a){return function(){var t=a.getContextHolder().getSelectedNodes(),o=a.user.getActiveRepositoryObject().getSlug(),e=new r.RestRestoreNodesRequest,i=new r.TreeServiceApi(n.default.getRestClient());e.Nodes=t.map(function(e){var t=new r.TreeNode;return t.Path=o+e.getPath(),t}),i.restoreNodes(e).then(function(e){e.RestoreJobs&&e.RestoreJobs.length&&t.forEach(function(t){e.RestoreJobs.forEach(function(e){e.NodeUuid===t.getMetadata().get("uuid")&&(t.getMetadata().set("pending_operation",e.Label),t.getMetadata().set("pending_operation_uuid",e.Uuid),t.notify("meta_replaced",t))})}),a.getContextHolder().setSelectedNodes([])})}},t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],17:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(i){return function(e,t){var o={};t&&t.length&&(o={uploaderProps:t[0]}),i.UI.openComponentInModal("FSActions","UploadDialog",o)}},t.exports=o.default},{}],18:[function(l,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(e,t,o){for(var i=!0;i;){var a=e,n=t,r=o,i=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,n);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=n,o=r,i=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var r=n(l("create-react-class")),s=n(l("pydio/model/meta-node-provider")),d=n(l("pydio/http/api")),u=l("cells-sdk"),c=n(l("pydio/model/cell")),p=l("material-ui/styles"),f=n(l("prop-types")),g=l("react"),y=l("material-ui"),h=y.FontIcon,m=y.ListItem,v=y.List,b=y.FlatButton,_=y.Subheader,C=l("pydio"),M=l("pydio/model/data-model"),y=C.requireLib("boot").ActionDialogMixin,x=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(w,g.Component),o(w,[{key:"componentDidMount",value:function(){var i=this,e=this.props.cellWs,t=new u.MetaServiceApi(d.default.getRestClient()),o=new u.RestGetBulkMetaRequest,a=e.getSlug();console.log(a),o.NodePaths=[a,a+"/*"],t.getBulkMeta(o).then(function(e){var e=e.Nodes||[],t=null,o=[];e.forEach(function(e){e.Path===a+"/"?t=s.default.parseTreeNode(e,a):(e=s.default.parseTreeNode(e,a)).isLeaf()||o.push(e)}),t.getMetadata().has("virtual_root")?(console.log(o),i.setState({roots:o})):(console.log(t),i.setState({roots:[t]}))})}},{key:"move",value:function(e){var t=this.props,o=t.source,i=t.cellWs,a=t.pydio,n=t.dropEffect,r=l("../callback/applyCopyOrMove")(C.getInstance()),t=a.getContextHolder();-1===t.getSelectedNodes().indexOf(o)?((a=new M).setContextNode(t.getContextNode()),a.setSelectedNodes([o]),r(n,a,e.getPath(),i.getId())):r(n,t,e.getPath(),i.getId()),this.props.onDismiss()}},{key:"share",value:function(){var e=this,t=this.props,o=t.source,i=t.cellWs,a=t.pydio,n=new c.default;n.load(i.getId()).then(function(){n.addRootNode(o),n.save().then(function(){e.props.onDismiss(),a.triggerRepositoryChange(i.getId())})})}},{key:"render",value:function(){function o(e){return r.MessageHash["openother.drop.cell."+e]||e}var i=this,e=this.props,t=e.source,a=e.cellWs,n=e.dropEffect,r=e.pydio,l=e.muiTheme,s=this.state.roots,d=[];d.push(g.createElement(m,{onClick:function(){i.share()},primaryText:t.isLeaf()?o("file.share"):o("folder.share"),secondaryText:o("share.legend").replace("%s",a.getLabel()),leftIcon:g.createElement(h,{style:{color:l.palette.primary1Color},className:"mdi mdi-share-variant"})}));var e=t.isLeaf()?"file":"folder",u=o(e+"."+n);return s.forEach(function(e){var t=o("copymove.legend").replace("%s",a.getLabel());"/"!==e.getPath()&&""!==e.getPath()&&(t+="/"+e.getLabel()),d.push(g.createElement(m,{onClick:function(){i.move(e)},primaryText:u,secondaryText:t,leftIcon:g.createElement(h,{style:{color:l.palette.primary1Color},className:"mdi mdi-folder-"+("copy"===n?"plus":"move")})}))}),g.createElement(v,{style:{maxHeight:320,overflowY:"scroll",width:"100%",borderTop:"1px solid #e0e0e0"}},g.createElement(_,{style:{overflow:"hidden",whiteSpace:"nowrap",paddingRight:16,textOverflow:"ellipsis"}},o("picker").replace("%s",t.getLabel())),d)}}]),w);function w(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),a(Object.getPrototypeOf(w.prototype),"constructor",this).call(this,e),this.state={roots:[]}}x=(0,p.muiThemeable)()(x),y=(0,r.default)({propTypes:{pydio:f.default.instanceOf(C),selection:f.default.instanceOf(M)},mixins:[y],getButtons:function(e){var t=[],o=this.props.pydio.MessageHash;return t.push(g.createElement(b,{label:o[49],primary:!0,keyboardFocused:!0,onClick:this.props.onDismiss})),t},getDefaultProps:function(){return{dialogIsModal:!1,dialogSize:"sm",dialogPadding:0}},render:function(){return g.createElement(x,this.props)}});t.default=y,e.exports=t.default},{"../callback/applyCopyOrMove":2,"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/cell":"pydio/model/cell","pydio/model/data-model":"pydio/model/data-model","pydio/model/meta-node-provider":"pydio/model/meta-node-provider",react:"react"}],19:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var l=i(e("../callback/openInEditor")),a=i(e("create-react-class")),n=i(e("prop-types")),r=e("react"),s=e("material-ui"),d=s.FontIcon,u=s.ListItem,c=s.List,p=s.FlatButton,f=e("pydio"),s=e("pydio/model/data-model"),g=e("pydio/util/lang"),e=f.requireLib("boot").ActionDialogMixin,e=(0,a.default)({propTypes:{pydio:n.default.instanceOf(f),selection:n.default.instanceOf(s)},mixins:[e],getButtons:function(e){var t=[],o=this.props.pydio.MessageHash;return t.push(r.createElement(p,{key:"clear",label:MessageHash["openother.5"],primary:!1,onClick:this.clearAssociations})),t.push(r.createElement(p,{label:o[49],primary:!0,keyboardFocused:!0,onClick:this.props.onDismiss})),t},getDefaultProps:function(){return{dialogTitleId:"openother.2",dialogIsModal:!1,dialogSize:"sm",dialogPadding:0}},findActiveEditors:function(e){var t=[],o=!1,i=this.props.pydio;return null==this.user||this.user.canWrite()||(o=!0),i.Registry.getActiveExtensionByType("editor").forEach(function(e){o&&e.write||e.openable&&t.push(e)}),t},clearAssociations:function(){var t,o,e=this,i=this.props.selection.getUniqueNode().getAjxpMime(),a=void 0,n=void 0;try{a=this.props.pydio.user.getPreference("gui_preferences",!0),n=a.other_editor_extensions}catch(e){}n&&n[i]&&(t=n[i],o=void 0,e.props.pydio.Registry.getActiveExtensionByType("editor").forEach(function(e){e.editorClass===t&&(o=e)}),o&&-1!==o.mimes.indexOf(i)&&(o.mimes=g.arrayWithout(o.mimes,o.mimes.indexOf(i))),delete n[i],a.other_editor_extensions=n,e.props.pydio.user.setPreference("gui_preferences",a,!0),e.props.pydio.user.savePreference("gui_preferences")),this.props.onDismiss()},selectEditor:function(e,t){var o=this.props,i=o.pydio,a=o.selection.getUniqueNode().getAjxpMime();e.mimes.push(a);var n,r=i.user;r&&((o=(n=r.getPreference("gui_preferences",!0)||{}).other_editor_extensions||{})[a]=e.editorClass,n.other_editor_extensions=o,r.setPreference("gui_preferences",n,!0),r.savePreference("gui_preferences"),(0,l.default)(i)(null,[e]),this.dismiss())},render:function(){var o=this,e=this.findActiveEditors("*").map(function(e){var t=r.createElement(d,{className:e.icon_class});return r.createElement(u,{onClick:o.selectEditor.bind(o,e),primaryText:e.text,secondaryText:e.title,leftIcon:t})});return r.createElement(c,{style:{maxHeight:320,overflowY:"scroll",width:"100%",borderTop:"1px solid #e0e0e0"}},e)}});o.default=e,t.exports=o.default},{"../callback/openInEditor":13,"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/util/lang":"pydio/util/lang",react:"react"}],20:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}Object.defineProperty(o,"__esModule",{value:!0});var l=i(e("react")),a=i(e("pydio")),n=i(e("prop-types")),s=i(e("create-react-class")),d=i(e("pydio/util/lang")),u=e("cells-sdk"),c=i(e("pydio/model/data-model")),p=e("material-ui"),e=a.default.requireLib("hoc"),f=e.ModernTextField,g=e.ModernSelectField,y=a.default.requireLib("components").FoldersTree,n=(0,s.default)({propTypes:{isMove:n.default.bool.isRequired,submitValue:n.default.func.isRequired},mixins:[PydioReactUI.ActionDialogMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],getDefaultProps:function(){return{dialogTitle:"Copy/Move",dialogIsModal:!0,dialogScrollBody:!0}},submit:function(){this.props.submitValue(this.state.selectedNode.getPath(),"__CURRENT__"===this.state.wsId?null:this.state.wsId),this.dismiss()},getInitialState:function(){var e=this.getCurrentDataModel(),t=e.getRootNode();return t.load(e.getAjxpNodeProvider()),{dataModel:e,selectedNode:t,wsId:t.getMetadata().get("repository_id")||"__CURRENT__"}},getCurrentDataModel:function(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=this.props.pydio.user,o=void 0,i=t.getRepositoriesList().get(t.activeRepository).getLabel();null!==e&&"__CURRENT__"!==e?(o=e,i=t.getCrossRepositories().get(e).getLabel()):null===e&&!t.canWrite()&&t.canCrossRepositoryCopy()&&t.hasCrossRepositories()&&(o=t.getCrossRepositories().keys().next().value,i=t.getCrossRepositories().get(o).getLabel());t=c.default.RemoteDataModelFactory(o?{tmp_repository_id:o}:{},i),i=t.getRootNode();return o&&i.getMetadata().set("repository_id",o),t},onNodeSelected:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({selectedNode:e})},createNewFolder:function(){var o=this,e=this.props.pydio,i=this.state.selectedNode,a=this.refs.newfolder_input.getValue(),t=e.user.getActiveRepositoryObject().getSlug();"__CURRENT__"!==this.state.wsId&&(t=e.user.getRepositoriesList().get(this.state.wsId).getSlug());var n=new u.TreeServiceApi(PydioApi.getRestClient()),r=new u.RestCreateNodesRequest,e=t+d.default.trimRight(i.getPath(),"/")+"/"+a,t=new u.TreeNode;t.Path=e,t.Type=u.TreeNodeType.constructFromObject("COLLECTION"),r.Nodes=[t],n.createNodes(r).then(function(e){var t=i.getPath()+"/"+a;i.observeOnce("loaded",function(){var e=i.getChildren().get(t);e&&o.setState({selectedNode:e})}),setTimeout(function(){return i.reload()},1500),o.setState({newFolderFormOpen:!1})})},handleRepositoryChange:function(e,t,o){var i=this.getCurrentDataModel(o),a=i.getRootNode();a.load(),this.setState({dataModel:i,selectedNode:a,wsId:o})},render:function(){function e(){t.setState({newFolderFormOpen:!t.state.newFolderFormOpen})}var o,t=this,i=this.props.pydio.user,a=l.default.createElement("div",{style:{height:30}});i&&i.canCrossRepositoryCopy()&&i.hasCrossRepositories()&&(n=[],o=[],i.canWrite()&&n.push(l.default.createElement(p.MenuItem,{key:"current",value:"__CURRENT__",primaryText:t.props.pydio.MessageHash[372]})),i.getCrossRepositories().forEach(function(e,t){o.push({label:e.getLabel(),item:l.default.createElement(p.MenuItem,{key:t,value:t,primaryText:e.getLabel()})})}),o.sort(function(e,t){return e.label.localeCompare(t.label,void 0,{numeric:!0})}),n=[].concat(r(n),r(o.map(function(e){return e.item}))),a=l.default.createElement("div",null,l.default.createElement(g,{style:{width:"100%"},floatingLabelText:t.props.pydio.MessageHash[373],value:t.state.wsId,onChange:t.handleRepositoryChange},n)));var n=this.state.newFolderFormOpen;return l.default.createElement("div",{style:{width:"100%",paddingTop:18}},a,l.default.createElement(p.Paper,{zDepth:0,style:{height:300,overflowX:"auto",color:"#546E7A",fontSize:14,padding:"6px 0px",backgroundColor:"#f5f5f5",marginTop:4}},l.default.createElement("div",{style:{marginTop:-41,marginLeft:-21}},l.default.createElement(y,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected,showRoot:!0,draggable:!1}))),l.default.createElement(p.Paper,{className:"bezier-transitions",zDepth:0,style:{display:"flex",alignItems:"baseline",height:n?50:0,overflow:n?"visible":"hidden",opacity:n?1:0,padding:0,marginTop:n?0:4}},l.default.createElement(f,{fullWidth:!0,floatingLabelText:this.props.pydio.MessageHash[173],ref:"newfolder_input",style:{flex:1}}),l.default.createElement(p.IconButton,{iconClassName:"mdi mdi-check",iconStyle:{color:"#546E7A"},tooltip:this.props.pydio.MessageHash[48],onClick:function(){t.createNewFolder()}}),l.default.createElement(p.IconButton,{iconClassName:"mdi mdi-close",iconStyle:{color:"#546E7A"},tooltip:this.props.pydio.MessageHash[49],onClick:e})),l.default.createElement("div",{style:{display:"flex",alignItems:"center"}},l.default.createElement(f,{style:{flex:1,width:"100%",marginRight:10},floatingLabelText:this.props.pydio.MessageHash[373],ref:"input",value:this.state.selectedNode.getPath(),disabled:!1,onChange:function(){}}),!n&&l.default.createElement(p.IconButton,{iconClassName:"mdi mdi-folder-plus",style:{height:38,width:38,padding:6},iconStyle:{color:"#546E7A",fontSize:24},tooltip:this.props.pydio.MessageHash[154],tooltipPosition:"top-left",onClick:e})))}});o.default=n,t.exports=o.default},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/util/lang":"pydio/util/lang",react:"react"}],21:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,i=arguments[t];for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},i=function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e};function a(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=function(e,t,o){for(var i=!0;i;){var a=e,n=t,r=o,i=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,n);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=n,o=r,i=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var s=r(e("react")),d=r(e("pydio")),u=r(e("create-react-class")),c=e("material-ui"),p=e("material-ui/styles"),f=d.default.requireLib("boot"),e=f.ActionDialogMixin,g=f.AsyncComponent,y=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,s["default"].Component),i(h,[{key:"render",value:function(){var e=this.props,t=e.tabs,o=e.dismiss,e=e.muiTheme;return s.default.createElement("div",{style:{display:"flex",backgroundColor:e.tabs.backgroundColor}},s.default.createElement(c.Tabs,{style:{flex:1}},t),s.default.createElement(c.IconButton,{iconStyle:{color:e.tabs.selectedTextColor},iconClassName:"mdi mdi-close",onClick:o,tooltip:"Close"}))}}]),h);function h(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),n(Object.getPrototypeOf(h.prototype),"constructor",this).apply(this,arguments)}y=(0,p.muiThemeable)()(y),e=(0,u.default)({mixins:[e],getDefaultProps:function(){return{dialogTitle:"",dialogSize:d.default.getInstance().UI.MOBILE_EXTENSIONS?"md":"lg",dialogPadding:!1,dialogIsModal:!1}},getInitialState:function(){var e=this.props.pydio.Registry.getActiveExtensionByType("uploader").filter(function(e){return e.moduleName});e.sort(function(e,t){return e.order-t.order});var t=void 0;return{uploaders:e,current:t=e.length?e[0]:t,loaded:!1}},render:function(){function e(){t.dismiss()}var t=this,o=[],i=s.default.createElement("div",{style:{height:360}}),a=this.state,n=a.uploaders,r=a.current,a=a.loaded;return n.map(function(e){o.push(s.default.createElement(c.Tab,{label:e.xmlNode.getAttribute("label"),key:e.id,onActive:function(){t.setState({current:e})}}))}),r&&(r=r.moduleName.split("."),i=s.default.createElement(g,l({pydio:this.props.pydio,namespace:r[0],componentName:r[1],onDismiss:e,showDismiss:1===o.length,onLoad:function(){t.setState({loaded:!0})}},this.props.uploaderProps))),s.default.createElement("div",{style:{width:"100%"}},1<o.length&&s.default.createElement(y,{tabs:o,dismiss:e}),i,!a&&s.default.createElement("div",{style:{padding:"100px 40px",textAlign:"center",color:"rgba(0,0,0,.5)"}},this.props.pydio.MessageHash[466]))}});o.default=e,t.exports=o.default},{"create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],22:[function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var a=i(e("./dialog/OtherEditorPickerDialog")),n=i(e("./dialog/TreeDialog")),r=i(e("./dialog/UploadDialog")),l=i(e("./dialog/CrossWsDropDialog")),s=i(e("./callback/index")),e=i(e("./listener/index"));o.Callbacks=s.default,o.Listeners=e.default,o.UploadDialog=r.default,o.OtherEditorPickerDialog=a.default,o.TreeDialog=n.default,o.CrossWsDropDialog=l.default},{"./callback/index":8,"./dialog/CrossWsDropDialog":18,"./dialog/OtherEditorPickerDialog":19,"./dialog/TreeDialog":20,"./dialog/UploadDialog":21,"./listener/index":27}],23:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){var e=t.getUserSelection();t.Parameters.get("zipEnabled")&&t.Parameters.get("multipleFilesDownloadEnabled")||(e.isUnique()?this.selectionContext.multipleOnly=!0:this.selectionContext.unique=!0)}},t.exports=o.default},{}],24:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){this.rightsContext.write=!0;var e=t.user;e&&e.canRead()&&e.canCrossRepositoryCopy()&&e.hasCrossRepositories()&&(this.rightsContext.write=!1,e.canWrite()||(t.getController().defaultActions.delete("ctrldragndrop"),t.getController().defaultActions.delete("dragndrop"))),e&&e.canWrite()&&t.getContextNode().hasAjxpMimeInBranch("ajxp_browsable_archive")&&(this.rightsContext.write=!1),t.getContextNode().hasAjxpMimeInBranch("ajxp_browsable_archive")?this.setLabel(247,248):this.setLabel(66,159)}},t.exports=o.default},{}],25:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return function(){e.Parameters.get("zipEnabled")&&e.Parameters.get("multipleFilesDownloadEnabled")||(this.hide(),e.Controller.actions.delete("download_all"))}},t.exports=o.default},{}],26:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){var e=t.getUserSelection();t.Parameters.get("zipEnabled")&&t.Parameters.get("multipleFilesDownloadEnabled")||e.hasDir()&&(this.selectionContext.dir=!1)}},t.exports=o.default},{}],27:[function(o,i,a){!function(t){!function(){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=t.pydio,e={mkfileDynamicBuilder:o("./mkfileDynamicBuilder")(e),downloadSelectionChange:o("./downloadSelectionChange")(e),downloadAllInit:o("./downloadAllInit")(e),compressUiSelectionChange:o("./compressUiSelectionChange")(e),copyContextChange:o("./copyContextChange")(e),openWithDynamicBuilder:o("./openWithDynamicBuilder")(e),lockSelectionChange:o("./lockSelectionChange")(e)};a.default=e,i.exports=a.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./compressUiSelectionChange":23,"./copyContextChange":24,"./downloadAllInit":25,"./downloadSelectionChange":26,"./lockSelectionChange":28,"./mkfileDynamicBuilder":29,"./openWithDynamicBuilder":30}],28:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(o){return function(){var e=o.getController().getActionByName("sl_lock"),t=o.getUserSelection().getUniqueNode();e&&t&&(e.selectionContext.allowedMimes=[],t.getMetadata().get("sl_locked")?(e.setIconClassName("mdi mdi-lock-outline"),e.setLabel("meta.simple_lock.3"),t.getMetadata().get("sl_mylock")||(e.selectionContext.allowedMimes=["fake_extension_that_never_exists"])):(e.setIconClassName("mdi mdi-lock-outline"),e.setLabel("meta.simple_lock.1")))}},t.exports=o.default},{}],29:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e};function a(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e){return e&&e.__esModule?e:{default:e}}var r=n(e("pydio")),s=n(e("pydio/util/path")),d=e("cells-sdk"),u=void 0,c=void 0,l=(i(p,null,[{key:"dynamicBuilder",value:function(){var t,o=this,l=r.default.getInstance();if(null!==u&&(this.__loadedTemplates=u),this.__loadedTemplates){var e=(t={doc:"file-word",docx:"file-word",odt:"file-word",odg:"file-chart",odp:"file-powerpoint",ods:"file-excel",pot:"file-powerpoint",pptx:"file-powerpoint",rtf:"file-word",xls:"file-excel",xlsx:"file-excel"},{v:o.__loadedTemplates.map(function(n){var r=void 0,r=n.UUID?s.default.getFileExtension(n.UUID):"txt",e=t[r]?t[r]:"file";return{name:n.Label,alt:n.Label,icon_class:"mdi mdi-"+e,callback:function(e){var t,a,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:i=l.user.getRepositoriesList(),o=l.getContextHolder().getContextNode(),t=i.get(l.user.activeRepository).getSlug(),i=l.MessageHash["mkfile.untitled.document"]||"Untitled",i=(i=t+o.getPath()+"/"+i+"."+r).replace("//","/"),a=s.default.getDirname(i),o=function(e,t){function o(t){var o=!1;return i.forEach(function(e){e.getLabel()===t&&(o=!0)}),o}var i=e.getChildren(),e=t.lastIndexOf("."),a=t.substring(0,e),n=t.substring(e),r=t,l=1,s=o(r);for(;s;)r=a+"-"+l+n,l++,s=o(r);return r}(o,s.default.getBasename(i)),i=function(e){if(-1!==e.indexOf("/")){var t=l.MessageHash["filename.forbidden.slash"];throw l.UI.displayMessage("ERROR",t),new Error(t)}var o=new d.TreeServiceApi(PydioApi.getRestClient()),i=new d.RestCreateNodesRequest,t=new d.TreeNode;t.Path=a+"/"+e,t.Type=d.TreeNodeType.constructFromObject("LEAF"),i.Nodes=[t],i.TemplateUUID=n.UUID,o.createNodes(i).then(function(e){})},l.UI.openComponentInModal("PydioReactUI","PromptDialog",{dialogTitleId:156,legendId:n.Label,fieldLabelId:174,dialogSize:"sm",defaultValue:o,defaultInputSelection:!0,submitValue:i});case 10:case"end":return e.stop()}},null,this)}.bind(o)}})});if("object"==typeof e)return e.v}return c&&clearTimeout(c),new d.TemplatesServiceApi(PydioApi.getRestClient()).listTemplates().then(function(e){o.__loadedTemplates=e.Templates;var t=new d.RestTemplate;t.Label=l.MessageHash["mkfile.empty.template.label"]||"Empty File",t.UUID="",o.__loadedTemplates.unshift(t),u=e.Templates,c=setTimeout(function(){u=null},2e3),r.default.getInstance().getController().fireContextChange()}),[]}}]),p);function p(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p)}o.default=function(e){return l.dynamicBuilder},t.exports=o.default},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/util/path":"pydio/util/path"}],30:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var c=e("pydio/util/path");o.default=function(s){var d=e("../callback/openOtherEditorPicker")(s),u=s.MessageHash;return function(){var e=this,o=[];if(s.getUserSelection().isEmpty())return o;var i,t=s.getUserSelection().getUniqueNode(),a=c.getAjxpMimeType(t),n="true"===t.getMetadata().get("node_readonly"),t=s.user;t&&t.getPreference("gui_preferences",!0)&&t.getPreference("gui_preferences",!0).other_editor_extensions&&(i=t.getPreference("gui_preferences",!0).other_editor_extensions,Object.keys(i).forEach(function(t){var o=void 0;s.Registry.getActiveExtensionByType("editor").forEach(function(e){e.editorClass===i[t]&&(o=e)}),o&&-1===o.mimes.indexOf(t)&&o.mimes.push(t)}.bind(e)));var a=s.Registry.findEditorsForMime(a),r=0,l=!1;return a.length&&(a.forEach(function(t){t.openable&&(t.write&&n||(-1<t.mimes.indexOf("*")&&(!l&&0<r&&o.push({separator:!0}),l=!0),o.push({name:t.text,alt:t.title,isDefault:0===r,icon_class:t.icon_class,callback:function(e){this.apply([t])}.bind(this)}),r++))}.bind(this)),o.push({name:u["openother.1"],alt:u["openother.2"],isDefault:0===r,icon_class:"icon-list-alt",callback:d})),r||o.push({name:u[324],alt:u[324],callback:function(e){}}),o}},t.exports=o.default},{"../callback/openOtherEditorPicker":14,"pydio/util/path":"pydio/util/path"}]},{},[22])(22)});