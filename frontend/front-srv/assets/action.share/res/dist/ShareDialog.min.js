!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ShareDialog=e()}(function(){return function n(i,a,r){function l(t,e){if(!a[t]){if(!i[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(s)return s(t,!0);throw(o=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",o}o=a[t]={exports:{}},i[t][0].call(o.exports,function(e){return l(i[t][1][e]||e)},o,o.exports,n,i,a,r)}return a[t].exports}for(var s="function"==typeof require&&require,e=0;e<r.length;e++)l(r[e]);return l}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e};function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=e("prop-types"),l=e("react");o.default=function(t){var e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,l.Component),i(o,[{key:"render",value:function(){var e=this.context,e={messages:e.messages,getMessage:e.getMessage,isReadonly:e.isReadonly};return l.createElement(t,n({},this.props,e))}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}}(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments)}return e.contextTypes={messages:r.object,getMessage:r.func,isReadonly:r.func},e},t.exports=o.default},{"prop-types":"prop-types",react:"react"}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e};function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var g=l(e("react")),s=l(e("pydio")),v=l(e("./EditCellDialog")),u=l(e("pydio/model/cell")),d=l(e("pydio/http/resources-manager")),b=e("material-ui"),c=l(e("../main/ShareHelper")),s=s.default.requireLib("components"),k=s.GenericCard,E=s.GenericLine,w=s.QuotaUsageLine,i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,g["default"].Component),i(p,[{key:"componentDidMount",value:function(){var t=this,e=this.props,o=e.pydio,e=e.cellId;o.user.activeRepository===e?o.user.getActiveRepositoryAsCell().then(function(e){t.setState({model:e,loading:!1}),e.observe("update",t._observer)}):(this.state.model.observe("update",function(){t.setState({loading:!1}),t.forceUpdate()}),this.state.model.load(this.props.cellId))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update",this._observer)}},{key:"usersInvitations",value:function(e){c.default.sendCellInvitation(this.props.node,this.state.model,e)}},{key:"render",value:function(){function s(e){return c.MessageHash["share_center."+e]}var u=this,e=this.props,d=e.mode,c=e.pydio,t=e.editorOneColumn,o=this.state,e=o.edit,p=o.model,f=o.extLibs,h=o.rootNodes,y=o.loading,o={width:350,minHeight:270},m=void 0;if(e)o=t?{width:350,height:500}:{width:700,height:500},m=g.default.createElement(v.default,n({},this.props,{model:p,sendInvitations:this.usersInvitations.bind(this),editorOneColumn:t}));else if(p){t=function(){var e=(e=p.getRootNodes().map(function(e){return p.getNodeLabelInContext(e)}).join(", "))||p.getRootNodes().length+" item(s)",t=void 0,o=void 0,n=void 0;"infoPanel"!==d&&(n=[],p.getUuid()!==c.user.activeRepository&&n.push(g.default.createElement(b.MenuItem,{primaryText:s(246),onClick:function(){c.triggerRepositoryChange(p.getUuid()),u.props.onDismiss()}})),p.isEditable()&&(t=function(){p.deleteCell().then(function(e){u.props.onDismiss()})},o=function(){u.setState({edit:!0}),u.props.onHeightChange&&u.props.onHeightChange(500)},n.push(g.default.createElement(b.MenuItem,{primaryText:s(247),onClick:function(){return u.setState({edit:!0})}})),n.push(g.default.createElement(b.MenuItem,{primaryText:s(248),onClick:t}))));var i,a=void 0,r=[],l=void 0;if(f&&h&&!y&&(i=g.default.createElement(PydioActivityStreams.WatchSelector,{pydio:c,nodes:h}),a=g.default.createElement(E,{iconClassName:"mdi mdi-bell-outline",legend:c.MessageHash["meta.watch.selector.legend"],data:i,iconStyle:{marginTop:32}}),l=g.default.createElement(PydioCoreActions.BookmarkButton,{pydio:c,nodes:h,styles:{iconStyle:{color:"white"}}})),h&&!y&&h.forEach(function(e){e.getMetadata().get("ws_quota")&&r.push(g.default.createElement(w,{node:e}))}),m=g.default.createElement(k,{pydio:c,title:p.getLabel(),onDismissAction:u.props.onDismiss,otherActions:l,onDeleteAction:t,onEditAction:o,headerSmall:"infoPanel"===d,moreMenuItems:n},!y&&p.getDescription()&&g.default.createElement(E,{iconClassName:"mdi mdi-information",legend:s(145),data:p.getDescription()}),g.default.createElement(E,{iconClassName:"mdi mdi-account-multiple",legend:s(54),data:p.getAclsSubjects(),placeHolder:!0,placeHolderReady:!y}),g.default.createElement(E,{iconClassName:"mdi mdi-folder",legend:s(249),data:e,placeHolder:!0,placeHolderReady:!y}),r,a||g.default.createElement(E,{placeHolder:!0})),"infoPanel"===d)return{v:m}}();if("object"==typeof t)return t.v}return g.default.createElement(b.Paper,{zDepth:0,style:o},m)}}]),p);function p(e){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),r(Object.getPrototypeOf(p.prototype),"constructor",this).call(this,e),this.state={edit:!1,model:new u.default,loading:!0},this._observer=function(){o.forceUpdate()},d.default.loadClassesAndApply(["PydioActivityStreams","PydioCoreActions"],function(){o.setState({extLibs:!0})});var n=this.props.rootNode;n&&(n.getMetadata().has("virtual_root")?n.isLoaded()?(this.state.rootNodes=[],n.getChildren().forEach(function(e){return o.state.rootNodes.push(e)})):(n.observe("loaded",function(){var t=[];n.getChildren().forEach(function(e){return t.push(e)}),o.setState({rootNodes:t})}),n.load()):this.state.rootNodes=[n])}o.default=i,t.exports=o.default},{"../main/ShareHelper":29,"./EditCellDialog":4,"material-ui":"material-ui",pydio:"pydio","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/cell":"pydio/model/cell",react:"react"}],3:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var s=r(e("react")),l=r(e("prop-types")),u=r(e("pydio")),d=e("material-ui"),c=e("material-ui/styles"),p=r(e("./SharedUsers")),f=r(e("./NodesPicker")),h=r(e("pydio/model/cell")),y=u.default.requireLib("hoc").ModernTextField,l=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,s["default"].Component),n(m,[{key:"getChildContext",value:function(){var o=this.props.pydio.MessageHash;return{messages:o,getMessage:function(t){var e=arguments.length<=1||void 0===arguments[1]?"share_center":arguments[1];try{return o[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){var e=this;this.refs.title.focus(),this.state.model.observe("update",function(){e.forceUpdate()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"render",value:function(){var e=this,t=[],o=void 0,n=this.props.pydio,i=this.state,a=i.step,r=i.model,l=i.saving,i=n.MessageHash[418];return"users"!==a&&(i=r.getLabel()),"users"===a?(o=s.default.createElement("div",null,s.default.createElement("div",null,this.m(275)),s.default.createElement(y,{ref:"title",floatingLabelText:this.m(276),value:r.getLabel(),onChange:function(e,t){r.setLabel(t)},fullWidth:!0}),s.default.createElement(y,{floatingLabelText:this.m(277),value:r.getDescription(),onChange:function(e,t){r.setDescription(t)},fullWidth:!0})),r.getLabel()&&(t.push(s.default.createElement(d.FlatButton,{key:"quick",primary:!0,disabled:!r.getLabel()||l,label:this.m("cells.create.advanced"),onClick:function(){e.setState({step:"data"})}})),t.push(s.default.createElement("span",{style:{display:"inline-block",margin:"0  10px",fontSize:14,fontWeight:500,color:"#9E9E9E"}},this.m("cells.create.buttons.separator")))),t.push(s.default.createElement(d.RaisedButton,{key:"next1",disabled:!r.getLabel()||l,primary:!0,label:this.m(279),onClick:function(){e.submit()}}))):"data"===a?(o=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m(278)),s.default.createElement(p.default,{pydio:n,cellAcls:r.getAcls(),excludes:[n.user.id],onUserObjectAdd:r.addUser.bind(r),onUserObjectRemove:r.removeUser.bind(r),onUserObjectUpdateRight:r.updateUserRight.bind(r)})),t.push(s.default.createElement(d.FlatButton,{key:"prev1",primary:!1,label:n.MessageHash[304],onClick:function(){e.setState({step:"users"})}})),t.push(s.default.createElement(d.FlatButton,{key:"next2",primary:!0,label:n.MessageHash[179],onClick:function(){return e.setState({step:"label"})}}))):(o=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m("cells.create.title.fill.folders")),s.default.createElement("div",{style:{color:"#9e9e9e"}},this.computeSummaryString()),s.default.createElement("div",{style:{paddingTop:16}},s.default.createElement(f.default,{pydio:n,model:r}))),t.push(s.default.createElement(d.FlatButton,{key:"prev2",primary:!1,label:n.MessageHash[304],onClick:function(){e.setState({step:"data"})}})),t.push(s.default.createElement(d.RaisedButton,{key:"submit",disabled:l,primary:!0,label:this.m(279),onClick:this.submit.bind(this)}))),s.default.createElement("div",{style:{width:380,fontSize:13,color:"rgba(0,0,0,.87)",display:"flex",flexDirection:"column",minHeight:300}},s.default.createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:20}},s.default.createElement(d.FontIcon,{className:"icomoon-cells-full-plus"}),s.default.createElement("div",{style:{padding:20,fontSize:22}},i)),s.default.createElement("div",{style:{padding:"20px 20px 10px",flex:1}},o),s.default.createElement("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"flex-end"}},t))}}],[{key:"childContextTypes",value:{messages:l.default.object,getMessage:l.default.func,isReadonly:l.default.func},enumerable:!0}]),m);function m(){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),a(Object.getPrototypeOf(m.prototype),"constructor",this).apply(this,arguments),this.state={step:"users",model:new h.default,saving:!1},this.submit=function(){var e=r.state.model;r.setState({saving:!0}),e.save().then(function(e){r.props.onDismiss(),r.setState({saving:!1})}).catch(function(e){pydio.UI.displayMessage("ERROR",e.message),r.setState({saving:!1})})},this.m=function(e){return r.props.pydio.MessageHash["share_center."+e]},this.computeSummaryString=function(){var e=r.state.model,t=0,o=0,n=0,i=[],a=e.getAcls();Object.keys(a).map(function(e){e=a[e];e.Group?o++:e.Role?n++:t++}),t&&i.push(t+" "+r.m(270)),o&&i.push(o+" "+r.m(271)),n&&i.push(n+" "+r.m(272));e=void 0,e=3===i.length?i[0]+", "+i[1]+r.m(274)+i[3]:0===i.length?r.m(273):i.join(r.m(274));return r.m(269).replace("%USERS",e)}}o.default=l=(0,c.muiThemeable)()(l),o.default=l,t.exports=o.default},{"./NodesPicker":5,"./SharedUsers":7,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/model/cell":"pydio/model/cell",react:"react"}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var l=r(e("./SharedUsers")),s=r(e("./NodesPicker")),u=r(e("../main/GenericEditor")),d=r(e("prop-types")),c=r(e("pydio")),p=e("react"),f=c.default.requireLib("components").ResourcePoliciesPanel,h=c.default.requireLib("hoc").ModernTextField,d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,p.Component),n(y,[{key:"getChildContext",value:function(){var o=this.props.pydio.MessageHash;return{messages:o,getMessage:function(t){var e=arguments.length<=1||void 0===arguments[1]?"share_center":arguments[1];try{return o[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}}}},{key:"render",value:function(){var e=this.props,t=e.pydio,o=e.model,n=e.sendInvitations,i=function(e){return t.MessageHash["share_center."+e]},e=p.createElement("div",null,p.createElement(h,{floatingLabelText:i(267),value:o.getLabel(),onChange:function(e,t){o.setLabel(t)},fullWidth:!0}),p.createElement(h,{floatingLabelText:i(268),value:o.getDescription(),onChange:function(e,t){o.setDescription(t)},fullWidth:!0})),i={left:[{Label:i(54),Value:"users",Component:p.createElement(l.default,{pydio:t,cellAcls:o.getAcls(),excludes:[t.user.id],sendInvitations:n,onUserObjectAdd:o.addUser.bind(o),onUserObjectRemove:o.removeUser.bind(o),onUserObjectUpdateRight:o.updateUserRight.bind(o)})},{Label:i(253),Value:"permissions",AlwaysLast:!0,Component:p.createElement(f,{pydio:t,resourceType:"cell",description:i("cell.visibility.advanced"),resourceId:o.getUuid(),style:{margin:-10},skipTitle:!0,onSavePolicies:function(){},readonly:!1,cellAcls:o.getAcls()})}],right:[{Label:i(249),Value:"content",Component:p.createElement(s.default,{pydio:t,model:o,mode:"edit"})}]};return p.createElement(u.default,{pydio:t,tabs:i,header:e,editorOneColumn:this.props.editorOneColumn,saveEnabled:o.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){o.revertChanges()}})}}],[{key:"childContextTypes",value:{messages:d.default.object,getMessage:d.default.func,isReadonly:d.default.func},enumerable:!0}]),y);function y(){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),a(Object.getPrototypeOf(y.prototype),"constructor",this).apply(this,arguments),this.submit=function(){var e=i.props,t=e.model,o=e.pydio,n=t.hasDirtyRootNodes();t.save().then(function(e){i.forceUpdate(),n&&t.getUuid()===o.user.getActiveRepository()&&(o.goTo("/"),o.fireContextRefresh())}).catch(function(e){o.UI.displayMessage("ERROR",e.message)})}}o.default=d,t.exports=o.default},{"../main/GenericEditor":27,"./NodesPicker":5,"./SharedUsers":7,"prop-types":"prop-types",pydio:"pydio",react:"react"}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}var d=a(e("react")),c=e("material-ui"),r=e("material-ui/styles"),u=a(e("pydio/model/data-model")),p=e("pydio").requireLib("components").FoldersTree,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,d["default"].Component),n(f,[{key:"switchWorkspace",value:function(e){var t=u.default.RemoteDataModelFactory({tmp_repository_id:e.getId()}),o=t.getRootNode();o.getMetadata().set("repository_id",e.getId()),o.load(t.getAjxpNodeProvider()),this.setState({crtWs:e,dataModel:t})}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.setState({open:!0,anchorEl:e.currentTarget})}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"onValidateNode",value:function(){var e=this.state,t=e.node,e=e.crtWs;this.props.model.addRootNode(t,e.getId()),this.handleRequestClose()}},{key:"onNodeSelected",value:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({node:e})}},{key:"renderNodeLine",value:function(e){var t=this.props.model;return d.default.createElement(c.ListItem,{disabled:!0,leftIcon:d.default.createElement(c.FontIcon,{className:"mdi mdi-"+("LEAF"===e.Type?"file":"folder")}),primaryText:t.getNodeLabelInContext(e),rightIconButton:d.default.createElement(c.IconButton,{onClick:function(){t.removeRootNode(e.Uuid)},iconClassName:"mdi mdi-delete",tooltip:"Remove",iconStyle:{color:"rgba(0,0,0,.43)"}})})}},{key:"render",value:function(){function e(e){return r.MessageHash["share_center."+e]}var n=this,t=this.props,o=t.model,i=t.muiTheme,a=t.mode,r=t.pydio,l=o.getRootNodes()||[],s=[],u=void 0;l.map(function(e){s.push(n.renderNodeLine(e)),s.push(d.default.createElement(c.Divider,{inset:!0}))}),s.pop(),l.length||"edit"===a&&(u=d.default.createElement("span",{style:{color:"rgba(0,0,0,.54)",fontStyle:"italic"}},e(280)));t=void 0,t="edit"===a?d.default.createElement(c.FlatButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!0,style:{marginBottom:10},icon:d.default.createElement(c.FontIcon,{className:"mdi mdi-folder-plus"})}):d.default.createElement(c.RaisedButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!1,style:{marginBottom:10},icon:d.default.createElement(c.FontIcon,{className:"mdi mdi-folder-plus",style:{fontSize:20,marginTop:-4}})}),o=this.state,l=o.node,a=o.availableWs,o=o.crtWs;return d.default.createElement("div",null,t,d.default.createElement(c.List,null,s),u,d.default.createElement(c.Popover,{open:this.state.open,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},d.default.createElement("div",{style:{width:372,height:300,display:"flex",flexDirection:"column"}},d.default.createElement(c.DropDownMenu,{style:{height:54},value:o,onChange:function(e,t,o){n.switchWorkspace(o)}},a.map(function(e){return"DIVIDER"===e?d.default.createElement(c.Divider,null):d.default.createElement(c.MenuItem,{value:e,primaryText:e.getLabel()})})),d.default.createElement(c.Divider,null),d.default.createElement("div",{style:{marginLeft:-26,flex:"1",overflowY:"auto",fontSize:15,color:"rgba(0,0,0,.73)"}},d.default.createElement(p,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!1,draggable:!1})),d.default.createElement(c.Divider,null),d.default.createElement("div",{style:{display:"flex",padding:"4px 16px",alignItems:"center",fontSize:15}},l&&d.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.87)"}},l&&l.getPath()),!l&&d.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.54)",fontWeight:500}},e(283)),d.default.createElement(c.IconButton,{iconStyle:{color:i.palette.primary1Color},disabled:!l,iconClassName:"mdi mdi-plus-circle-outline",onClick:this.onValidateNode.bind(this)})))))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),l(Object.getPrototypeOf(f.prototype),"constructor",this).call(this,e);var t=void 0,o=e.pydio.user,n=[];o.getRepositoriesList().forEach(function(e){if("gateway"===e.getAccessType()){if(e.getId()===o.activeRepository){if("shared"===e.getOwner())return;t=e}n.push(e)}});var i=[],a=n.filter(function(e){return!e.getOwner()}),r=n.filter(function(e){return e.getOwner()}),e=void 0;(i=a.length&&r.length?[].concat(s(a),["DIVIDER"],s(r)):[].concat(s(a),s(r))).length&&(t=t||i[0],(r=(e=u.default.RemoteDataModelFactory({tmp_repository_id:t.getId()})).getRootNode()).getMetadata().set("repository_id",t.getId()),r.load(e.getAjxpNodeProvider())),this.state={dataModel:e,open:!1,availableWs:i,crtWs:t}}o.default=n=(0,r.muiThemeable)()(n),o.default=n,t.exports=o.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var c=e("material-ui"),p=r(e("./UserBadge")),l=r(e("../ShareContextConsumer")),s=e("prop-types"),f=e("react"),s=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,f.Component),n(u,[{key:"render",value:function(){var o=this,e=this.props,t=e.cellAcl,n=e.pydio,i=[],a=t.User?"user":t.Group?"group":"team";if(t.User&&t.User.Login===n.user.id)return null;"group"!=a&&this.props.sendInvitations&&i.push({text:this.props.getMessage("45"),callback:this.onInvite}),this.props.isReadonly()||this.props.readonly||i.push({text:this.props.getMessage("257",""),callback:this.onRemove});var r=void 0,l=void 0;switch(a){case"user":r=t.User.Attributes.displayName||t.User.Login,l=t.User.Attributes.avatar;break;case"group":r=t.Group.Attributes?t.Group.Attributes.displayName||t.Group.GroupLabel:t.Group.Uuid;break;case"team":r=t.Role?t.Role.Label:"No role found";break;default:r=t.RoleId}var s=!1,u=!1;t.Actions.map(function(e){"read"===e.Name&&(s=!0),"write"===e.Name&&(u=!0)});e=this.props.isReadonly()||this.props.readonly,n={display:"flex",width:70};return i.length||(n=d({},n,{marginRight:48})),f.createElement(p.default,{label:r,avatar:l,type:a,menus:i},f.createElement("span",{style:n},f.createElement(c.Checkbox,{disabled:e,checked:s,onCheck:function(e,t){o.onUpdateRight("read",t)}}),f.createElement(c.Checkbox,{disabled:e,checked:u,onCheck:function(e,t){o.onUpdateRight("write",t)}})))}}],[{key:"propTypes",value:{cellAcl:s.object.isRequired,sendInvitations:s.func,onUserObjectRemove:s.func.isRequired,onUserObjectUpdateRight:s.func.isRequired},enumerable:!0}]),u);function u(){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),a(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,arguments),this.onRemove=function(){o.props.onUserObjectRemove(o.props.cellAcl.RoleId)},this.onInvite=function(){var e={},t=PydioUsers.User.fromIdmUser(o.props.cellAcl.User);e[t.getId()]=t,o.props.sendInvitations(e)},this.onUpdateRight=function(e,t){o.props.onUserObjectUpdateRight(o.props.cellAcl.RoleId,e,t)}}o.default=s=(0,l.default)(s),o.default=s,t.exports=o.default},{"../ShareContextConsumer":1,"./UserBadge":8,"material-ui":"material-ui","prop-types":"prop-types",react:"react"}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var d=r(e("react")),l=r(e("../ShareContextConsumer")),c=r(e("./SharedUserEntry")),p=r(e("../main/ActionButton")),s=r(e("prop-types")),e=r(e("pydio")),f=e.default.requireLib("components").UsersCompleter,s=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,d["default"].Component),n(u,[{key:"render",value:function(){var t=this,e=this.props,o=e.cellAcls,n=e.pydio,i=n.getPluginConfigs("core.auth"),a=0,r=[];Object.keys(o).map(function(e){e=o[e];e.User&&e.User.Login===n.user.id||(a++,r.push(d.default.createElement(c.default,{cellAcl:e,key:a,pydio:t.props.pydio,readonly:t.props.readonly,sendInvitations:t.props.sendInvitations,onUserObjectRemove:t.props.onUserObjectRemove,onUserObjectUpdateRight:t.props.onUserObjectUpdateRight})))});var l=[],s=Object.keys(this.props.cellAcls).length;!s||this.props.isReadonly()||this.props.readonly||l.push(d.default.createElement(p.default,{key:"clear",callback:this.clearAllUsers,tooltipPosition:"top-center",mdiIcon:"delete",messageId:"180"})),s&&this.props.sendInvitations&&l.push(d.default.createElement(p.default,{key:"invite",callback:this.sendInvitationToAllUsers,tooltipPosition:"top-center",mdiIcon:"email-outline",messageId:"45"})),this.props.saveSelectionAsTeam&&1<s&&!this.props.isReadonly()&&!this.props.readonly&&l.push(d.default.createElement(p.default,{key:"team",callback:this.props.saveSelectionAsTeam,mdiIcon:"account-multiple-plus",tooltipPosition:"top-center",messageId:"509",messageCoreNamespace:!0}));var u=void 0,e=void 0;return r.length&&(u=d.default.createElement("div",{style:{display:"flex",marginBottom:-8,marginTop:-8,color:"rgba(0,0,0,.33)",fontSize:12}},d.default.createElement("div",{style:{flex:1}}),d.default.createElement("div",{style:{width:43,textAlign:"center"}},d.default.createElement("span",{style:{borderBottom:"2px solid rgba(0,0,0,0.13)"}},this.props.getMessage("361",""))),d.default.createElement("div",{style:{width:43,textAlign:"center"}},d.default.createElement("span",{style:{borderBottom:"2px solid rgba(0,0,0,0.13)"}},this.props.getMessage("181"))),d.default.createElement("div",{style:{width:52}}))),this.props.isReadonly()||this.props.readonly||(s=Object.values(o).map(function(e){return e.User?e.User.Login:e.Group?e.Group.Uuid:e.Role?e.Role.Uuid:null}).filter(function(e){return!!e}),e=d.default.createElement(f,{className:"share-form-users",fieldLabel:this.props.getMessage("34"),onValueSelected:this.valueSelected,pydio:this.props.pydio,showAddressBook:!0,usersFrom:"local",excludes:s,existingOnly:!i.get("USER_CREATE_USERS")})),d.default.createElement("div",null,d.default.createElement("div",{style:r.length?{margin:"-20px 8px 16px"}:{marginTop:-20}},e),u,d.default.createElement("div",null,r),!r.length&&d.default.createElement("div",{style:{color:"rgba(0,0,0,0.43)"}},this.props.getMessage("182")),0<r.length&&d.default.createElement("div",{style:{textAlign:"center"}},l))}}],[{key:"propTypes",value:{pydio:s.default.instanceOf(e.default),cellAcls:s.default.object,saveSelectionAsTeam:s.default.func,sendInvitations:s.default.func,showTitle:s.default.bool,onUserObjectAdd:s.default.func.isRequired,onUserObjectRemove:s.default.func.isRequired,onUserObjectUpdateRight:s.default.func.isRequired},enumerable:!0}]),u);function u(){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),a(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,arguments),this.sendInvitationToAllUsers=function(){var e=i.props,t=e.cellAcls,o=e.pydio,n=[];Object.keys(t).map(function(e){e=t[e];e.User&&e.User.Login===o.user.id||e.User&&(e=PydioUsers.User.fromIdmUser(e.User),n[e.getId()]=e)}),i.props.sendInvitations(n)},this.clearAllUsers=function(){Object.keys(i.props.cellAcls).map(function(e){i.props.onUserObjectRemove(e)})},this.valueSelected=function(e){e.IdmUser?i.props.onUserObjectAdd(e.IdmUser):i.props.onUserObjectAdd(e.IdmRole)}}o.default=s=(0,l.default)(s),o.default=s,t.exports=o.default},{"../ShareContextConsumer":1,"../main/ActionButton":26,"./SharedUserEntry":6,"prop-types":"prop-types",pydio:"pydio",react:"react"}],8:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};var r=e("prop-types"),l=e("react").Component,s=e("material-ui"),u=s.MenuItem,d=s.IconMenu,c=s.IconButton,s=e("material-ui/styles").muiThemeable,p=e("color"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,l),n(f,[{key:"renderMenu",value:function(){if(!this.props.menus||!this.props.menus.length)return null;var e=this.props.menus.map(function(e){var t=void 0;return e.checked&&(t=React.createElement("span",{className:"mdi mdi-check"})),React.createElement(u,{primaryText:e.text,onClick:e.callback,rightIcon:t})});return React.createElement(d,{iconButtonElement:React.createElement(c,{style:{padding:16},iconStyle:{fontSize:18},iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"}},e)}},{key:"render",value:function(){var e=void 0,t=this.props.muiTheme.palette.avatarsColor,e="group"===this.props.type?(t=p(t).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple",style:{backgroundColor:t}})):"team"===this.props.type?(t=p(t).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple-outline",style:{backgroundColor:t}})):"temporary"===this.props.type?(t=p(t).lighten(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-plus",style:{backgroundColor:t}})):"remote_user"===this.props.type?React.createElement("span",{className:"avatar mdi mdi-account-network",style:{backgroundColor:t}}):React.createElement("span",{className:"avatar mdi mdi-account",style:{backgroundColor:t}}),t=this.renderMenu();return React.createElement("div",{className:"share-dialog user-badge user-type-"+this.props.type},e,React.createElement("span",{className:"user-badge-label"},this.props.label),this.props.children,t)}}]),f);function f(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a(Object.getPrototypeOf(f.prototype),"constructor",this).apply(this,arguments)}n.propTypes={label:r.string,avatar:r.string,type:r.string,menus:r.object,muiTheme:r.object},o.default=n=s()(n),o.default=n,t.exports=o.default},{color:"color","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],9:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var p=r(e("react")),f=r(e("react-dom")),l=r(e("./CompositeModel")),h=r(e("../main/ShareHelper")),y=r(e("../cells/SharedUsers")),s=r(e("prop-types")),u=r(e("pydio")),d=e("material-ui/styles"),m=e("material-ui"),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,p["default"].Component),n(c,[{key:"addToCellsMenuItems",value:function(){var t=this,o=[],e=this.props,n=e.pydio,i=e.compositeModel,a=i.getCells().map(function(e){return e.getUuid()});return n.user.getRepositoriesList().forEach(function(e){"shared"===e.getOwner()&&-1===a.indexOf(e.getId())&&o.push(p.default.createElement(m.MenuItem,{primaryText:e.getLabel(),onClick:function(){t.setState({addMenuOpen:!1}),i.addToExistingCell(e.getId())},leftIcon:p.default.createElement(m.FontIcon,{className:"icomoon-cells"})}))}),o}},{key:"componentWillReceiveProps",value:function(e,t){var o=this.state.edit,n=e.compositeModel;"NEWCELL"!==o||n.isDirty()||(this.setState({edit:null}),n.getCells().map(function(e){var t=e.getAcls();Object.keys(t).length||n.removeNewCell(e)}))}},{key:"render",value:function(){function a(e){return s.MessageHash["share_center."+e]}var r=this,e=this.props,l=e.compositeModel,s=e.pydio,u=e.usersInvitations,t=e.muiTheme,d=this.state.edit,c=[];l.getCells().map(function(t){function e(){var e;n&&"NEWCELL"===d&&(e=t.getAcls(),Object.keys(e).length||l.removeNewCell(t)),r.setState({edit:n?null:t.getUuid()})}var o=t.getLabel(),n=!t.getUuid()&&"NEWCELL"===d||d===t.getUuid(),i=void 0;n?i=p.default.createElement(m.IconButton,{iconClassName:"mdi mdi-close",tooltip:s.MessageHash[86],onClick:e}):t.isEditable()&&(i=p.default.createElement(m.IconMenu,{iconButtonElement:p.default.createElement(m.IconButton,{iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"}},p.default.createElement(m.MenuItem,{primaryText:a(258),onClick:e}),p.default.createElement(m.MenuItem,{primaryText:a(259),onClick:function(){t.removeRootNode(l.getNode().getMetadata().get("uuid"))}}))),c.push(p.default.createElement(m.ListItem,{primaryText:o,secondaryText:t.getAclsSubjects(),rightIconButton:i,onClick:e,style:n?{backgroundColor:"rgb(245, 245, 245)"}:{},disabled:"NEWCELL"===d&&!n})),n&&c.push(p.default.createElement(m.Paper,{zDepth:0,style:{backgroundColor:"rgb(245, 245, 245)",margin:"0 0 16px",padding:"0 10px 10px"}},p.default.createElement(y.default,{pydio:s,cellAcls:t.getAcls(),excludes:[s.user.id],onUserObjectAdd:t.addUser.bind(t),onUserObjectRemove:t.removeUser.bind(t),onUserObjectUpdateRight:t.updateUserRight.bind(t),sendInvitations:function(e){return u(e,t)},saveSelectionAsTeam:!1,readonly:!t.isEditable()}))),c.push(p.default.createElement(m.Divider,null))}),c.pop();var o=void 0,o=c.length&&"NEWCELL"!==d?p.default.createElement("div",null,a(260)):c.length&&"NEWCELL"===d?p.default.createElement("div",null,a(261)):p.default.createElement("div",{style:{padding:"21px 16px 21px 0px",cursor:"pointer",display:"flex",alignItems:"center"},onClick:function(){l.createEmptyCell(),r.setState({edit:"NEWCELL"})}},p.default.createElement(m.IconButton,{iconClassName:"icomoon-cells-clear-plus",iconStyle:{color:t.palette.primary1Color}}),p.default.createElement("span",{style:{flex:1,marginLeft:8}},a(262))),n=this.addToCellsMenuItems(),e=void 0;n.length&&(e=p.default.createElement("span",null,p.default.createElement(m.RaisedButton,{ref:"addCellButton",style:{marginLeft:10},primary:!0,label:a(263),onClick:function(e){r.setState({addMenuOpen:!0,addMenuAnchor:f.default.findDOMNode(r.refs.addCellButton)})}}),p.default.createElement(m.Popover,{open:this.state.addMenuOpen,anchorEl:this.state.addMenuAnchor,onRequestClose:function(){r.setState({addMenuOpen:!1})},anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"}},p.default.createElement(m.Menu,null,n))));t=h.default.getAuthorizations();if(l.getNode()){n=l.getNode().isLeaf();if(!(n&&t.file_workspaces||!n&&t.folder_workspaces))return p.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0, 0, 0, 0.43)",padding:8}},a(n?"227":"228"))}return p.default.createElement("div",{style:this.props.style},p.default.createElement("div",{style:{paddingBottom:20}},p.default.createElement(m.RaisedButton,{label:a(264),disabled:"NEWCELL"===d,primary:!0,onClick:function(){l.createEmptyCell(),r.setState({edit:"NEWCELL"})}}),e),p.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0, 0, 0, 0.43)"}},o),p.default.createElement(m.List,null,c))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,e),this.state={edit:null}}n.PropTypes={pydio:s.default.instanceOf(u.default),compositeModel:s.default.instanceOf(l.default).isRequired,usersInvitations:s.default.func},o.default=n=(0,d.muiThemeable)()(n),o.default=n,t.exports=o.default},{"../cells/SharedUsers":7,"../main/ShareHelper":29,"./CompositeModel":12,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio",react:"react","react-dom":"react-dom"}],10:[function(d,c,p){!function(u){!function(){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e};function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function o(e){return e&&e.__esModule?e:{default:e}}var y=o(d("react")),i=o(d("../composite/CompositeModel")),m=o(d("../main/GenericEditor")),a=o(d("pydio")),g=o(d("../links/Panel")),v=o(d("../links/SecureOptions")),b=o(d("../main/ShareHelper")),k=o(d("./Mailer")),E=o(d("./CellsList")),r=o(d("clipboard")),w=o(d("../links/PublicLinkTemplate")),O=o(d("../links/VisibilityPanel")),P=o(d("../links/LabelPanel")),M=d("material-ui"),l=a.default.requireLib("hoc").PaletteModifier,C=a.default.requireLib("boot").Tooltip,a=a.default.requireLib("components"),L=a.GenericCard,_=a.GenericLine,e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,y["default"].Component),e(s,[{key:"confirmAndDismiss",value:function(){var e=this.state.model,t=this.props,o=t.pydio,t=t.onDismiss;e.isDirty()&&!confirm(o.MessageHash["share_center.dialog.close.confirm.unsaved"])||t()}},{key:"attachClipboard",value:function(){function o(e){return n.MessageHash["share_center."+e]}var t,n=this.props.pydio,e=this.state.model;this.detachClipboard(),!e.getLinks().length||(t=e.getLinks()[0]).getLink()&&this.refs["copy-button"]&&(this._clip=new r.default(this.refs["copy-button"],{text:function(e){return b.default.buildPublicUrl(n,t.getLink())}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copyMessage:o("192")},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)),this._clip.on("error",function(){var e=this,t=void 0,t=0===u.navigator.platform.indexOf("Mac")?o(144):o(143);this.setState({copyMessage:t},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)))}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,o=t.node,t=t.mode;this.state.model.observe("update",function(){e.forceUpdate()}),this.state.model.load(o,"infoPanel"===t),this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update"),this.detachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"componentWillReceiveProps",value:function(e){!e.node||e.node===this.props.node&&e.node.getMetadata("pydio_shares")===this.props.node.getMetadata("pydio_shares")||this.state.model.load(e.node,"infoPanel"===e.mode)}},{key:"usersInvitations",value:function(e,t){b.default.sendCellInvitation(this.props.node,t,e)}},{key:"linkInvitation",value:function(e){try{var t=b.default.prepareEmail(this.props.node,e);this.setState({mailerData:h({},t,{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){try{this.state.model.save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){function i(e){return l.MessageHash["share_center."+e]}var a=this,e=this.props,t=e.node,r=e.mode,l=e.pydio,o=e.editorOneColumn,n=this.state,s=n.model,u=n.mailerData,d=n.linkTooltip,c=n.copyMessage;if("edit"===r){var p=void 0,f=void 0,f=(p=s.getLinks().length?s.getLinks()[0]:p)&&p.getLinkUuid()&&p.isEditable()?y.default.createElement("div",null,y.default.createElement(k.default,h({},u,{pydio:l,onDismiss:this.dismissMailer.bind(this)})),y.default.createElement(P.default,{pydio:l,linkModel:p})):y.default.createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},y.default.createElement(k.default,h({},u,{pydio:l,onDismiss:this.dismissMailer.bind(this)})),i(256).replace("%s",t.getLabel())),e={left:[],right:[],leftStyle:{padding:0}};e.right.push({Label:i(250),Value:"cells",Component:y.default.createElement(E.default,{pydio:l,compositeModel:s,usersInvitations:this.usersInvitations.bind(this),style:o?{padding:10}:{}})});n=s.getLinks();return p&&(e.left.push({Label:i(251),Value:"public-link",Component:y.default.createElement(g.default,{pydio:l,compositeModel:s,linkModel:n[0],showMailer:b.default.mailerSupported(l)?this.linkInvitation.bind(this):null})}),p.getLinkUuid()&&(u=void 0,1<(t=b.default.compileLayoutData(l,s)).length&&(u=y.default.createElement(w.default,{linkModel:p,pydio:l,layoutData:t,style:{padding:"10px 16px"},readonly:s.getNode().isLeaf()})),e.left.push({Label:i(252),Value:"link-secure",Component:y.default.createElement("div",null,y.default.createElement(v.default,{pydio:l,linkModel:n[0]}),u&&y.default.createElement(M.Divider,null),u)}),n[0].isEditable()&&e.left.push({Label:i(253),Value:"link-visibility",Component:y.default.createElement(O.default,{pydio:l,linkModel:n[0]}),AlwaysLast:!0}))),y.default.createElement(m.default,{tabs:e,pydio:l,header:f,saveEnabled:s.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:function(){return a.confirmAndDismiss()},onRevertAction:function(){s.revertChanges()},editorOneColumn:o,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}o=function(){var e=[],t=[];s.getCells().map(function(e){t.push(e.getLabel())}),t.length&&e.push(y.default.createElement(_,{iconClassName:"mdi mdi-account-multiple",legend:i(254),data:t.join(", ")}));var o,n=s.getLinks();n.length&&((o=n[0]).hasError()?(n=o.hasError(),e.push(y.default.createElement(_,{iconClassName:"mdi mdi-alert-outline",legend:"Error",data:n.Detail||n.Msg||n}))):o.getLink()&&o.getLink().LinkHash&&(o=b.default.buildPublicUrl(l,o.getLink(),"infoPanel"===r),e.push(y.default.createElement(_,{iconClassName:"mdi mdi-link",legend:i(121),style:{overflow:"visible"},dataStyle:{overflow:"visible"},data:y.default.createElement("div",{ref:"copy-button",style:{cursor:"pointer",position:"relative"},onMouseOver:function(){a.setState({linkTooltip:!0})},onMouseOut:function(){a.setState({linkTooltip:!1})}},y.default.createElement(C,{label:c||i(191),horizontalPosition:"left",verticalPosition:"top",show:d}),o)}))));return{v:y.default.createElement(L,{pydio:l,title:l.MessageHash["share_center.50"],onDismissAction:a.props.onDismiss,onDeleteAction:function(){confirm(i(255))&&(s.stopObserving("update"),s.deleteAll().then(function(e){s.updateUnderlyingNode()}))},onEditAction:function(){l.Controller.fireAction("share-edit-shared")},headerSmall:"infoPanel"===r},e,!e.length&&y.default.createElement(_,{placeHolder:!0}))}}();if("object"==typeof o)return o.v}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),t(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,e),this.state={mode:this.props.mode||"view",model:new i.default("edit"===this.props.mode)}}p.default=e=l({primary1Color:"#009688"})(e),p.default=e,c.exports=p.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../composite/CompositeModel":12,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./CellsList":9,"./Mailer":13,clipboard:"clipboard","material-ui":"material-ui",pydio:"pydio",react:"react"}],11:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var i=n(e("./CompositeCard")),a=n(e("pydio/model/data-model")),r=n(e("prop-types")),l=n(e("pydio")),s=e("react"),r=e("create-react-class")({displayName:"CompositeDialog",mixins:[e("pydio").requireLib("boot").ActionDialogMixin],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogPadding:!1,dialogSize:"lg"}},propTypes:{pydio:r.default.instanceOf(l.default).isRequired,selection:r.default.instanceOf(a.default),readonly:r.default.bool},childContextTypes:{messages:r.default.object,getMessage:r.default.func,isReadonly:r.default.func},getChildContext:function(){var e=this,o=this.props.pydio.MessageHash;return{messages:o,getMessage:function(t){var e=arguments.length<=1||void 0===arguments[1]?"share_center":arguments[1];try{return o[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return e.props.readonly}}},render:function(){var e=this.props,t=e.pydio,o=e.selection,e=void 0;return o.getUniqueNode()&&(e=o.getUniqueNode()),s.createElement(i.default,{editorOneColumn:this.props.editorOneColumn,pydio:t,mode:"edit",node:e,onDismiss:this.props.onDismiss})}});o.default=r,t.exports=o.default},{"./CompositeCard":10,"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],12:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var l=r(e("pydio/lang/observable")),s=r(e("../links/LinkModel")),u=r(e("../main/ShareHelper")),d=r(e("pydio/model/cell")),c=e("cells-sdk"),p=r(e("pydio")),f=p.default.requireLib("boot").moment,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,l["default"]),n(h,[{key:"emptyLink",value:function(e){var t=this,o=new s.default,n=new c.TreeNode,i=u.default.getAuthorizations();n.Uuid=e.getMetadata().get("uuid"),o.getLink().Label=e.getLabel(),o.getLink().Description=pydio.MessageHash["share_center.257"].replace("%s",f(new Date).format("YYYY/MM/DD")),o.getLink().RootNodes.push(n);var a=void 0,n=[c.RestShareLinkAccessType.constructFromObject("Download")];return e.isLeaf()?(a="pydio_unique_dl",u.default.nodeHasEditor(pydio,e).preview&&!i.max_downloads?(a="pydio_unique_strip",n.push(c.RestShareLinkAccessType.constructFromObject("Preview"))):0<i.max_downloads&&(o.getLink().MaxDownloads=i.max_downloads)):(a="pydio_shared_folder",n.push(c.RestShareLinkAccessType.constructFromObject("Preview"))),o.getLink().ViewTemplateName=a,o.getLink().Permissions=n,i.max_expiration&&(o.getLink().AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(i.max_expiration)*60*24)),o.observe("update",function(){t.notify("update")}),o.observe("save",function(){t.updateUnderlyingNode()}),o}},{key:"createEmptyCell",value:function(){var e=this,t=new d.default(!0);t.setLabel(this.node.getLabel()),t.addRootNode(this.node),t.observe("update",function(){e.notify("update")}),t.dirty=!1,this.cells.push(t),this.notify("update")}},{key:"addToExistingCell",value:function(e){var t=this,o=new d.default(!0);o.observe("update",function(){t.notify("update")}),o.load(e).then(function(){o.addRootNode(t.node)}),this.cells.push(o)}},{key:"updateUnderlyingNode",value:function(){this.skipUpdateUnderlyingNode||p.default.getInstance().getContextHolder().requireNodeReload(this.node)}},{key:"deleteLink",value:function(e){var t=this;return e.deleteLink(this.emptyLink(this.node).getLink()).then(function(e){t.updateUnderlyingNode()})}},{key:"getNode",value:function(){return this.node}},{key:"load",value:function(e){var o=this,t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.node=e,this.cells=[],this.links=[],e.getMetadata().get("pydio_shares")&&JSON.parse(e.getMetadata().get("pydio_shares")).map(function(e){var t;3===e.Scope?((t=new s.default).observe("update",function(){o.notify("update")}),t.observe("save",function(){o.updateUnderlyingNode()}),t.load(e.UUID),o.links.push(t)):2===e.Scope&&((t=new d.default).observe("update",function(){o.notify("update")}),t.load(e.UUID),o.cells.push(t))}),this.edit&&!this.links.length&&this.links.push(this.emptyLink(e)),t&&this.node.observe("node_replaced",function(){o.load(o.node,!1)})}},{key:"loadUniqueLink",value:function(e,t){var o=this;this.node=t;t=new s.default;return t.observe("update",function(){o.notify("update")}),t.load(e),this.links.push(t),t}},{key:"save",value:function(){var o=this,t=[];this.cells.map(function(e){e.isDirty()&&t.push(e.save())}),this.links.map(function(e){e.isDirty()&&t.push(e.save())}),Promise.all(t).then(function(){var t=o.node.getMetadata().get("uuid");o.cells=o.cells.filter(function(e){return e.hasRootNode(t)}),o.updateUnderlyingNode()}).catch(function(e){o.updateUnderlyingNode()})}},{key:"deleteAll",value:function(){var t=this.node.getMetadata().get("uuid"),o=[];return this.cells.map(function(e){e.removeRootNode(t),o.push(e.save())}),this.links.map(function(e){o.push(e.deleteLink())}),Promise.all(o)}},{key:"removeNewCell",value:function(t){this.cells=this.cells.filter(function(e){return e!==t}),this.notify("update")}},{key:"revertChanges",value:function(){this.cells=this.cells.filter(function(e){return e.getUuid()}),this.cells.map(function(e){e.isDirty()&&e.revertChanges()}),this.links.map(function(e){e.isDirty()&&e.revertChanges()}),this.notify("update")}},{key:"isDirty",value:function(){return this.cells.filter(function(e){return e.isDirty()}).length||this.links.filter(function(e){return e.isDirty()}).length}},{key:"stopObserving",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];this.cells.map(function(e){e.stopObserving("update")}),this.links.map(function(e){e.stopObserving("update")}),a(Object.getPrototypeOf(h.prototype),"stopObserving",this).call(this,e,t)}},{key:"getCells",value:function(){var e=this;if(!this.node)return this.cells;var t,e=(t=e.node.getMetadata().get("uuid"),{v:e.cells.filter(function(e){return e.hasRootNode(t)})});return"object"==typeof e?e.v:void 0}},{key:"getLinks",value:function(){return this.links}}]),h);function h(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),a(Object.getPrototypeOf(h.prototype),"constructor",this).call(this),this.cells=[],this.links=[],this.edit=e}o.default=n,t.exports=o.default},{"../links/LinkModel":18,"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/lang/observable":"pydio/lang/observable","pydio/model/cell":"pydio/model/cell"}],13:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var s=l(e("react")),u=l(e("pydio/http/resources-manager")),d=l(e("../main/ShareHelper")),p=(e("material-ui"),e("cells-sdk")),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s["default"].Component),n(c,[{key:"componentWillReceiveProps",value:function(e){var t=this,o=e.subject,n=e.message,i=(e.users,e.linkModel),a=e.templateId;e.templateData;o||a?d.default.forceMailerOldSchool()?(o=encodeURIComponent(o),location.href="mailto:custom-email@domain.com?Subject="+o+"&Body="+n):u.default.loadClassesAndApply(["PydioMailer"],function(){t.setState({mailerData:r({},e,{enableIdentification:i&&i.getLink().TargetUsers,identifiedOnly:i&&i.getLink().RestrictToTargetUsers,crippleIdentificationKeys:!0})})}):this.setState({mailerData:null})}},{key:"toggleMailerData",value:function(e){this.setState({mailerData:r({},this.state.mailerData,e)})}},{key:"dismissMailer",value:function(){this.props.onDismiss()}},{key:"mailerProcessPost",value:function(e,o,a,r,t,l){var n=this.state.mailerData,i=n.crippleIdentificationKeys,s=n.identifiedOnly,u=n.linkModel,d=u.getLink();d.TargetUsers||(d.TargetUsers={}),d.RestrictToTargetUsers=s;var c={};Object.keys(o).forEach(function(e){var t=i?Math.random().toString(36).substring(7):e;d.TargetUsers[t]=p.RestShareLinkTargetUser.constructFromObject({Display:o[e].getLabel(),DownloadCount:0}),c[t]=e}),u.updateLink(d),u.save().then(function(){var o=new e,n=u.getPublicUrl(),i=new RegExp(n,"g");Object.keys(c).forEach(function(e){var t=n+"?u="+e,t=r.replace(i,t);o.addTarget(c[e],a,t)}),o.post(function(e){l(e)})})}},{key:"getMessage",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"share_center":arguments[1];return this.props.pydio.MessageHash[t+(t?".":"")+e]}},{key:"render",value:function(){if(this.state.mailerData){var e=this.state.mailerData,t=void 0;return s.default.createElement(PydioMailer.Pane,r({},e,{onDismiss:this.dismissMailer.bind(this),overlay:!0,className:"share-center-mailer",panelTitle:this.props.pydio.MessageHash["share_center.45"],additionalPaneTop:t,processPost:e.enableIdentification?this.mailerProcessPost.bind(this):null,style:{width:420,margin:"0 auto"}}))}return null}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,e),this.state={mailerData:null}}o.default=n,t.exports=o.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk","material-ui":"material-ui","pydio/http/resources-manager":"pydio/http/resources-manager",react:"react"}],14:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var c=r(e("react")),l=r(e("../composite/CompositeModel")),p=r(e("../main/GenericEditor")),f=r(e("../links/Panel")),h=r(e("../links/SecureOptions")),y=r(e("../main/ShareHelper")),m=r(e("./Mailer")),g=r(e("../links/PublicLinkTemplate")),v=r(e("../links/VisibilityPanel")),b=r(e("../links/LabelPanel")),k=e("material-ui"),e=e("pydio").requireLib("hoc").PaletteModifier,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,c["default"].Component),n(s,[{key:"componentDidMount",value:function(){var e=this,t=this.props,o=t.node,n=t.linkUuid,i=t.onRemoveLink,t=this.state.model;t.observe("update",function(){e.forceUpdate()}),t.loadUniqueLink(n,o).observeOnce("delete",function(){i&&i()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"componentWillReceiveProps",value:function(e){e.LinkUuid&&e.LinkUuid!==this.props.LinkUuid&&this.state.model.loadUniqueLink(e.LinkUuid,e.node)}},{key:"linkInvitation",value:function(e){try{var t=y.default.prepareEmail(this.props.node,e);this.setState({mailerData:d({},t,{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){var e=this.state.model;try{e.getLinks().length&&e.getLinks()[0].save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){function e(e){return n.MessageHash["share_center."+e]}var t=this.props,o=t.node,n=t.pydio,i=t.editorOneColumn,a=this.state,r=a.model,l=a.mailerData,s=void 0,u=void 0,u=(s=r.getLinks().length?r.getLinks()[0]:s)&&s.getLinkUuid()&&s.isEditable()?c.default.createElement("div",null,c.default.createElement(m.default,d({},l,{pydio:n,onDismiss:this.dismissMailer.bind(this)})),c.default.createElement(b.default,{pydio:n,linkModel:s})):c.default.createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},c.default.createElement(m.default,d({},l,{pydio:n,onDismiss:this.dismissMailer.bind(this)})),e(256).replace("%s",o.getLabel())),t={left:[],right:[],leftStyle:{padding:0}},a=r.getLinks();return s&&(t.left.push({Label:e(251),Value:"public-link",Component:c.default.createElement(f.default,{pydio:n,compositeModel:r,linkModel:a[0],showMailer:y.default.mailerSupported(n)?this.linkInvitation.bind(this):null})}),s.getLinkUuid()&&(l=void 0,1<(o=y.default.compileLayoutData(n,r)).length&&(l=c.default.createElement(g.default,{linkModel:s,pydio:n,layoutData:o,style:{padding:"10px 16px"},readonly:r.getNode().isLeaf()})),t.left.push({Label:e(252),Value:"link-secure",Component:c.default.createElement("div",null,c.default.createElement(h.default,{pydio:n,linkModel:a[0]}),l&&c.default.createElement(k.Divider,null),l)}),t.left.push({Label:e(253),Value:"link-visibility",Component:c.default.createElement(v.default,{pydio:n,linkModel:a[0]}),AlwaysLast:!0}))),c.default.createElement(p.default,{tabs:t,pydio:n,header:u,saveEnabled:r.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){r.revertChanges()},editorOneColumn:i,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),e.editorOneColumn=!0,a(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,e);e=new l.default(!0);e.skipUpdateUnderlyingNode=!0,this.state={mode:this.props.mode||"view",model:e}}o.default=n=e({primary1Color:"#009688"})(n),o.default=n,t.exports=o.default},{"../composite/CompositeModel":12,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":13,"material-ui":"material-ui",pydio:"pydio",react:"react"}],15:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var i=n(e("./cells/CreateCellDialog")),a=n(e("./cells/EditCellDialog")),r=n(e("./cells/CellCard")),l=n(e("./composite/SimpleLinkCard")),s=n(e("./main/InfoPanel")),u=n(e("./composite/CompositeDialog")),d=n(e("./links/LinkModel")),c=n(e("./main/ShareHelper")),e=e("./lists/ShareView");o.CreateCellDialog=i.default,o.EditCellDialog=a.default,o.CellCard=r.default,o.InfoPanel=s.default,o.CompositeDialog=u.default,o.LinkModel=d.default,o.ShareHelper=c.default,o.ShareViewModal=e.ShareViewModal,o.ShareView=e.ShareView,o.SimpleLinkCard=l.default},{"./cells/CellCard":2,"./cells/CreateCellDialog":3,"./cells/EditCellDialog":4,"./composite/CompositeDialog":11,"./composite/SimpleLinkCard":14,"./links/LinkModel":18,"./lists/ShareView":25,"./main/InfoPanel":28,"./main/ShareHelper":29}],16:[function(k,E,w){!function(b){!function(){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var e=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e};function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function o(e){return e&&e.__esModule?e:{default:e}}var u=o(k("react")),i=o(k("../ShareContextConsumer")),d=(o(k("./TargetedUsers")),k("material-ui")),c=o(k("qrcode.react")),a=o(k("clipboard")),p=o(k("../main/ActionButton")),f=o(k("pydio/util/path")),r=o(k("pydio/util/lang")),l=k("material-ui/styles"),h=o(k("../main/ShareHelper")),s=o(k("prop-types")),y=o(k("pydio")),m=o(k("./LinkModel")),g=y.default.requireLib("boot").Tooltip,s=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(v,u["default"].Component),e(v,[{key:"componentDidUpdate",value:function(e,t){this.attachClipboard()}},{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"render",value:function(){var e=this,t=this.props,o=t.linkModel,n=t.pydio,i=h.default.buildPublicUrl(n,o.getLink()),a=h.default.getAuthorizations(),r=this.props.editAllowed&&a.editable_hash&&!this.props.isReadonly()&&o.isEditable();if(this.state.editLink&&r)return u.default.createElement("div",null,u.default.createElement("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#f5f5f5",padding:"0 6px",margin:"0 -6px",borderRadius:2}},u.default.createElement("span",{style:{fontSize:16,color:"rgba(0,0,0,0.4)",display:"inline-block",maxWidth:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},f.default.getDirname(i)+"/ "),u.default.createElement(d.TextField,{style:{flex:1,marginRight:10,marginLeft:10},onChange:this.changeLink,value:void 0!==this.state.customLink?this.state.customLink:o.getLink().LinkHash}),u.default.createElement(p.default,{mdiIcon:"check",callback:this.toggleEditMode})),u.default.createElement("div",{style:{textAlign:"center",fontSize:13,color:"rgba(0,0,0,0.43)",paddingTop:16}},this.props.getMessage("194")));var l=this.state,s=l.copyMessage,t=l.linkTooltip,n=(function(){return{__html:this.state.copyMessage}}.bind(this),[]),a=void 0,l=this.props.muiTheme;return n.push(u.default.createElement("div",{key:"copy",ref:"copy-button",style:{position:"relative",display:"inline-block",width:36,height:36,padding:"8px 10px",margin:"0 6px",cursor:"pointer",borderRadius:"50%",border:"1px solid "+l.palette.primary1Color},onMouseOver:function(){e.setState({linkTooltip:!0})},onMouseOut:function(){e.setState({linkTooltip:!1})}},u.default.createElement(g,{label:s||this.props.getMessage("191"),horizontalPosition:"center",verticalPosition:"bottom",show:t}),u.default.createElement("span",{className:"copy-link-button mdi mdi-content-copy",style:{color:l.palette.primary1Color}}))),this.props.showMailer&&n.push(u.default.createElement(p.default,{key:"outline",callback:this.openMailer,mdiIcon:"email-outline",messageId:"45"})),r&&n.push(u.default.createElement(p.default,{key:"pencil",callback:this.toggleEditMode,mdiIcon:"pencil",messageId:"193"})),h.default.qrcodeEnabled()&&n.push(u.default.createElement(p.default,{key:"qrcode",callback:this.toggleQRCode,mdiIcon:"qrcode",messageId:"94"})),n=n.length?u.default.createElement("div",{style:{display:"flex",margin:"20px 0 10px"}},u.default.createElement("span",{style:{flex:1}}),n,u.default.createElement("span",{style:{flex:1}})):null,a=this.state.showQRCode?u.default.createElement(d.Paper,{zDepth:1,style:{width:120,paddingTop:10,overflow:"hidden",margin:"0 auto",height:120,textAlign:"center"}},u.default.createElement(c.default,{size:100,value:i,level:"Q"})):u.default.createElement(d.Paper,{zDepth:0,style:{width:120,overflow:"hidden",margin:"0 auto",height:0,textAlign:"center"}}),u.default.createElement(d.Paper,{zDepth:0,rounded:!1,className:"public-link-container"},u.default.createElement("div",{style:{display:"flex",alignItems:"center"}},u.default.createElement(d.TextField,{type:"text",name:"Link",ref:"public-link-field",value:i,onFocus:function(e){e.target.select()},fullWidth:!0,style:{height:40},inputStyle:{textAlign:"center",backgroundColor:"#f5f5f5",borderRadius:2,padding:"0 5px"},underlineStyle:{borderColor:"#f5f5f5",textDecoration:o.isExpired()?"line-through":null},underlineFocusStyle:{bottom:0}})),!1,n,a)}}],[{key:"propTypes",value:{linkModel:s.default.instanceOf(m.default),editAllowed:s.default.bool,onChange:s.default.func,showMailer:s.default.func},enumerable:!0}]),v);function v(){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),t(Object.getPrototypeOf(v.prototype),"constructor",this).apply(this,arguments),this.state={editLink:!1,copyMessage:"",showQRCode:!1},this.toggleEditMode=function(){var e=n.props,t=e.linkModel,o=e.pydio;if(n.state.editLink&&n.state.customLink){e=h.default.getAuthorizations();if(e.hash_min_length&&n.state.customLink.length<e.hash_min_length)return void o.UI.displayMessage("ERROR",n.props.getMessage("223").replace("%s",e.hash_min_length));t.setCustomLink(n.state.customLink),t.save()}n.setState({editLink:!n.state.editLink,customLink:void 0})},this.changeLink=function(e){e=e.target.value,e=r.default.computeStringSlug(e);n.setState({customLink:e})},this.clearCopyMessage=function(){b.setTimeout(function(){this.setState({copyMessage:""})}.bind(n),5e3)},this.attachClipboard=function(){var e=n.props,t=e.linkModel,o=e.pydio;n.detachClipboard(),n.refs["copy-button"]&&(n._clip=new a.default(n.refs["copy-button"],{text:function(e){return h.default.buildPublicUrl(o,t.getLink())}.bind(n)}),n._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(n)),n._clip.on("error",function(){var e=void 0,e=0===b.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("143");this.refs["public-link-field"].focus(),this.setState({copyMessage:e},this.clearCopyMessage)}.bind(n)))},this.detachClipboard=function(){n._clip&&n._clip.destroy()},this.openMailer=function(){n.props.showMailer(n.props.linkModel)},this.toggleQRCode=function(){n.setState({showQRCode:!n.state.showQRCode})}}w.default=s=(0,l.muiThemeable)()(s),w.default=s=(0,i.default)(s),w.default=s,E.exports=w.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../main/ActionButton":26,"../main/ShareHelper":29,"./LinkModel":18,"./TargetedUsers":23,clipboard:"clipboard","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/util/lang":"pydio/util/lang","pydio/util/path":"pydio/util/path","qrcode.react":"qrcode.react",react:"react"}],17:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var l=r(e("react")),s=r(e("prop-types")),u=r(e("pydio")),e=r(e("./LinkModel")),d=u.default.requireLib("hoc").ModernTextField,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l["default"].Component),n(c,[{key:"render",value:function(){var e=this.props,t=e.pydio,o=e.linkModel,e=function(e){return t.MessageHash["share_center."+e]},n=o.getLink();return l.default.createElement("div",null,l.default.createElement(d,{floatingLabelText:e(265),value:n.Label,onChange:function(e,t){n.Label=t,o.updateLink(n)},fullWidth:!0}),l.default.createElement(d,{floatingLabelText:e(266),value:n.Description,onChange:function(e,t){n.Description=t,o.updateLink(n)},fullWidth:!0}))}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),a(Object.getPrototypeOf(c.prototype),"constructor",this).apply(this,arguments)}n.PropTypes={pydio:s.default.instanceOf(u.default),linkModel:s.default.instanceOf(e.default)},o.default=n,t.exports=o.default},{"./LinkModel":18,"prop-types":"prop-types",pydio:"pydio",react:"react"}],18:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var l=r(e("pydio")),s=r(e("pydio/http/api")),u=r(e("pydio/lang/observable")),d=r(e("../main/ShareHelper")),c=e("cells-sdk"),p=r(e("pydio/util/pass")),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,u["default"]),n(f,[{key:"hasError",value:function(){return this.loadError}},{key:"isEditable",value:function(){return this.link.PoliciesContextEditable}},{key:"isDirty",value:function(){return this.dirty}},{key:"getLinkUuid",value:function(){return this.link.Uuid}},{key:"getLink",value:function(){return this.link}},{key:"getPublicUrl",value:function(){return d.default.buildPublicUrl(l.default.getInstance(),this.link)}},{key:"updateLink",value:function(e){this.link=e,this.notifyDirty()}},{key:"notifyDirty",value:function(){this.dirty=!0,this.notify("update")}},{key:"revertChanges",value:function(){this.originalLink&&(this.link=this.clone(this.originalLink),this.dirty=!1,this.updatePassword=this.createPassword=null,this.ValidPassword=!0,this.notify("update"))}},{key:"hasPermission",value:function(t){return 0<this.link.Permissions.filter(function(e){return e===t}).length}},{key:"isExpired",value:function(){return!!(this.link.MaxDownloads&&parseInt(this.link.CurrentDownloads)>=parseInt(this.link.MaxDownloads))||(this.link.AccessEnd,!1)}},{key:"load",value:function(e){var t=this;return new c.ShareServiceApi(s.default.getRestClient()).getShareLink(e).then(function(e){t.link=e,t.link.Permissions||(t.link.Permissions=[]),t.link.Policies||(t.link.Policies=[]),t.link.RootNodes||(t.link.RootNodes=[]),t.originalLink=t.clone(t.link),t.notify("update")}).catch(function(e){t.loadError=e,t.notify("update")})}},{key:"setCreatePassword",value:function(e){var o=this;e?p.default.checkPasswordStrength(e,function(e,t){o.ValidPassword=e,o.ValidPasswordMessage=t}):this.ValidPassword=!0,this.createPassword=e,this.link.PasswordRequired=!0,this.notifyDirty()}},{key:"setUpdatePassword",value:function(e){var o=this;e?p.default.checkPasswordStrength(e,function(e,t){o.ValidPassword=e,o.ValidPasswordMessage=t}):this.ValidPassword=!0,this.updatePassword=e,this.notifyDirty()}},{key:"setCustomLink",value:function(e){this.customLink=e}},{key:"save",value:function(){var t=this;if(!this.ValidPassword)throw new Error(this.ValidPasswordMessage);var e=new c.ShareServiceApi(s.default.getRestClient()),o=new c.RestPutShareLinkRequest;this.createPassword?(o.PasswordEnabled=!0,o.CreatePassword=this.createPassword):this.updatePassword?(o.PasswordEnabled=!0,this.link.PasswordRequired?o.UpdatePassword=this.updatePassword:o.CreatePassword=this.updatePassword):o.PasswordEnabled=this.link.PasswordRequired;var n=d.default.getAuthorizations();if(n.password_mandatory&&!o.PasswordEnabled)throw new Error(l.default.getMessages()["share_center.175"]);return 0<parseInt(n.max_downloads)&&!parseInt(this.link.MaxDownloads)&&(this.link.MaxDownloads=""+parseInt(n.max_downloads),this.notify("update")),0<parseInt(n.max_expiration)&&!parseInt(this.link.AccessEnd)&&(this.link.AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(n.max_expiration)*60*24),this.notify("update")),this.customLink&&this.customLink!==this.link.LinkHash&&(o.UpdateCustomHash=this.customLink),o.ShareLink=this.link,e.putShareLink(o).then(function(e){t.link=e,t.dirty=!1,t.originalLink=t.clone(t.link),t.updatePassword=t.createPassword=t.customLink=null,t.ValidPassword=!0,t.notify("update"),t.notify("save")}).catch(function(e){e=e.Detail||e.message||e;l.default.getInstance().UI.displayMessage("ERROR",e)})}},{key:"deleteLink",value:function(t){var o=this;return new c.ShareServiceApi(s.default.getRestClient()).deleteShareLink(this.link.Uuid).then(function(e){o.link=t,o.dirty=!1,o.updatePassword=o.createPassword=o.customLink=null,o.notify("update"),o.notify("delete")}).catch(function(e){e=e.Detail||e.message||e;pydio.UI.displayMessage("ERROR",e)})}},{key:"clone",value:function(e){return c.RestShareLink.constructFromObject(JSON.parse(JSON.stringify(e)))}}]),f);function f(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a(Object.getPrototypeOf(f.prototype),"constructor",this).call(this),this.link=new c.RestShareLink,this.link.Permissions=[c.RestShareLinkAccessType.constructFromObject("Preview"),c.RestShareLinkAccessType.constructFromObject("Download")],this.link.Policies=[],this.link.PoliciesContextEditable=!0,this.link.RootNodes=[],this.ValidPassword=!0,this.loadError=null}o.default=n,t.exports=o.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable","pydio/util/pass":"pydio/util/pass"}],19:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var p=r(e("react")),l=r(e("../ShareContextConsumer")),f=r(e("./Field")),h=r(e("./Permissions")),y=r(e("./TargetedUsers")),m=e("material-ui"),s=r(e("./LinkModel")),u=r(e("../composite/CompositeModel")),d=r(e("prop-types")),c=r(e("pydio")),g=r(e("../main/ShareHelper")),v=c.default.requireLib("form").ValidPassword,d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(b,p["default"].Component),n(b,[{key:"render",value:function(){var t=this,e=this.props,o=e.linkModel,n=e.pydio,i=e.compositeModel,a=this.state,r=a.showTemporaryPassword,l=a.temporaryPassword,s=a.saving,u=g.default.getAuthorizations(),d=i.getNode().isLeaf(),c=d&&u.file_public_link||!d&&u.folder_public_link,e=void 0,a=void 0;return o.getLinkUuid()?(a=p.default.createElement(f.default,{pydio:n,linkModel:o,showMailer:this.props.showMailer,editAllowed:u.editable_hash&&o.isEditable(),key:"public-link"}),e=[p.default.createElement(m.Divider,null),p.default.createElement(h.default,{compositeModel:i,linkModel:o,pydio:n,key:"public-perm"})],o.getLink().TargetUsers&&(e.push(p.default.createElement(m.Divider,null)),e.push(p.default.createElement(y.default,{linkModel:o,pydio:n})))):a=r?p.default.createElement("div",null,p.default.createElement("div",{className:"section-legend",style:{marginTop:20}},this.props.getMessage("215")),p.default.createElement("div",{style:{width:"100%"}},p.default.createElement(v,{attributes:{label:this.props.getMessage("23")},value:l,onChange:this.updateTemporaryPassword.bind(this),onValidStatusChange:function(e){return t.setState({temporaryPasswordState:e})}})),p.default.createElement("div",{style:{textAlign:"center",marginTop:20}},p.default.createElement(m.RaisedButton,{label:this.props.getMessage("92"),secondary:!0,onClick:this.enableLinkWithPassword.bind(this),disabled:!this.state.temporaryPasswordState}))):c?p.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage("190")):p.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage(d?"225":"226")),p.default.createElement("div",{style:this.props.style},p.default.createElement("div",{style:{padding:"15px 10px 11px",backgroundColor:"#f5f5f5",borderBottom:"1px solid #e0e0e0",fontSize:15}},p.default.createElement(m.Toggle,{disabled:this.props.isReadonly()||s||!o.isEditable()||!o.getLinkUuid()&&!c,onToggle:this.toggleLink,toggled:o.getLinkUuid()||r,label:this.props.getMessage("189")})),s&&p.default.createElement("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"}},p.default.createElement(m.CircularProgress,null)),!s&&p.default.createElement("div",{style:{padding:20}},a),!s&&e)}}],[{key:"propTypes",value:{linkModel:d.default.instanceOf(s.default),compositeModel:d.default.instanceOf(u.default),pydio:d.default.instanceOf(c.default),authorizations:d.default.object,showMailer:d.default.func},enumerable:!0}]),b);function b(){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),a(Object.getPrototypeOf(b.prototype),"constructor",this).apply(this,arguments),this.state={showTemporaryPassword:!1,temporaryPassword:null,saving:!1},this.toggleLink=function(){var e=o.props,t=e.linkModel;e.pydio;o.state.showTemporaryPassword?o.setState({showTemporaryPassword:!1,temporaryPassword:null}):!t.getLinkUuid()&&g.default.getAuthorizations().password_mandatory?o.setState({showTemporaryPassword:!0,temporaryPassword:""}):(o.setState({saving:!0}),(t.getLinkUuid()?o.props.compositeModel.deleteLink(t):t.save()).catch(function(){o.setState({saving:!1})}).then(function(){o.setState({saving:!1})}))},this.updateTemporaryPassword=function(e,t){void 0===e&&(e=t.currentTarget.getValue()),o.setState({temporaryPassword:e})},this.enableLinkWithPassword=function(){var e=o.props.linkModel;if(o.state.temporaryPasswordState){e.setCreatePassword(o.state.temporaryPassword);try{e.save()}catch(e){o.props.pydio.UI.displayMessage("ERROR",e.message)}o.setState({showTemporaryPassword:!1,temporaryPassword:null})}else o.props.pydio.UI.displayMessage("ERROR","Invalid Password")}}o.default=d=(0,l.default)(d),o.default=d,t.exports=o.default},{"../ShareContextConsumer":1,"../composite/CompositeModel":12,"../main/ShareHelper":29,"./Field":16,"./LinkModel":18,"./Permissions":20,"./TargetedUsers":23,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],20:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var s=l(e("react")),u=l(e("prop-types")),d=(l(e("pydio")),l(e("../ShareContextConsumer"))),c=e("material-ui"),p=l(e("./LinkModel")),f=l(e("../main/ShareHelper")),h=e("cells-sdk"),u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,s["default"].Component),n(y,[{key:"render",value:function(){var e=this.props,t=e.linkModel,o=e.compositeModel,n=e.pydio,i=o.getNode(),e=[],o=f.default.getAuthorizations();return i.isLeaf()?(i=(n=f.default.nodeHasEditor(n,i)).preview,n=n.writeable,e.push({NAME:"Download",LABEL:this.props.getMessage("73"),DISABLED:!i||!t.hasPermission("Preview")}),i&&!o.max_downloads&&(e.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Download")}),t.hasPermission("Preview")&&n&&e.push({NAME:"Upload",LABEL:this.props.getMessage("74b")}))):(e.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Upload")}),e.push({NAME:"Download",LABEL:this.props.getMessage("73")}),e.push({NAME:"Upload",LABEL:this.props.getMessage("74")})),s.default.createElement("div",{style:a({padding:"10px 16px"},this.props.style)},s.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},this.props.getMessage("70r")),s.default.createElement("div",{style:{margin:"10px 0 20px"}},e.map(function(e){return s.default.createElement(c.Checkbox,{key:e.NAME,disabled:e.DISABLED||this.props.isReadonly()||!t.isEditable(),type:"checkbox",name:e.NAME,label:e.LABEL,onCheck:this.changePermission,checked:t.hasPermission(e.NAME),labelStyle:{whiteSpace:"nowrap"},style:{margin:"10px 0"}})}.bind(this)),void 0))}}],[{key:"propTypes",value:{linkModel:u.default.instanceOf(p.default),style:u.default.object},enumerable:!0}]),y);function y(){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),r(Object.getPrototypeOf(y.prototype),"constructor",this).apply(this,arguments),this.changePermission=function(e){var t=e.target.name,o=e.target.checked,n=a.props,i=n.compositeModel,e=n.linkModel,n=e.getLink();o?n.Permissions.push(h.RestShareLinkAccessType.constructFromObject(t)):n.Permissions=n.Permissions.filter(function(e){return e!==t}),i.getNode().isLeaf()&&(i=f.default.getAuthorizations().max_downloads,e.hasPermission("Preview")?(n.ViewTemplateName="pydio_unique_strip",n.MaxDownloads=0):(n.ViewTemplateName="pydio_unique_dl",i&&!n.MaxDownloads&&(n.MaxDownloads=i))),a.props.linkModel.updateLink(n)}}o.default=u=(0,d.default)(u),o.default=u,t.exports=o.default},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"cells-sdk":"cells-sdk","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],21:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var l=r(e("react")),s=r(e("prop-types")),u=r(e("pydio")),d=r(e("../ShareContextConsumer")),c=e("material-ui"),e=r(e("./LinkModel")),p=u.default.requireLib("hoc").ModernSelectField,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,l["default"].Component),n(f,[{key:"onDropDownChange",value:function(e,t,o){var n=this.props.linkModel;n.getLink().ViewTemplateName=o,n.notifyDirty()}},{key:"render",value:function(){var t=void 0,e=this.props.linkModel,o=e.getLink().ViewTemplateName,n=this.props.layoutData.map(function(e){return o&&e.LAYOUT_ELEMENT===o&&(t=e.LAYOUT_LABEL),o||t||(o=e.LAYOUT_ELEMENT,t=e.LAYOUT_LABEL),l.default.createElement(c.MenuItem,{key:e.LAYOUT_ELEMENT,value:e.LAYOUT_ELEMENT,primaryText:e.LAYOUT_LABEL})});return l.default.createElement("div",{style:this.props.style},l.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},this.props.getMessage("151")),l.default.createElement(p,{fullWidth:!0,value:o,onChange:this.onDropDownChange.bind(this),disabled:this.props.isReadonly()||this.props.readonly||!e.isEditable(),floatingLabelText:this.props.getMessage("151")},n))}}]),f);function f(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a(Object.getPrototypeOf(f.prototype),"constructor",this).apply(this,arguments)}n.PropTypes={linkModel:s.default.instanceOf(e.default)},n=(0,d.default)(n),o.default=n,t.exports=o.default},{"../ShareContextConsumer":1,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],22:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var y=r(e("react")),l=r(e("prop-types")),s=r(e("pydio")),u=r(e("pydio/util/pass")),m=e("material-ui"),d=r(e("../ShareContextConsumer")),c=r(e("./LinkModel")),g=r(e("../main/ShareHelper")),p=s.default.requireLib("form").ValidPassword,e=s.default.requireLib("hoc"),v=e.ModernTextField,b=e.ModernStyles,k={leftIcon:{margin:"0 16px 0 4px",color:"#757575"}},l=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,y["default"].Component),n(f,[{key:"render",value:function(){var e=this.props.linkModel,t=e.getLink(),o=this.renderPasswordContainer(),n=e.hasPermission("Download")&&!e.hasPermission("Preview")&&!e.hasPermission("Upload"),i=parseInt(t.MaxDownloads),a=parseInt(t.AccessEnd),r=y.default.createElement(m.FontIcon,{className:"mdi mdi-calendar-clock",style:k.leftIcon}),l=void 0,s=void 0,u=void 0,d=!1,c=!1,p=new Date,f=g.default.getAuthorizations();return 0<parseInt(f.max_expiration)&&(s=new Date).setDate(p.getDate()+parseInt(f.max_expiration)),0<parseInt(f.max_downloads)&&(i=Math.max(1,Math.min(i,parseInt(f.max_downloads)))),a&&(a<0&&(d=!0),l=new Date(1e3*a),parseInt(f.max_expiration)||(r=y.default.createElement(m.IconButton,{iconStyle:{color:k.leftIcon.color},style:{marginLeft:-8,marginRight:8},iconClassName:"mdi mdi-close-circle",onClick:this.resetExpiration.bind(this)}))),i&&(f=void 0,(t=parseInt(t.CurrentDownloads)||0)&&(f=y.default.createElement("a",{style:{cursor:"pointer"},onClick:this.resetDownloads.bind(this),title:this.props.getMessage("17")},"(",this.props.getMessage("16"),")"),i<=t&&(c=!0)),u=y.default.createElement("span",{className:"dlCounterString"},t+"/"+i," ",f)),y.default.createElement("div",{style:h({padding:10},this.props.style)},y.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},this.props.getMessage("24")),y.default.createElement("div",{style:{paddingRight:10}},o,y.default.createElement("div",{style:{flex:1,display:"flex",alignItems:"baseline",position:"relative"},className:d?"limit-block-expired":null},r,y.default.createElement(m.DatePicker,h({ref:"expirationDate",key:"start",value:l,minDate:new Date,maxDate:s,autoOk:!0,disabled:this.props.isReadonly()||!e.isEditable(),onChange:this.onDateChange,showYearSelector:!0,hintText:this.props.getMessage(d?"21b":"21"),mode:"landscape",formatDate:this.formatDate,style:{flex:1},fullWidth:!0},b.textField))),y.default.createElement("div",{style:{flex:1,alignItems:"baseline",display:n?"flex":"none",position:"relative"},className:c?"limit-block-expired":null},y.default.createElement(m.FontIcon,{className:"mdi mdi-download",style:k.leftIcon}),y.default.createElement(v,{type:"number",disabled:this.props.isReadonly()||!e.isEditable(),floatingLabelText:this.props.getMessage(c?"22b":"22"),value:0<i?i:"",onChange:this.updateDLExpirationField,fullWidth:!0,style:{flex:1}}),y.default.createElement("span",{style:{position:"absolute",right:10,top:14,fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},u))))}}],[{key:"propTypes",value:{linkModel:l.default.instanceOf(c.default).isRequired,style:l.default.object},enumerable:!0}]),f);function f(){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a(Object.getPrototypeOf(f.prototype),"constructor",this).apply(this,arguments),this.state={},this.updateDLExpirationField=function(e){var t=e.currentTarget.value;parseInt(t)<0&&(t=-parseInt(t));var o=r.props.linkModel,e=o.getLink();e.MaxDownloads=t,o.updateLink(e)},this.updateDaysExpirationField=function(e,t){t=t||e.currentTarget.getValue();var o=r.props.linkModel,e=o.getLink();e.AccessEnd=t,o.updateLink(e)},this.onDateChange=function(e,t){t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());r.updateDaysExpirationField(e,Math.floor(t/1e3)+"")},this.resetPassword=function(){var e=r.props.linkModel;e.setUpdatePassword(""),e.getLink().PasswordRequired=!1,e.notifyDirty()},this.setUpdatingPassword=function(o){u.default.checkPasswordStrength(o,function(e,t){r.setState({updatingPassword:o,updatingPasswordValid:e})})},this.changePassword=function(){var e=r.props.linkModel,t=r.state.updatingPassword;e.setUpdatePassword(t),r.setState({pwPop:!1,updatingPassword:"",updatingPasswordValid:!1}),e.notifyDirty()},this.updatePassword=function(e,t){var o=r.props.linkModel;r.state.validPasswordStatus?r.setState({invalidPassword:null,invalid:!1},function(){o.setUpdatePassword(e)}):r.setState({invalidPassword:e,invalid:!0})},this.resetDownloads=function(){var e;window.confirm(r.props.getMessage("106"))&&((e=r.props.linkModel).getLink().CurrentDownloads="0",e.notifyDirty())},this.resetExpiration=function(){var e=r.props.linkModel;e.getLink().AccessEnd="0",e.notifyDirty()},this.renderPasswordContainer=function(){var e=r.props.linkModel,t=e.getLink(),o=g.default.getAuthorizations(),n=void 0,i=void 0,a=void 0;return t.PasswordRequired?(i=y.default.createElement(m.FlatButton,{disabled:r.props.isReadonly()||!e.isEditable()||o.password_mandatory,secondary:!0,onClick:r.resetPassword,label:r.props.getMessage("174")}),a=y.default.createElement("div",null,y.default.createElement(m.FlatButton,{disabled:r.props.isReadonly()||!e.isEditable(),secondary:!0,onClick:function(e){r.setState({pwPop:!0,pwAnchor:e.currentTarget})},label:r.props.getMessage("181")}),y.default.createElement(m.Popover,{open:r.state.pwPop,anchorEl:r.state.pwAnchor,anchorOrigin:{horizontal:"right",vertical:"bottom"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){r.setState({pwPop:!1})}},y.default.createElement("div",{style:{width:280,padding:8}},y.default.createElement(p,{name:"update",ref:"pwdUpdate",attributes:{label:r.props.getMessage("23")},value:r.state.updatingPassword||"",onChange:function(e){r.setUpdatingPassword(e)},onValidStatusChange:function(e){return r.setState({updatingPasswordDiffer:!e})}}),y.default.createElement("div",{style:{paddingTop:20,textAlign:"right"}},y.default.createElement(m.FlatButton,{label:s.default.getMessages()[54],onClick:function(){r.setState({pwPop:!1,updatingPassword:""})}}),y.default.createElement(m.FlatButton,{style:{minWidth:60},label:s.default.getMessages()[48],onClick:function(){r.changePassword()},disabled:!r.state.updatingPassword||!r.state.updatingPasswordValid||r.state.updatingPasswordDiffer}))))),n=y.default.createElement(v,{floatingLabelText:r.props.getMessage("23"),disabled:!0,value:"********",fullWidth:!0})):!r.props.isReadonly()&&e.isEditable()&&(n=y.default.createElement(p,{name:"share-password",ref:"pwd",attributes:{label:r.props.getMessage("23")},value:r.state.invalidPassword||e.updatePassword,onChange:r.updatePassword.bind(r),onValidStatusChange:function(e){console.log(e),r.setState({validPasswordStatus:e})}})),n?y.default.createElement("div",{className:"password-container",style:{display:"flex",alignItems:"center"}},y.default.createElement(m.FontIcon,{className:"mdi mdi-file-lock",style:k.leftIcon}),y.default.createElement("div",{style:{width:i?"40%":"100%",display:"inline-block"}},n),i&&y.default.createElement("div",{style:{width:"60%",display:"flex"}},i," ",a)):null},this.formatDate=function(e){return r.props.getMessage("date_format","").split(" ").shift().replace("Y",e.getFullYear()).replace("m",e.getMonth()+1).replace("d",e.getDate())}}o.default=l=(0,d.default)(l),o.default=l,t.exports=o.default},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],23:[function(v,b,k){!function(g){!function(){"use strict";Object.defineProperty(k,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e};function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function t(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=t(v("prop-types")),s=t(v("react")),u=t(v("react-dom")),d=t(v("../ShareContextConsumer")),c=v("material-ui"),p=t(v("clipboard")),f=t(v("../links/LinkModel")),h=(r(y,s["default"].Component),e(y,[{key:"componentDidMount",value:function(){this._clip&&this._clip.destroy(),this._button&&(this._clip=new p.default(this._button,{text:function(e){return this.props.link}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var e=void 0,e=0===g.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("share_center.143");this.setState({copyMessage:e},this.clearCopyMessage)}.bind(this)))}},{key:"componentWillUnmount",value:function(){this._clip&&this._clip.destroy()}},{key:"clearCopyMessage",value:function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(this),5e3)}},{key:"render",value:function(){var t=this,e=this.props,o=e.targetUser,e=e.link;return s.default.createElement("div",{style:{display:"flex"}},s.default.createElement("div",{style:{flex:1}},o.Display,s.default.createElement(c.IconButton,{pydio:this.props.pydio,ref:function(e){t._button=u.default.findDOMNode(e)},iconClassName:"mdi mdi-link",tooltip:this.state.copyMessage||e,iconStyle:{fontSize:13,lineHeight:"17px"},style:{width:34,height:34,padding:6}})),s.default.createElement("div",{style:{width:40,textAlign:"center"}},o.DownloadCount))}}]),y);function y(e){i(this,y),o(Object.getPrototypeOf(y.prototype),"constructor",this).call(this,e),this.state={copyMessage:""}}r(m,s["default"].Component),e(m,[{key:"render",value:function(){var e=this,o=this.props.linkModel,t=o.getLink(),n=void 0;t.TargetUsers&&(n=t.TargetUsers);var i=Object.keys(n).map(function(e){var t=o.getPublicUrl()+"?u="+e;return s.default.createElement(h,{targetUser:n[e],link:t})});if(!i.length)return null;t={borderBottom:this.state.open?"1px solid #757575":"",color:"rgba(0, 0, 0, 0.36)"};return s.default.createElement("div",{style:{lineHeight:"34px",padding:"4px 10px 4px",fontSize:14,backgroundColor:"#fafafa",borderRadius:2}},s.default.createElement("div",{style:a({display:"flex"},t)},s.default.createElement("div",{style:{flex:1}},this.props.getMessage("245").replace("%s",i.length)," ",s.default.createElement("span",{className:"mdi mdi-chevron-"+(this.state.open?"up":"down"),style:{cursor:"pointer"},onClick:function(){e.setState({open:!e.state.open})}})),this.state.open&&s.default.createElement("div",{style:{width:40,textAlign:"center"}},"#DL")),this.state.open&&s.default.createElement("div",null,i))}}]),e=m;function m(e,t){i(this,m),o(Object.getPrototypeOf(m.prototype),"constructor",this).call(this,e,t),this.state={open:!1}}e.propTypes={linkModel:l.default.instanceOf(f.default)},k.default=e=(0,d.default)(e),h=(0,d.default)(h),k.default=e,b.exports=k.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../links/LinkModel":18,clipboard:"clipboard","material-ui":"material-ui","prop-types":"prop-types",react:"react","react-dom":"react-dom"}],24:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var o=[],n=!0,i=!1,a=void 0;try{for(var r,l=e[Symbol.iterator]();!(n=(r=l.next()).done)&&(o.push(r.value),!t||o.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw a}}return o}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var s=l(e("react")),u=l(e("../ShareContextConsumer")),d=l(e("prop-types")),c=l(e("pydio")),p=l(e("pydio/http/policies")),f=e("cells-sdk"),e=l(e("./LinkModel")),h=c.default.requireLib("components").ResourcePoliciesPanel,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,s["default"].Component),n(y,[{key:"render",value:function(){var e=this.props,t=e.linkModel,o=e.pydio,n=[];n["user:"+t.getLink().UserLogin]=!0;e={READ:n,WRITE:n};return s.default.createElement("div",{style:this.props.style},t.getLink().Uuid&&s.default.createElement(h,{pydio:o,resourceType:"link",description:this.props.getMessage("link.visibility.advanced"),resourceId:t.getLink().Uuid,skipTitle:!0,onSavePolicies:this.onSavePolicies.bind(this),subjectsDisabled:e,subjectsHidden:n,readonly:this.props.isReadonly()||!t.isEditable(),ref:"policies"}))}}]),y);function y(){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),r(Object.getPrototypeOf(y.prototype),"constructor",this).apply(this,arguments),this.onSavePolicies=function(o){var e=i.props,t=e.linkModel,n=(e.pydio,t.getLink().UserLogin);p.default.loadPolicies("user",n).then(function(e){var t;e.length&&(t=e[0].Resource,t=i.diffPolicies(e,o,t),p.default.savePolicies("user",n,t))})},this.diffPolicies=function(e,o,n){var i=[];return e.map(function(e){var t=e.Action+"///"+e.Subject;o.remove[t]||i.push(e)}),Object.keys(o.add).map(function(e){var t=new f.ServiceResourcePolicy,o=e.split("///"),e=a(o,2),o=e[0],e=e[1];t.Resource=n,t.Effect=f.ServiceResourcePolicyPolicyEffect.constructFromObject("allow"),t.Subject=e,t.Action=o,i.push(t)}),i}}n.PropTypes={pydio:d.default.instanceOf(c.default).isRequired,linkModel:d.default.instanceOf(e.default).isRequired},n=(0,u.default)(n),o.default=n,t.exports=o.default},{"../ShareContextConsumer":1,"./LinkModel":18,"cells-sdk":"cells-sdk","prop-types":"prop-types",pydio:"pydio","pydio/http/policies":"pydio/http/policies",react:"react"}],25:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=r(e("react")),c=r(e("create-react-class")),p=r(e("prop-types")),f=r(e("pydio")),h=r(e("pydio/http/api")),y=r(e("pydio/model/node")),m=r(e("pydio/util/path")),g=e("cells-sdk"),v=e("material-ui"),b=f.default.requireLib("boot"),k=b.ActionDialogMixin,E=b.Loader,b=f.default.requireLib("components"),w=b.ModalAppBar,O=b.EmptyStateView,P=f.default.requireLib("hoc").ModernTextField,e=e("material-ui/styles").muiThemeable,M=(u(C,d["default"].Component),n(C,[{key:"render",value:function(){var e=this.props,t=e.value,o=e.onChange,n=e.muiTheme,i=e.m,a={color:"#616161"},e={color:n.palette.accent1Color},n={marginRight:5};return d.default.createElement(v.Tabs,{style:{width:360},onChange:function(e){o(null,0,e)},value:t,tabItemContainerStyle:{background:"transparent"}},d.default.createElement(v.Tab,{label:d.default.createElement("span",null,d.default.createElement("span",{style:n,className:"mdi mdi-share-variant"}),i(243)),value:"LINKS",buttonStyle:"LINKS"===t?e:a}),d.default.createElement(v.Tab,{label:d.default.createElement("span",null,d.default.createElement("span",{style:n,className:"icomoon-cells"}),i(254)),value:"CELLS",buttonStyle:"CELLS"===t?e:a}))}}]),C);function C(){l(this,C),a(Object.getPrototypeOf(C.prototype),"constructor",this).apply(this,arguments)}var M=e()(M),L=(u(_,d["default"].Component),n(_,[{key:"getChildContext",value:function(){var o=this.props.pydio.MessageHash;return{messages:o,getMessage:function(t){var e=arguments.length<=1||void 0===arguments[1]?"share_center":arguments[1];try{return o[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}}]),n(_,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var t=this;this.setState({filter:""});var e=new g.ShareServiceApi(h.default.getRestClient()),o=new g.RestListSharedResourcesRequest;o.ShareType=g.ListSharedResourcesRequestListShareType.constructFromObject(this.state.shareType),this.props.subject?o.Subject=this.props.subject:o.OwnedBySubject=!0,this.setState({loading:!0}),e.listSharedResources(o).then(function(e){t.setState({resources:e.Resources||[],loading:!1})}).catch(function(){t.setState({loading:!1})})}},{key:"getLongestPath",value:function(e){if(!e.AppearsIn)return{path:e.Path,basename:e.Path};var t={};e.AppearsIn.map(function(e){t[e.Path]=e});var o=Object.keys(t);o.sort();e=o[o.length-1],o=(o=m.default.getBasename(e))||t[e].WsLabel;return{path:e,appearsIn:t[e],basename:o}}},{key:"goTo",value:function(e){var t=e.Path,o=e.WsLabel,e=e.WsUuid,t=t.split("/");t.shift();t=new y.default(t.join("/"));t.getMetadata().set("repository_id",e),t.getMetadata().set("repository_label",o),this.props.pydio.goTo(t),this.props.onRequestClose()}},{key:"render",value:function(){function a(e){return i.MessageHash["share_center."+e]}var r=this,e=this.state,t=e.loading,o=e.resources,e=e.filter,n=void 0===e?"":e,e=this.props,i=e.pydio,e=e.style;o.sort(function(e,t){e=e.Node.Path,t=t.Node.Path;return e===t?0:t<e?1:-1});var l=i.Registry.getFilesExtensions();return d.default.createElement("div",{style:s({},e,{display:"flex",flexDirection:"column",overflow:"hidden"})},d.default.createElement("div",{style:{backgroundColor:"#F5F5F5",borderBottom:"1px solid #EEEEEE",display:"flex",paddingRight:16,paddingTop:3}},d.default.createElement(M,{m:a,value:this.state.shareType,onChange:function(e,t,o){r.setState({shareType:o},function(){r.load()})}}),d.default.createElement("span",{style:{flex:1}}),d.default.createElement("div",{style:{width:150}},d.default.createElement(P,{hintText:a("sharelist.quick-filter"),value:n,onChange:function(e,t){r.setState({filter:t})},fullWidth:!0}))),t&&d.default.createElement(E,{style:{height:400}}),!t&&0===o.length&&d.default.createElement(O,{pydio:i,iconClassName:"mdi mdi-share-variant",primaryTextId:a(131),style:{flex:1,height:400,padding:"90px 0",backgroundColor:"transparent"}}),!t&&0<o.length&&d.default.createElement(v.List,{style:{flex:1,minHeight:400,maxHeight:400,overflowY:"auto",paddingTop:0}},o.map(function(e){var t=r.getLongestPath(e.Node),o=t.appearsIn,n=t.basename,i=void 0;return i=-1===n.indexOf(".")?"mdi mdi-folder":(t=m.default.getFileExtension(n),l.has(t)?"mdi mdi-"+l.get(t).fontIcon:"mdi mdi-file"),{primaryText:n=e.Link&&e.Link.Label&&e.Link.Label!==n?e.Link.Label+" ("+n+")":n,secondaryText:e.Link?a(251)+": "+e.Link.Description:a(284).replace("%s",e.Cells.length),icon:i,appearsIn:o}}).filter(function(e){return console.log(n),!n||-1!==e.primaryText.toLowerCase().indexOf(n.toLowerCase())}).map(function(e){var t=e.appearsIn,o=e.icon;return d.default.createElement(v.ListItem,{primaryText:e.primaryText,secondaryText:e.secondaryText,onClick:function(){t&&r.goTo(t)},disabled:!t,leftIcon:d.default.createElement(v.FontIcon,{className:o})})})))}}]),_);function _(e){l(this,_),a(Object.getPrototypeOf(_.prototype),"constructor",this).call(this,e),this.state={resources:[],loading:!1,selectedModel:null,shareType:e.defaultShareType||"LINKS"}}L.childContextTypes={messages:p.default.object,getMessage:p.default.func,isReadonly:p.default.func};k=(0,c.default)({displayName:"ShareViewModal",mixins:[k],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this;return d.default.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},d.default.createElement(w,{title:this.props.pydio.MessageHash["share_center.98"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),d.default.createElement(L,s({},this.props,{style:{width:"100%",flex:1},onRequestClose:function(){e.dismiss()}})))}});o.ShareView=L,o.ShareViewModal=k},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/path":"pydio/util/path",react:"react"}],26:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};var r,l=e("../ShareContextConsumer"),s=(r=l)&&r.__esModule?r:{default:r},u=e("prop-types"),d=e("react").Component,c=e("material-ui").IconButton,e=e("material-ui/styles").muiThemeable,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,d),n(p,[{key:"render",value:function(){var e=this.props.muiTheme.palette,e={root:{borderRadius:"50%",border:"1px solid "+e.primary1Color,backgroundColor:"transparent",width:36,height:36,padding:8,margin:"0 6px",zIndex:0},icon:{color:e.primary1Color,fontSize:20,lineHeight:"20px"}};return React.createElement(c,{style:e.root,iconStyle:e.icon,onClick:this.props.callback||this.props.onClick,iconClassName:"mdi mdi-"+this.props.mdiIcon,tooltip:this.props.getMessage(this.props.messageId,this.props.messageCoreNamespace?"":void 0),tooltipPosition:this.props.tooltipPosition})}}]),p);function p(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),a(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,arguments)}n.propTypes={callback:u.func,onClick:u.func,mdiIcon:u.string,messageId:u.string},n=(0,s.default)(n),n=e()(n),o.default=n,t.exports=o.default},{"../ShareContextConsumer":1,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],27:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function h(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,u=e("react"),y=(s=u)&&s.__esModule?s:{default:s},m=e("material-ui"),e=e("material-ui/styles"),g=(l(d,y["default"].Component),n(d,[{key:"render",value:function(){var e=this.props,t=e.tabs,o=e.active,n=e.onChange,i=e.style,a=e.muiTheme.palette.primary1Color;return y.default.createElement("div",{style:f({display:"flex"},i)},t.map(function(e){var t=e.Value===o;return y.default.createElement(m.FlatButton,{label:e.Label,onClick:function(){n(e.Value)},primary:t,style:t?{borderBottom:"2px solid "+a}:{borderBottom:0}})}),y.default.createElement("span",{style:{flex:1}}))}}]),d);function d(){r(this,d),a(Object.getPrototypeOf(d.prototype),"constructor",this).apply(this,arguments)}var g=(0,e.muiThemeable)()(g),v=(l(c,y["default"].Component),n(c,[{key:"render",value:function(){var e=this.props,t=e.tabs,o=e.active,n=null;return t.map(function(e){e.Value===o&&(n=e.Component)}),n}}]),c);function c(){r(this,c),a(Object.getPrototypeOf(c.prototype),"constructor",this).apply(this,arguments)}l(p,y["default"].Component),n(p,[{key:"componentWillReceiveProps",value:function(e){!this.state.left&&e.tabs.left.length&&this.setState({left:e.tabs.left[0].Value}),!this.state.right&&e.tabs.right.length&&this.setState({right:e.tabs.right[0].Value})}},{key:"render",value:function(){var t=this,e=this.props,o=e.tabs,n=e.header,i=e.onSaveAction,a=e.onCloseAction,r=e.onRevertAction,l=e.saveEnabled,s=e.style,u=e.pydio,d=e.editorOneColumn,c=this.state,p=c.left,e=c.right;if(d){c=[].concat(h(o.left),h(o.right)),d=c.filter(function(e){return e.AlwaysLast});return d.length&&(c=[].concat(h(c.filter(function(e){return!e.AlwaysLast})),[d[0]])),y.default.createElement("div",{style:f({display:"flex",flexDirection:"column",height:"100%"},s)},y.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},y.default.createElement("div",{style:{backgroundColor:"#EEEEEE",display:"flex",alignItems:"center",justifyContent:"flex-end"}},y.default.createElement(m.RaisedButton,{disabled:!l,primary:!0,label:u.MessageHash[53],onClick:i}),y.default.createElement(m.FlatButton,{disabled:!l,label:u.MessageHash[628],onClick:r,style:{marginLeft:10}}),y.default.createElement(m.IconButton,{iconClassName:"mdi mdi-close",tooltip:u.MessageHash[86],onClick:a,style:{marginLeft:10}})),y.default.createElement("div",{style:{flex:1,padding:"10px 20px"}},n)),y.default.createElement("div",{style:{display:"flex"}},y.default.createElement(g,{tabs:c,active:p,style:{flex:1},onChange:function(e){t.setState({left:e})}})),y.default.createElement(m.Divider,null),y.default.createElement("div",{style:{display:"flex",flex:1}},y.default.createElement("div",{style:f({overflowY:"auto",width:"100%",height:"100%",padding:10},o.leftStyle)},y.default.createElement(v,{tabs:c,active:p}))))}return y.default.createElement("div",{style:f({display:"flex",flexDirection:"column",height:"100%"},s)},y.default.createElement("div",{style:{display:"flex",padding:"10px 20px 20px"}},y.default.createElement("div",{style:{flex:1,paddingRight:20}},n),y.default.createElement("div",{style:{paddingTop:18}},y.default.createElement(m.RaisedButton,{disabled:!l,primary:!0,label:u.MessageHash[53],onClick:i}),y.default.createElement(m.FlatButton,{disabled:!l,label:u.MessageHash[628],onClick:r,style:{marginLeft:10}}),y.default.createElement(m.IconButton,{iconClassName:"mdi mdi-close",tooltip:u.MessageHash[86],onClick:a,style:{marginLeft:10}}))),y.default.createElement("div",{style:{display:"flex"}},y.default.createElement(g,{tabs:o.left,active:p,style:{flex:1},onChange:function(e){t.setState({left:e})}}),y.default.createElement(g,{tabs:o.right,active:e,style:{flex:1},onChange:function(e){t.setState({right:e})}})),y.default.createElement(m.Divider,null),y.default.createElement("div",{style:{display:"flex",flex:1}},y.default.createElement("div",{style:f({overflowY:"auto",width:"50%",borderRight:"1px solid #e0e0e0",padding:10},o.leftStyle)},y.default.createElement(v,{tabs:o.left,active:p})),y.default.createElement("div",{style:f({overflowY:"auto",width:"50%",padding:10},o.rightStyle)},y.default.createElement(v,{tabs:o.right,active:e}))))}}]),n=p;function p(e){r(this,p),a(Object.getPrototypeOf(p.prototype),"constructor",this).call(this,e),this.state={left:e.tabs.left.length?e.tabs.left[0].Value:"",right:e.tabs.right.length?e.tabs.right[0].Value:""}}o.default=n,t.exports=o.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",react:"react"}],28:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e};function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(e,t,o){for(var n=!0;n;){var i=e,a=t,r=o,n=!1;null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(r)}i=Object.getPrototypeOf(i);if(null===i)return;e=i,t=a,o=r,n=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var l=r(e("react")),s=(e("material-ui"),r(e("../composite/CompositeCard"))),u=r(e("../cells/CellCard")),n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),n(d,[{key:"openPopover",value:function(e){this.setState({popoverOpen:!0,popoverAnchor:e.target})}},{key:"render",value:function(){var e=this.props,t=e.pydio,e=e.node;return e.isRoot()?l.default.createElement(PydioWorkspaces.InfoPanelCard,null,l.default.createElement("div",{style:{padding:0}},l.default.createElement(u.default,{cellId:t.user.activeRepository,pydio:t,mode:"infoPanel"}))):l.default.createElement(PydioWorkspaces.InfoPanelCard,null,l.default.createElement("div",{style:{padding:0}},l.default.createElement(s.default,{node:e,pydio:t,mode:"infoPanel"})))}}]),d);function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),a(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,e),this.state={popoverOpen:!1}}o.default=n,t.exports=o.default},{"../cells/CellCard":2,"../composite/CompositeCard":10,"material-ui":"material-ui",react:"react"}],29:[function(a,l,p){!function(i){!function(){"use strict";Object.defineProperty(p,"__esModule",{value:!0});var e=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e};function n(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return e&&e.__esModule?e:{default:e}}var o=t(a("pydio/util/xml")),s=t(a("pydio/http/api")),u=t(a("pydio")),d=a("cells-sdk"),r=u.default.requireLib("boot").moment,e=(e(c,null,[{key:"mailerSupported",value:function(e){return e.Parameters.get("validMailer")}},{key:"getAuthorizations",value:function(){var e=u.default.getInstance(),t=e.getPluginConfigs("action.share"),o={folder_public_link:t.get("ENABLE_FOLDER_PUBLIC_LINK"),folder_workspaces:t.get("ENABLE_FOLDER_INTERNAL_SHARING"),file_public_link:t.get("ENABLE_FILE_PUBLIC_LINK"),file_workspaces:t.get("ENABLE_FILE_INTERNAL_SHARING"),editable_hash:t.get("HASH_USER_EDITABLE"),hash_min_length:t.get("HASH_MIN_LENGTH")||6,password_mandatory:!1,max_expiration:t.get("FILE_MAX_EXPIRATION"),max_downloads:t.get("FILE_MAX_DOWNLOAD")},t=t.get("SHARE_FORCE_PASSWORD");return t&&(o.password_mandatory=!0),o.password_placeholder=t?e.MessageHash["share_center.176"]:e.MessageHash["share_center.148"],o}},{key:"buildPublicUrl",value:function(e,t){var o=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],n=e.Parameters;if(o)return"..."+n.get("PUBLIC_BASEURI")+"/"+t.LinkHash;if(t.LinkUrl&&t.LinkUrl.match(new RegExp("^http://|^https://")))return t.LinkUrl;e=e.getFrontendUrl();return e.protocol+"//"+e.host+n.get("PUBLIC_BASEURI")+"/"+t.LinkHash}},{key:"nodeHasEditor",value:function(e,t){var o;return t.getMetadata().has("mime_has_preview_editor")||(e=(o=(o=e.Registry.findEditorsForMime(t.getAjxpMime())).filter(function(e){return"editor.browser"!==e.id&&"editor.other"!==e.id})).filter(function(e){return e.canWrite}),t.getMetadata().set("mime_has_preview_editor",0<o.length),t.getMetadata().set("mime_has_writeable_editor",0<e.length)),{preview:t.getMetadata().get("mime_has_preview_editor"),writeable:t.getMetadata().get("mime_has_writeable_editor")}}},{key:"compileLayoutData",value:function(i,e){var t=void 0,a=void 0,r=e.getNode();if(!(t=r.isLeaf()?(a=r.getAjxpMime(),o.default.XPathSelectNodes(i.getXmlRegistry(),"//template[contains(@name, 'unique_preview_')]")):o.default.XPathSelectNodes(i.getXmlRegistry(),"//template[contains(@name, 'minisite_')]")).length)return[];if(1===t.length)return[{LAYOUT_NAME:t[0].getAttribute("element"),LAYOUT_LABEL:""}];var l=i.Parameters.get("theme"),s=[];return t.map(function(e){var t,o,n=e.getAttribute("theme");n&&n!==l||(t=e.getAttribute("element"),o=e.getAttribute("name"),n=e.getAttribute("label"),a&&"unique_preview_file"===o&&!c.nodeHasEditor(i,r).preview||(n?MessageHash[n]&&(n=MessageHash[n]):n=e.getAttribute("name"),s[o]=t,s.push({LAYOUT_NAME:o,LAYOUT_ELEMENT:t,LAYOUT_LABEL:n})))}),s}},{key:"forceMailerOldSchool",value:function(){return i.pydio.getPluginConfigs("action.share").get("EMAIL_INVITE_EXTERNAL")}},{key:"qrcodeEnabled",value:function(){return i.pydio.getPluginConfigs("action.share").get("CREATE_QRCODE")}},{key:"sendCellInvitation",value:function(e,t,o){var n=arguments.length<=3||void 0===arguments[3]?function(){}:arguments[3],i=c.prepareEmail(e,null,t),a=i.templateId,e=i.templateData,r=new d.MailerMail,t=new d.MailerServiceApi(s.default.getRestClient());r.To=[];var l=0;Object.keys(o).map(function(e){var t=o[e],e=new d.MailerUser;return t.IdmUser&&t.IdmUser.Login&&t.IdmUser.Attributes&&(t.IdmUser.Attributes.hasEmail||t.IdmUser.Attributes.email)?(e.Uuid=t.IdmUser.Login,r.To.push(e)):l++,e});i=u.default.getInstance().MessageHash;r.To.length?(r.TemplateId=a,r.TemplateData=e,t.send(r).then(function(){n()}),t=i["core.mailer.1"].replace("%s",r.To.length),0<l&&(t+=" "+i["core.mailer.entries.ignored"]),u.default.getInstance().UI.displayMessage("SUCCESS",t)):u.default.getInstance().UI.displayMessage("ERROR",i["core.mailer.entries.ignored"])}},{key:"prepareEmail",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],o=arguments.length<=2||void 0===arguments[2]?null:arguments[2],n={},i="",a=pydio.user;return a.getPreference("displayName")?n.Inviter=a.getPreference("displayName"):n.Inviter=a.id,t?(a=t.getLink(),e.isLeaf()?(i="PublicFile",n.FileName=a.Label||e.getLabel()):(i="PublicFolder",n.FolderName=a.Label||e.getLabel()),n.LinkPath="/public/"+a.LinkHash,a.MaxDownloads&&(n.MaxDownloads=a.MaxDownloads+""),a.AccessEnd&&(a=r(new Date(1e3*a.AccessEnd)),n.Expire=a.format("LL"))):(i="Cell",n.Cell=o.getLabel()),{templateId:i,templateData:n,message:"",linkModel:t}}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c)}p.default=e,l.exports=p.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/xml":"pydio/util/xml"}]},{},[15])(15)});