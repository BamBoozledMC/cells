!function a(o,i,n){function l(r,e){if(!i[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(s)return s(r,!0);t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}t=i[r]={exports:{}};o[r][0].call(t.exports,function(e){var t=o[r][1][e];return l(t||e)},t,t.exports,a,o,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,e=0;e<n.length;e++)l(n[e]);return l}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i,n=e("pydio/http/api"),l=(i=n)&&i.__esModule?i:{default:i},a=(a(s,null,[{key:"deleteAction",value:function(e,t){var a=void 0,t=(a=t&&t.length?t[0]:pydio.getUserSelection()).getUniqueNode(),r=void 0;switch(t.getMetadata().get("ajxp_mime")){case"user_editable":r="settings.34";break;case"group":r="settings.126"}var o,i=function(){};t.getParent()&&(o=t.getParent(),i=function(){o.reload(null,!0)});pydio.UI.openConfirmDialog({message:MessageHash[r],validCallback:function(){var r=a.getSelectedNodes();(function t(){var e;r.length&&(e=r.shift(),l.default.getRestClient().getIdmApi().deleteIdmUser(e.getMetadata().get("IdmUser")).then(function(){i(),t()}).catch(function(e){Pydio.getInstance().UI.displayMessage("ERROR",e.message),t()}))})()}})}},{key:"applyDND",value:function(e,t){t.getStep()===PydioComponents.DNDActionParameter.STEP_CAN_DROP?AdminComponents.DNDActionsManager.canDropNodeOnNode(t.getSource(),t.getTarget()):t.getStep()===PydioComponents.DNDActionParameter.STEP_END_DRAG&&AdminComponents.DNDActionsManager.dropNodeOnNode(t.getSource(),t.getTarget())}}]),s);function s(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s)}r.default=a,t.exports=r.default},{"pydio/http/api":"pydio/http/api"}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};function a(e){return e&&e.__esModule?e:{default:e}}var v=a(e("react")),o=a(e("create-react-class")),b=e("material-ui"),l=a(e("../editor/Editor")),i=a(e("pydio/model/data-model")),n=e("material-ui/styles"),P=(a(e("pydio/http/resources-manager")),a(e("./UsersSearchBox"))),s=a(e("pydio/model/node")),u=a(e("./Callbacks")),c=a(e("prop-types")),d=a(e("pydio")),p=(a(e("pydio/util/func")),e("../editor/util/ClassLoader")),f=d.default.requireLib("boot").JobsStore,c=(0,o.default)({displayName:"Dashboard",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:c.default.instanceOf(i.default).isRequired,rootNode:c.default.instanceOf(s.default).isRequired,currentNode:c.default.instanceOf(s.default).isRequired,accessByName:c.default.func.isRequired,openEditor:c.default.func.isRequired},getInitialState:function(){var e=this.props;return{searchResultData:!1,currentNode:e.currentNode,dataModel:e.dataModel,showAnon:!1}},componentDidMount:function(){var r=this,e=f.getInstance();this._jStoreObserver=function(t){t&&0===t.indexOf("delete-group-")&&e.getJobs().then(function(e){try{"Finished"===e.get(t).Tasks[0].Status&&r.reloadList()}catch(e){}})},e.observe("tasks_updated",this._jStoreObserver)},componentWillUnmounnt:function(){f.getInstance().stopObserving("tasks_updated",this._jStoreObserver)},componentWillReceiveProps:function(e){!this.state.searchResultData&&e.currentNode&&0===e.currentNode.getPath().indexOf("/idm/users")&&this.setState({currentNode:e.currentNode,dataModel:e.dataModel})},reloadList:function(){this.refs.mainlist&&this.refs.mainlist.reload()},renderListUserAvatar:function(e){var t=e.getMetadata().get("IdmUser"),r=this.props.pydio;if(t.Attributes&&t.Attributes.avatar){t=r.Parameters.get("ENDPOINT_REST_API")+"/frontend/binaries/USER/"+t.Login+"?"+t.Attributes.avatar+"&dim=33";return v.default.createElement("div",{style:{width:33,height:33,backgroundImage:"url("+t+")",backgroundSize:"cover",borderRadius:"50%",backgroundPosition:"center",margin:16}})}e=e.isLeaf()?"mdi mdi-account":"mdi mdi-folder";return v.default.createElement(b.FontIcon,{className:e,style:{backgroundColor:"#9e9e9e",color:"white",borderRadius:"50%",margin:16,width:33,height:33,fontSize:18,padding:6,textAlign:"center"}})},renderListEntryFirstLine:function(e){var t=e.getMetadata().get("IdmUser"),r=t.Attributes?t.Attributes.profile:"",a=[],o={display:"inline-block",marginLeft:5,fontSize:14};return"shared"===r?a.push(v.default.createElement("span",{className:"mdi mdi-share-variant",style:g({},o,{color:"#009688"}),title:this.context.getMessage("user.13")})):"admin"===r&&a.push(v.default.createElement("span",{className:"mdi mdi-security",style:g({},o,{color:"#03a9f4"})})),t.Attributes&&t.Attributes.locks&&-1<t.Attributes.locks.indexOf("logout")&&a.push(v.default.createElement("span",{className:"mdi mdi-lock",style:g({},o,{color:"#E53934"})})),v.default.createElement("span",null,e.getLabel()," ",a)},renderListEntrySecondLine:function(e){var t=e.getMetadata().get("IdmUser");if(e.isLeaf()){if("/idm/users"===e.getPath())return this.context.getMessage("user.8");var r=[];r.push(t.Login);var a=t.Attributes||{};a.profile&&r.push("Profile "+a.profile),a.last_connection_readable&&r.push(this.context.getMessage("user.9")+" "+a.last_connection_readable);t=t.Roles;return t&&t.length&&r.push(this.context.getMessage("user.11").replace("%i",t.length)),r.join(" - ")}return this.context.getMessage("user.12")+": "+e.getPath().replace("/idm/users","")},renderListEntrySelector:function(e){return"/idm/users"!==e.getPath()&&e.isLeaf()},displaySearchResults:function(e,t){this.setState({searchResultTerm:e,searchResultData:{term:e,toggleState:this.hideSearchResults},currentNode:t.getContextNode(),dataModel:t})},hideSearchResults:function(){this.setState({searchResultData:!1,currentNode:this.props.currentNode,dataModel:this.props.dataModel})},createUserAction:function(){pydio.UI.openComponentInModal("AdminPeople","Forms.CreateUserForm",{dataModel:this.props.dataModel,openRoleEditor:this.openRoleEditor.bind(this)})},createGroupAction:function(){pydio.UI.openComponentInModal("AdminPeople","Forms.CreateRoleOrGroupForm",{type:"group",openRoleEditor:this.openRoleEditor.bind(this)})},openUsersImporter:function(){pydio.UI.openComponentInModal("EnterprisePeople","UsersImportDialog",{dataModel:this.props.dataModel})},openRoleEditor:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?"activity":arguments[1],a=this.props,o=a.pydio,i=a.rolesEditorClass,a=a.rolesEditorProps;if(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(o.MessageHash["role_editor.19"]))return!1;var n=g({ref:"editor",node:e,pydio:o,initialEditSection:r,onRequestTabClose:this.closeRoleEditor,afterSave:function(){t.reloadList()}},a);(0,p.loadEditorClass)(i,l.default).then(function(e){t.props.openRightPane({COMPONENT:e,PROPS:n})})},closeRoleEditor:function(){if(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(this.props.pydio.MessageHash["role_editor.19"]))return!1;this.props.closeRightPane()},deleteAction:function(e){var t=new i.default;t.setSelectedNodes([e]),u.default.deleteAction(null,[t])},renderNodeActions:function(t){var r=this,e=t.getAjxpMime();if(t.getMetadata().has("IdmUser")&&!t.getMetadata().get("IdmUser").PoliciesContextEditable)return v.default.createElement("div",null);var a={color:"rgba(0,0,0,0.3)",fontSize:20},o=[];return"user_editable"===e||"group"===e?(o.push(v.default.createElement(b.IconButton,{key:"edit",iconClassName:"mdi mdi-pencil",onClick:function(e){e.stopPropagation(),r.openRoleEditor(t)},iconStyle:a})),o.push(v.default.createElement(b.IconButton,{key:"delete",iconClassName:"mdi mdi-delete",onClick:function(e){e.stopPropagation(),r.deleteAction(t)},iconStyle:a}))):"user"===e&&(o.push(v.default.createElement(b.IconButton,{key:"edit",iconClassName:"mdi mdi-pencil",onClick:function(e){e.stopPropagation(),r.openRoleEditor(t)},iconStyle:a})),o.push(v.default.createElement(b.IconButton,{key:"delete",iconClassName:"mdi mdi-delete",disabled:!0,iconStyle:{color:"rgba(0,0,0,0.15)",fontSize:20},onClick:function(e){e.stopPropagation()}}))),v.default.createElement("div",null,o)},filterNodes:function(e){if(!e.getMetadata().has("IdmUser"))return!0;var t=this.state,r=t.showAnon;return!(!t.displaySearchResult&&!r)||"anon"!==(e.getMetadata().get("IdmUser").Attributes||{}).profile},applyFilter:function(e){var t,r=this;"toggle-anon"!==e?((t=this.props.currentNode).getMetadata().set("userProfileFilter",e),t.getMetadata().delete("paginationData"),this.setState({currentNode:t},function(){r.reloadList()})):this.setState({showAnon:!this.state.showAnon})},render:function(){var r=this,e=this.props,t=e.accessByName,a=e.muiTheme,o=e.rootNode,i=e.pydio,n=AdminComponents.AdminStyles(a.palette),l=this.state,s=l.searchResultData,u=l.currentNode,c=l.dataModel,d=l.showAnon,p=v.default.createElement(P.default,{displayResults:this.displaySearchResults,displayResultsState:s,hideResults:this.hideSearchResults,limit:50,textLabel:this.context.getMessage("user.7"),className:"media-small-hide"}),f=[],m=function(){return[]},y=null,h=[];t("Create")&&(m=this.renderNodeActions.bind(this),h=[i.Controller.getActionByName("delete")],y=this.openRoleEditor.bind(this),f=[v.default.createElement(b.FlatButton,g({primary:!0,label:this.context.getMessage("user.1"),onClick:this.createUserAction},n.props.header.flatButton)),v.default.createElement(b.FlatButton,g({primary:!0,label:this.context.getMessage("user.2"),onClick:this.createGroupAction},n.props.header.flatButton))]);e="",l=""===(e=u.getMetadata().has("userProfileFilter")?u.getMetadata().get("userProfileFilter"):e)?"rgba(0,0,0,0.4)":a.palette.accent1Color,t=v.default.createElement(b.IconMenu,{iconButtonElement:v.default.createElement(b.IconButton,{style:{marginRight:-16,marginLeft:8},iconStyle:{color:l},iconClassName:"mdi mdi-filter-variant",tooltip:this.context.getMessage("user.filter.tooltip"),tooltipPosition:"bottom-left"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},value:e,onChange:function(e,t){r.applyFilter(t)},desktop:!0},v.default.createElement(b.MenuItem,{value:"",primaryText:this.context.getMessage("user.filter.all")}),v.default.createElement(b.MenuItem,{value:"!shared",primaryText:this.context.getMessage("user.filter.internal")}),v.default.createElement(b.MenuItem,{value:"shared",primaryText:this.context.getMessage("user.filter.shared")}),v.default.createElement(b.MenuItem,{value:"admin",primaryText:this.context.getMessage("user.filter.admins")}),v.default.createElement(b.Divider,null),v.default.createElement(b.MenuItem,{value:"toggle-anon",primaryText:this.context.getMessage("user.filter.anon"),secondaryText:d?v.default.createElement(b.FontIcon,{className:"mdi mdi-check"}):null})),n=AdminComponents.AdminStyles().body,a=n.block.props,l=n.block.container,e=g({height:48,lineHeight:"48px",fontSize:12,fontWeight:500},n.block.header,{borderBottom:"1px solid "+n.tableMaster.row.borderBottomColor,padding:"0 20px"}),d={width:226,borderRight:"1px solid"+n.tableMaster.row.borderBottomColor,overflowY:"auto",flex:"none"};return!1!==s&&(d=g({},d,{opacity:.6})),v.default.createElement("div",{className:"main-layout-nav-to-stack vertical-layout people-dashboard"},v.default.createElement(AdminComponents.Header,{title:this.context.getMessage("2","settings"),icon:"mdi mdi-account-multiple",actions:f,centerContent:p}),v.default.createElement(b.Paper,g({},a,{style:l,className:"horizontal-layout layout-fill"}),v.default.createElement("div",{className:"hide-on-vertical-layout vertical-layout tab-vertical-layout",style:d},v.default.createElement("div",{style:{flex:1}},v.default.createElement("div",{style:e},this.context.getMessage("user.3")),v.default.createElement(PydioComponents.DNDTreeView,{showRoot:!0,rootLabel:this.context.getMessage("user.5"),node:o,dataModel:this.props.dataModel,className:"users-groups-tree",paddingOffset:10,noPaginator:!0}))),v.default.createElement("div",{zDepth:0,className:"layout-fill vertical-layout people-list"},v.default.createElement(PydioComponents.SimpleList,{ref:"mainlist",pydio:i,node:u,dataModel:c,clearSelectionOnReload:!1,openEditor:y,entryRenderIcon:this.renderListUserAvatar.bind(this),entryRenderFirstLine:this.renderListEntryFirstLine.bind(this),entryRenderSecondLine:this.renderListEntrySecondLine.bind(this),entryEnableSelector:this.renderListEntrySelector.bind(this),entryRenderActions:m,searchResultData:s,elementHeight:PydioComponents.SimpleList.HEIGHT_TWO_LINES,hideToolbar:!1,toolbarStyle:{backgroundColor:n.block.header.backgroundColor,height:48,borderBottom:e.borderBottom},multipleActions:h,additionalActions:t,filterNodes:this.filterNodes.bind(this)}))))}});r.default=c=(0,n.muiThemeable)()(c),r.default=c,t.exports=r.default},{"../editor/Editor":12,"../editor/util/ClassLoader":44,"./Callbacks":1,"./UsersSearchBox":5,"create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node","pydio/util/func":"pydio/util/func",react:"react"}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};function a(e){return e&&e.__esModule?e:{default:e}}var o=a(e("prop-types")),i=a(e("pydio")),m=a(e("react")),n=a(e("create-react-class")),l=a(e("pydio/model/data-model")),s=a(e("pydio/model/node")),u=a(e("pydio/http/resources-manager")),y=e("material-ui"),c=e("cells-sdk"),d=a(e("pydio/http/api")),p=e("material-ui/styles"),h=e("uuid"),g=a(e("../policies/Policy")),v=i.default.requireLib("components").MaterialTable,b=["acl","rest","oidc"],o=(0,n.default)({displayName:"PoliciesBoard",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:o.default.instanceOf(l.default).isRequired,rootNode:o.default.instanceOf(s.default).isRequired,currentNode:o.default.instanceOf(s.default).isRequired,openEditor:o.default.func.isRequired,openRightPane:o.default.func.isRequired,closeRightPane:o.default.func.isRequired,readonly:o.default.bool},componentWillMount:function(){this.listPolicies()},getInitialState:function(){return{policies:{},popoverOpen:!1,anchorEl:null}},groupByResourcesGroups:function(r){var a=[];return b.map(function(t){var e=r.PolicyGroups.filter(function(e){return(e.ResourceGroup||"rest")===t});e.length&&(e.sort(function(e,t){return e.Name.toLowerCase()<t.Name.toLowerCase()?-1:e.Name.toLowerCase()===t.Name.toLowerCase()?0:1}),a[t]=e)}),a},listPolicies:function(){var t=this;this.setState({loading:!0});var e=new c.PolicyServiceApi(d.default.getRestClient());i.default.startLoading(),e.listPolicies(new c.IdmListPolicyGroupsRequest).then(function(e){i.default.endLoading();e=t.groupByResourcesGroups(e);t.setState({policies:e,loading:!1})}).catch(function(e){i.default.endLoading(),t.setState({error:e,loading:!1})})},savePolicy:function(t,e){var r=this;e?this.listPolicies():u.default.loadClass("EnterpriseSDK").then(function(e){new e.EnterprisePolicyServiceApi(d.default.getRestClient()).putPolicy(t).then(function(){r.listPolicies()}).catch(function(e){r.setState({error:e})})})},deletePolicy:function(t){var r=this,e=this.props.pydio;e.UI.openConfirmDialog({message:e.MessageHash["ajxp_admin.policies.policy.delete.confirm"],destructive:[t.Name],validCallback:function(){u.default.loadClass("EnterpriseSDK").then(function(e){new e.EnterprisePolicyServiceApi(d.default.getRestClient()).deletePolicy(t.Uuid).then(function(){r.listPolicies()}).catch(function(e){r.setState({error:e})})})}})},createPolicy:function(e){var t=this.refs,r=t.newPolicyName,a=t.newPolicyDescription,o=this.state.newPolicyType,t=(0,h.v4)(),r={Uuid:t,Name:r.getValue(),Description:a.getValue(),ResourceGroup:o,Policies:[]},a=f({},this.state.policies);a[o]||(a[o]=[]),a[o].push(r),this.setState({policies:a,popoverOpen:!1,newPolicyId:t,selectedPolicy:t})},openPopover:function(e){var t=this;e.preventDefault(),this.setState({newPolicyType:"acl",popoverOpen:!0,anchorEl:e.currentTarget},function(){setTimeout(function(){t.refs.newPolicyName.focus()},200)})},handleRequestClose:function(){this.setState({popoverOpen:!1})},handleChangePolicyType:function(e,t,r){this.setState({newPolicyType:r})},selectRows:function(e){var t;e.length&&(t=e[0],e=this.state.selectedPolicy,this.setState({selectedPolicy:e===t.Uuid?null:t.Uuid}))},render:function(){function o(e){return a.MessageHash["ajxp_admin.policies."+e]||e}var i=this,e=this.props,t=e.muiTheme,r=e.currentNode,a=e.pydio,e=e.accessByName,n=(n=this.props.readonly)||!e("Create"),e=this.state,l=e.policies,s=e.selectedPolicy,u=e.newPolicyId,c=AdminComponents.AdminStyles(t.palette),d=[{name:"Name",label:o("policy.name"),style:{fontSize:15},sorter:{type:"string",default:!0}},{name:"Rules",label:o("policy.rules"),style:{width:80,textAlign:"center"},headerStyle:{width:80,textAlign:"center"},renderCell:function(e){return e.Policies.length},sorter:{type:"number"}},{name:"Description",label:o("policy.description"),sorter:{type:"string"}}],p=[];n?p.push({iconClassName:"mdi mdi-eye",tooltip:o("policy.display"),onClick:function(e){return i.setState({selectedPolicy:s===e.Uuid?null:e.Uuid})}}):(p.push({iconClassName:"mdi mdi-pencil",tooltip:o("policy.edit"),onClick:function(e){return i.setState({selectedPolicy:s===e.Uuid?null:e.Uuid})}}),p.push({iconClassName:"mdi mdi-delete",tooltip:o("policy.delete"),onClick:function(e){i.deletePolicy(e)}}));e=Object.keys(l).map(function(e){if(n&&"acl"===e)return null;var t=l[e].map(function(e){return e.Uuid===s?f({},e,{expandedRow:m.default.createElement(g.default,f({},i.props,{readonly:n,key:e.Name,policy:e,savePolicy:i.savePolicy.bind(i),deletePolicy:i.deletePolicy.bind(i),newPolicyWithRule:u===e.Uuid?e.Name:null}))}):e}),r=o("type."+e+".title"),a=o("type."+e+".legend");return m.default.createElement("div",null,m.default.createElement(AdminComponents.SubHeader,{title:r,legend:a}),m.default.createElement(y.Paper,f({},c.body.block.props,{style:c.body.block.container}),m.default.createElement(v,{data:t,columns:d,actions:p,onSelectRows:function(e){return i.selectRows(e)},deselectOnClickAway:!0,showCheckboxes:!1,masterStyles:c.body.tableMaster,storageKey:"console.policies."+e+".list"})))}),t=m.default.createElement("div",null,m.default.createElement(y.FlatButton,f({},c.props.header.flatButton,{primary:!0,onClick:this.openPopover.bind(this),label:o("policy.new")})),m.default.createElement(y.Popover,{open:this.state.popoverOpen,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},m.default.createElement("div",null,m.default.createElement("div",{style:{padding:"0 12px"}},m.default.createElement(y.TextField,{floatingLabelText:o("policy.name"),ref:"newPolicyName"}),m.default.createElement("br",null),m.default.createElement(y.TextField,{floatingLabelText:o("policy.description"),ref:"newPolicyDescription"}),m.default.createElement("br",null),m.default.createElement(y.SelectField,{floatingLabelText:o("policy.type"),ref:"newPolicyType",value:this.state.newPolicyType||"rest",onChange:this.handleChangePolicyType.bind(this)},b.map(function(e){return m.default.createElement(y.MenuItem,{value:e,primaryText:o("type."+e+".title")})}))),m.default.createElement(y.Divider,null),m.default.createElement("div",{style:{textAlign:"right",padding:"6px 12px"}},m.default.createElement(y.FlatButton,{label:a.MessageHash[54],onClick:this.handleRequestClose.bind(this)}),m.default.createElement(y.FlatButton,{label:o("policy.create"),onClick:this.createPolicy.bind(this)})))));return m.default.createElement("div",{className:"vertical-layout",style:{height:"100%"}},m.default.createElement(AdminComponents.Header,{title:r.getLabel(),icon:r.getMetadata().get("icon_class"),actions:n?null:t,reloadAction:this.listPolicies.bind(this),loading:this.state.loading}),m.default.createElement("div",{className:"layout-fill"},e))}});r.default=o=(0,p.muiThemeable)()(o),r.default=o,t.exports=r.default},{"../policies/Policy":49,"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node",react:"react",uuid:52}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};function a(e){return e&&e.__esModule?e:{default:e}}var p=a(e("react")),o=a(e("create-react-class")),f=e("material-ui"),l=a(e("../editor/Editor")),i=a(e("pydio/http/api")),n=a(e("pydio")),s=e("../editor/util/ClassLoader"),e=e("material-ui/styles").muiThemeable,m=n.default.requireLib("components").MaterialTable,y=n.default.requireLib("hoc").ModernTextField,o=(0,o.default)({displayName:"RolesDashboard",mixins:[AdminComponents.MessagesConsumerMixin],getInitialState:function(){return{roles:[],loading:!1,showTechnical:!1}},load:function(){var t=this,e=this.state.showTechnical;this.setState({loading:!0}),n.default.startLoading(),i.default.getRestClient().getIdmApi().listRoles(e,0,1e3).then(function(e){n.default.endLoading(),t.setState({roles:e,loading:!1})}).catch(function(e){n.default.endLoading(),t.setState({loading:!1})})},componentDidMount:function(){this.load()},openTableRows:function(e){e.length&&e[0].role.PoliciesContextEditable&&this.openRoleEditor(e[0].role)},openRoleEditor:function(t){var r=this,a=arguments.length<=1||void 0===arguments[1]?"activity":arguments[1],e=this.props,o=e.pydio,i=e.rolesEditorClass,n=e.rolesEditorProps;return!(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(o.MessageHash["role_editor.19"]))&&((0,s.loadEditorClass)(i,l.default).then(function(e){r.props.openRightPane({COMPONENT:e,PROPS:d({ref:"editor",idmRole:t,pydio:o,initialEditSection:a,onRequestTabClose:r.closeRoleEditor},n)})}),!0)},closeRoleEditor:function(){return!(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(this.props.pydio.MessageHash["role_editor.19"]))&&(this.props.closeRightPane(),!0)},deleteAction:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1],a=this.props.pydio;a.UI.openConfirmDialog({message:a.MessageHash["settings.126"],destructive:[r||e],validCallback:function(){i.default.getRestClient().getIdmApi().deleteRole(e).then(function(){t.load()})}})},createRoleAction:function(){var e=this;pydio.UI.openComponentInModal("AdminPeople","Forms.CreateRoleOrGroupForm",{type:"role",roleNode:this.state.currentNode,openRoleEditor:this.openRoleEditor.bind(this),roles:this.state.roles,reload:function(){e.load()}})},computeTableData:function(r){var e=this.state.roles,a=[];return e.map(function(e){var t=e.Label;r&&-1===t.toLowerCase().indexOf(r.toLowerCase())||a.push({role:e,roleId:e.Uuid,roleLabel:t,isDefault:e.AutoApplies.join(", ")||"-",lastUpdated:e.LastUpdated})}),a},render:function(){var r=this,e=this.props,t=e.muiTheme,a=e.accessByName,o=AdminComponents.AdminStyles(t.palette),i=this.state,n=i.searchRoleString,l=i.showTechnical,s=a("Create"),u=null,c=[];s&&(c.push(p.default.createElement(f.FlatButton,d({},o.props.header.flatButton,{primary:!0,label:this.context.getMessage("user.6"),onClick:this.createRoleAction.bind(this)}))),u=this.openTableRows.bind(this)),c.push(p.default.createElement(f.IconMenu,{iconButtonElement:p.default.createElement(f.IconButton,d({iconClassName:"mdi mdi-filter-variant"},o.props.header.iconButton)),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onChange:function(){r.setState({showTechnical:!l},function(){r.load()})}},p.default.createElement(f.MenuItem,{primaryText:this.context.getMessage("dashboard.technical.show","role_editor"),value:"show",rightIcon:l?p.default.createElement(f.FontIcon,{className:"mdi mdi-check"}):null}),p.default.createElement(f.MenuItem,{primaryText:this.context.getMessage("dashboard.technical.hide","role_editor"),value:"hide",rightIcon:l?null:p.default.createElement(f.FontIcon,{className:"mdi mdi-check"})})));e=p.default.createElement("div",{style:{display:"flex"}},p.default.createElement("div",{style:{flex:1}}),p.default.createElement("div",{style:{width:190}},p.default.createElement(y,{fullWidth:!0,hintText:this.context.getMessage("47","role_editor")+"...",value:n||"",onChange:function(e,t){return r.setState({searchRoleString:t})}}))),t=[{name:"roleLabel",label:this.context.getMessage("32","role_editor"),style:{width:"35%",fontSize:15},headerStyle:{width:"35%"},sorter:{type:"string",default:!0}},{name:"lastUpdated",useMoment:!0,label:this.context.getMessage("last_update","role_editor"),hideSmall:!0,sorter:{type:"number"}},{name:"isDefault",label:this.context.getMessage("114","settings"),style:{width:"20%"},headerStyle:{width:"20%"},hideSmall:!0,sorter:{type:"string"}}],i=[];s&&(i.push({iconClassName:"mdi mdi-pencil",tooltip:"Edit",onClick:function(e){r.openRoleEditor(e.role)},disable:function(e){return!e.role.PoliciesContextEditable}}),i.push({iconClassName:"mdi mdi-delete",tooltip:"Delete",onClick:function(e){r.deleteAction(e.role.Uuid,e.role.Label)},disable:function(e){return!e.role.PoliciesContextEditable}}));a=this.computeTableData(n),o=AdminComponents.AdminStyles().body,s=o.tableMaster,n=o.block.props,o=o.block.container;return p.default.createElement("div",{className:"main-layout-nav-to-stack vertical-layout"},p.default.createElement(AdminComponents.Header,{title:this.context.getMessage("69","settings"),icon:"mdi mdi-account-multiple",actions:c,centerContent:e,reloadAction:function(){r.load()},loading:this.state.loading}),p.default.createElement("div",{className:"layout-fill"},p.default.createElement(AdminComponents.SubHeader,{legend:this.context.getMessage("dashboard.description","role_editor")}),p.default.createElement(f.Paper,d({},n,{style:o}),p.default.createElement(m,{data:a,columns:t,actions:i,onSelectRows:u,deselectOnClickAway:!0,showCheckboxes:!1,masterStyles:s,paginate:[10,25,50,100],storageKey:"console.roles.list"}))))}});r.default=o=e()(o),r.default=o,t.exports=r.default},{"../editor/Editor":12,"../editor/util/ClassLoader":44,"create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},o=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var n=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var s=l(e("prop-types")),u=l(e("pydio")),c=l(e("react")),d=(e("material-ui"),l(e("lodash.debounce"))),p=l(e("pydio/http/api")),f=l(e("pydio/model/data-model")),m=l(e("pydio/model/node")),y=l(e("pydio/util/lang")),h=u.default.requireLib("hoc").ModernTextField,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(g,c["default"].Component),o(g,[{key:"displayResultsState",value:function(){this.setState({displayResult:!0})}},{key:"hideResultsState",value:function(){this.setState({displayResult:!1}),this.props.hideResults()}},{key:"triggerSearch",value:function(){var r=this,a=this.state.crtValue;if(a){var o=this.state.dataModel,e=this.props.limit||100;o.getRootNode().setChildren([]);var t=p.default.getRestClient().getIdmApi().listGroups("/",a,!0,0,e),e=p.default.getRestClient().getIdmApi().listUsers("/",a,!0,0,e);Promise.all([t,e]).then(function(e){var t=e[0],e=e[1];t.Groups.map(function(e){var t=e.Attributes&&e.Attributes.displayName?e.Attributes.displayName:e.GroupLabel,t=new m.default("/idm/users"+y.default.trimRight(e.GroupPath,"/")+"/"+e.GroupLabel,!1,t);t.getMetadata().set("IdmUser",e),t.getMetadata().set("ajxp_mime","group"),o.getRootNode().addChild(t)}),e.Users.map(function(e){var t=e.Attributes&&e.Attributes.displayName?e.Attributes.displayName:e.Login,t=new m.default("/idm/users"+e.Login,!0,t);t.getMetadata().set("IdmUser",e),t.getMetadata().set("ajxp_mime","user_editable"),o.getRootNode().addChild(t)}),o.getRootNode().setLoaded(!0),r.displayResultsState(),r.props.displayResults(a,o)})}else{this.hideResultsState();try{this.refs.query.refs.input.blur()}catch(e){}}}},{key:"keyDown",value:function(e){"Enter"===e.key?(e.preventDefault(),this.triggerSearch()):this.searchDebounced()}},{key:"render",value:function(){var r=this,e=this.state.crtValue;return c.default.createElement("div",{className:this.props.className||"",style:a({display:"flex",alignItems:"center"},this.props.style)},c.default.createElement("div",{style:{flex:1}}),c.default.createElement("div",{style:{maxWidth:190}},c.default.createElement("form",{autoComplete:"off"},c.default.createElement(h,{ref:"query",onKeyDown:this.keyDown.bind(this),hintText:this.props.textLabel,fullWidth:!0,value:e,onChange:function(e,t){r.setState({crtValue:t})}}))))}}]),g);function g(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),n(Object.getPrototypeOf(g.prototype),"constructor",this).call(this,e);var t=new f.default;t.setRootNode(new m.default),this.state={dataModel:t,displayResult:e.displayResultsState,crtValue:""},this.searchDebounced=(0,d.default)(this.triggerSearch,350)}o.PropTypes={textLabel:s.default.string,displayResults:s.default.func,hideResults:s.default.func,displayResultsState:s.default.bool,limit:s.default.number,style:s.default.object},r.default=o,t.exports=r.default},{"lodash.debounce":"lodash.debounce","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node","pydio/util/lang":"pydio/util/lang",react:"react"}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("pydio/util/lang")),u=e("cells-sdk"),c=n(e("./WorkspaceAcl")),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),a(d,[{key:"render",value:function(){var t=this.props.role,e=this.state.workspaces;return t?l.default.createElement("div",{className:"material-list"},e.map(function(e){return l.default.createElement(c.default,{workspace:e,role:t})})):l.default.createElement("div",null)}}]),d);function d(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,t);function e(e){return t.pydio.MessageHash["pydio_role."+e]||e}var r=[],a=new u.IdmWorkspace;a.UUID="homepage",a.Label=e("workspace.statics.home.title"),a.Description=e("workspace.statics.home.description"),a.Slug="homepage",a.RootNodes={"homepage-ROOT":u.TreeNode.constructFromObject({Uuid:"homepage-ROOT"})},r.push(a),t.showSettings&&((a=new u.IdmWorkspace).UUID="settings",a.Label=e("workspace.statics.settings.title"),a.Description=e("workspace.statics.settings.description"),a.Slug="settings",a.RootNodes={"settings-ROOT":u.TreeNode.constructFromObject({Uuid:"settings-ROOT"})},r.push(a)),r.sort(s.default.arraySorter("Label",!1,!0)),this.state={workspaces:r}}r.default=a,t.exports=r.default},{"./WorkspaceAcl":9,"cells-sdk":"cells-sdk","pydio/util/lang":"pydio/util/lang",react:"react"}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};var n,l=e("react"),s=(n=l)&&n.__esModule?n:{default:n},u=e("material-ui"),e=e("../util/MessagesMixin"),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s["default"].Component),a(c,[{key:"componentWillReceiveProps",value:function(e){this.setState({acl:e.acl})}},{key:"getAcl",value:function(){return this.state.acl}},{key:"updateAcl",value:function(){var e,t,r,a,o;this.props.disabled||(t=!(e=this.refs.deny.isChecked())&&this.refs.read.isChecked(),r=!e&&this.refs.write.isChecked(),a=void 0,o=[],e?o.push("deny"):(t&&o.push("read"),r&&o.push("write")),a=o.join(","),this.props.onChange&&this.props.onChange(a,this.props.acl),this.setState({acl:a}))}},{key:"handleChangePolicy",value:function(e,t){t="policy:"+t;this.props.onChange?this.props.onChange(t,this.props.acl):this.setState({acl:t})}},{key:"render",value:function(){var e=this.props,t=e.hideDeny,r=e.hideLabels,a=e.disabled,o=e.getMessage,i=this.state.acl||"";if(i.startsWith("policy:"))return s.default.createElement("div",{style:{display:"flex",alignItems:"center",width:132,height:40}},"Custom policy");e={width:44};return s.default.createElement("div",{style:{display:"flex",alignItems:"center",width:132,height:40}},s.default.createElement(u.Checkbox,{ref:"read",label:r?"":o("react.5a","ajxp_admin"),value:"read",onCheck:this.updateAcl.bind(this),disabled:a||-1<i.indexOf("deny"),checked:-1===i.indexOf("deny")&&-1!==i.indexOf("read"),style:e}),s.default.createElement(u.Checkbox,{ref:"write",label:r?"":o("react.5b","ajxp_admin"),value:"write",onCheck:this.updateAcl.bind(this),disabled:a||-1<i.indexOf("deny"),checked:-1===i.indexOf("deny")&&-1!==i.indexOf("write"),style:e}),!t&&s.default.createElement(u.Checkbox,{ref:"deny",label:r?"":o("react.5","ajxp_admin"),value:"-",disabled:a,onCheck:this.updateAcl.bind(this),checked:-1!==i.indexOf("deny"),style:e}))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,e),this.state={acl:e.acl}}r.default=(0,e.withRoleMessages)(a),t.exports=r.default},{"../util/MessagesMixin":45,"material-ui":"material-ui",react:"react"}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};var n,l=e("react"),s=(n=l)&&n.__esModule?n:{default:n},e=e("../util/MessagesMixin"),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,s["default"].Component),a(u,[{key:"render",value:function(){var e=this.props.getMessage,t=void 0;switch(this.props.acl){case"read,write":t=e("8");break;case"read":t=e("9");break;case"write":t=e("10");break;case"PYDIO_VALUE_CLEAR":t=e("11");break;default:t=e("12")}return s.default.createElement("span",{className:"summary-rights summary"},t)}}]),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,arguments)}r.default=(0,e.withRoleMessages)(a),t.exports=r.default},{"../util/MessagesMixin":45,react:"react"}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=e("../util/MessagesMixin"),u=n(e("./RightsSelector")),a=(e("cells-sdk"),e("material-ui"),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l["default"].Component),a(c,[{key:"onAclChange",value:function(e,t){var r=this.props,a=r.role,r=r.workspace;a.updateAcl(r,null,e)}},{key:"render",value:function(){var e=this.props,t=e.workspace,r=e.role,a=e.getPydioRoleMessage;if(!t.RootNodes||!Object.keys(t.RootNodes).length)return l.default.createElement(PydioComponents.ListEntry,{className:"workspace-acl-entry",firstLine:l.default.createElement("span",{style:{textDecoration:"line-through",color:"#ef9a9a"}},t.Label+" ("+a("workspace.roots.invalid")+")")});e=r.getAclString(t),r=e.aclString,e=e.inherited,r=l.default.createElement(u.default,{acl:r,onChange:this.onAclChange.bind(this),hideLabels:!0}),a=t.Label+(e?" ("+a("38")+")":"");return l.default.createElement(PydioComponents.ListEntry,{className:(e?"workspace-acl-entry-inherited ":"")+"workspace-acl-entry",firstLine:a,actions:r})}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i(Object.getPrototypeOf(c.prototype),"constructor",this).apply(this,arguments)}r.default=(0,s.withRoleMessages)(a),t.exports=r.default},{"../util/MessagesMixin":45,"./RightsSelector":7,"cells-sdk":"cells-sdk","material-ui":"material-ui",react:"react"}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("pydio/http/api")),u=n(e("pydio/util/lang")),c=e("cells-sdk"),d=n(e("./WorkspaceAcl")),p=n(e("pydio")),f=p.default.requireLib("components").MaterialTable,a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,l["default"].Component),a(m,[{key:"render",value:function(){var e=this.props,t=e.role,r=e.advancedAcl,a=this.state,o=a.workspaces,e=a.loading;if(!t)return l.default.createElement("div",null);a=[{name:"acl",label:"",style:{paddingLeft:0,paddingRight:0},renderCell:function(e){return l.default.createElement(d.default,{workspace:e,role:t,advancedAcl:r})}}];return l.default.createElement("div",{className:"material-list"},l.default.createElement(f,{data:o,columns:a,hideHeaders:!0,paginate:[10,25,50,100],defaultPageSize:25,showCheckboxes:!1,emptyStateString:e?p.default.getInstance().MessageHash["ajxp_admin.loading"]:""}))}}]),m);function m(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),i(Object.getPrototypeOf(m.prototype),"constructor",this).call(this,e),this.state={loading:!0,workspaces:[]};var r=new c.WorkspaceServiceApi(s.default.getRestClient()),e=new c.RestSearchWorkspaceRequest;e.Queries=[c.IdmWorkspaceSingleQuery.constructFromObject({scope:"ADMIN"})],r.searchWorkspaces(e).then(function(e){e=e.Workspaces||[];e.sort(u.default.arraySorter("Label",!1,!0)),t.setState({workspaces:e,loading:!1})}).catch(function(e){t.setState({loading:!1})})}r.default=a,t.exports=r.default},{"./WorkspaceAcl":9,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang",react:"react"}],11:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=a(e("./PagesAcls")),i=a(e("./RightsSelector")),n=a(e("./RightsSummary")),l=a(e("./WorkspaceAcl")),e=a(e("./WorkspacesAcls")),l={PagesAcls:o.default,RightsSelector:i.default,RightsSummary:n.default,WorkspacesAcls:e.default,WorkspaceAcl:l.default};r.default=l,t.exports=r.default},{"./PagesAcls":6,"./RightsSelector":7,"./RightsSummary":8,"./WorkspaceAcl":9,"./WorkspacesAcls":10}],12:[function(p,f,m){!function(t){"use strict";Object.defineProperty(m,"__esModule",{value:!0});var e=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var i=r(p("prop-types")),n=r(p("pydio")),l=r(p("./model/Role")),s=r(p("./model/User")),h=r(p("./acl/WorkspacesAcls")),g=r(p("./acl/PagesAcls")),v=r(p("react")),u=r(p("pydio/util/path")),b=p("material-ui"),P=r(p("./info/RoleInfo")),O=r(p("./info/UserInfo")),E=r(p("./info/GroupInfo")),M=r(p("./params/ParametersPanel")),c=n.default.requireLib("components"),R=c.PaperEditorLayout,k=c.PaperEditorNavEntry,w=c.PaperEditorNavHeader,e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,v["default"].Component),e(d,[{key:"componentWillReceiveProps",value:function(e){var t=this,r=this.props,a=r.node,r=r.idmRole;e.node===a&&e.idmRole===r||(e.node?this.setState(this.nodeToState(e.node)):e.idmRole&&this.setState({idmRole:e.idmRole,roleType:"role",currentPane:"info"},function(){t.loadRoleData(!0)}))}},{key:"nodeToState",value:function(e){var t=this,r="group"===e.getAjxpMime()?"group":"user",a=void 0,o=e.getMetadata().get("IdmUser");return(a=new s.default(o)).observe("update",function(){t.forceUpdate()}),a.load(),{observableUser:a,roleLabel:u.default.getBasename(e.getPath()),roleType:r,dirty:!1,currentPane:"info",localModalContent:{}}}},{key:"loadRoleData",value:function(e){var t=this;e&&this.setState({loadingMessage:this.getMessage("loading","ajxp_admin")});var e=this.state.idmRole,r=new l.default(e);r.load().then(function(){t.setState({loadingMessage:null,observableRole:r}),r.observe("update",function(){t.forceUpdate()})})}},{key:"getChildContext",value:function(){var r=this.context.pydio.MessageHash;return{messages:r,getMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r[t+(t?".":"")+e]||e},getPydioRoleMessage:function(e){return r["role_editor."+e]||e},getRootMessage:function(e){return r[e]||e}}}},{key:"getMessage",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return this.getChildContext().getMessage(e,t)}},{key:"getPydioRoleMessage",value:function(e){return this.getChildContext().getMessage(e,"role_editor")}},{key:"getRootMessage",value:function(e){return this.getChildContext().getMessage(e,"")}},{key:"setSelectedPane",value:function(e){this.setState({currentPane:e})}},{key:"componentDidMount",value:function(){var e=this;this.loadRoleData(!0),this.props.registerCloseCallback&&this.props.registerCloseCallback(function(){if(e.state&&e.state.dirty&&!t.confirm(e.getPydioRoleMessage("19")))return!1})}},{key:"showModal",value:function(e){this.setState({modal:e})}},{key:"hideModal",value:function(){this.setState({modal:null})}},{key:"logAction",value:function(e){this.setState({snackbar:e,snackOpen:!0})}},{key:"hideSnackBar",value:function(){this.setState({snackOpen:!1})}},{key:"render",value:function(){var e=this,t=this.props,r=t.advancedAcl,a=t.pydio,o=this.state,i=o.observableRole,n=o.observableUser,l=o.pluginsRegistry,s=o.currentPane,u=o.modal,c="",d="",p=this.getMessage("24"),f=void 0,m=!1;"user"===this.state.roleType?(c=(y=n.getIdmUser()).Attributes&&y.Attributes.displayName?y.Attributes.displayName:y.Login,m="admin"===y.Attributes.profile,f=v.default.createElement(O.default,{user:n,pydio:a,pluginsRegistry:l})):"group"===this.state.roleType?(d=this.getMessage("26"),p=this.getMessage("27"),c=n.getIdmUser().GroupLabel,n.getIdmUser().Attributes&&n.getIdmUser().Attributes.displayName&&(c=n.getIdmUser().Attributes.displayName),f=v.default.createElement(E.default,{group:n,pydio:a,pluginsRegistry:l})):"role"===this.state.roleType&&(c=i?i.getIdmRole().Label:"...",d=this.getMessage("28"),p=this.getMessage("29"),m=!0,f=v.default.createElement(P.default,{role:i,pydio:a,pluginsRegistry:l}));var t=!0,o=function(){},y=function(){};n?(t=!n.isDirty(),o=function(){n.save().then(e.props.afterSave)},y=function(){n.revert()}):i&&(t=!i.isDirty(),o=function(){i.save(e.props.afterSave)},y=function(){i.revert()});l=[R.actionButton(this.getMessage("plugins.6","ajxp_admin"),"mdi mdi-undo",y,t),R.actionButton(this.getRootMessage("53"),"mdi mdi-content-save",o,t)],y=[v.default.createElement(w,{key:"1",label:this.getMessage("ws.28","ajxp_admin")}),v.default.createElement(k,{key:"info",keyName:"info",onClick:this.setSelectedPane.bind(this),label:p,selectedKey:s}),v.default.createElement(w,{key:"2",label:this.getMessage("34")}),v.default.createElement(k,{key:"workspaces",keyName:"workspaces",onClick:this.setSelectedPane.bind(this),label:this.getMessage("35"),selectedKey:s}),v.default.createElement(k,{key:"pages",keyName:"pages",onClick:this.setSelectedPane.bind(this),label:this.getMessage("36"),selectedKey:s}),v.default.createElement(w,{key:"3",label:this.getMessage("37")}),v.default.createElement(k,{key:"params",keyName:"params",onClick:this.setSelectedPane.bind(this),label:this.getMessage("38"),selectedKey:s})],o=[],t=function(e){return s===e?"layout-fill":""},p=function(e){return s===e?{overflow:"auto"}:{height:0,overflow:"hidden"}};o.push(v.default.createElement("div",{key:"info",className:"avatar-provider "+t("info"),style:p("info")},d&&!this.state.loadingMessage?v.default.createElement("h3",{className:"paper-right-title"},d):null,f)),"workspaces"===s?o.push(v.default.createElement("div",{key:"workspaces",className:t("workspaces"),style:p("workspaces")},v.default.createElement("h3",{className:"paper-right-title"},this.getRootMessage("250"),v.default.createElement("div",{className:"section-legend"},this.getMessage("43")),v.default.createElement("div",{className:"read-write-header"},v.default.createElement("span",{className:"header-read"},this.getMessage("react.5a","ajxp_admin")),v.default.createElement("span",{className:"header-write"},this.getMessage("react.5b","ajxp_admin")),v.default.createElement("span",{className:"header-deny"},this.getMessage("react.5","ajxp_admin"))),v.default.createElement("br",null)),v.default.createElement(h.default,{key:"workspaces-list",role:n?n.getRole():i,roleType:this.state.roleType,advancedAcl:r,showModal:this.showModal.bind(this),hideModal:this.hideModal.bind(this)}))):"pages"===s?o.push(v.default.createElement("div",{key:"pages",className:t("pages"),style:p("pages")},v.default.createElement("h3",{className:"paper-right-title"},this.getMessage("44"),v.default.createElement("div",{className:"section-legend"},this.getMessage("45")),v.default.createElement("div",{className:"read-write-header"},v.default.createElement("span",{className:"header-read"},this.getMessage("react.5a","ajxp_admin")),v.default.createElement("span",{className:"header-write"},this.getMessage("react.5b","ajxp_admin")),v.default.createElement("span",{className:"header-deny"},this.getMessage("react.5","ajxp_admin"))),v.default.createElement("br",null)),v.default.createElement(g.default,{key:"pages-list",role:n?n.getRole():i,roleType:this.state.roleType,advancedAcl:r,showModal:this.showModal.bind(this),hideModal:this.hideModal.bind(this),showSettings:m,pydio:a}))):"params"===s&&o.push(v.default.createElement("div",{key:"params",className:t("params"),style:p("params")},v.default.createElement(M.default,{pydio:a,role:n?n.getRole():i,roleType:this.state.roleType})));a=null;return this.state.loadingMessage&&(a=v.default.createElement("div",{className:"loader-container layout-fill vertical-layout"},v.default.createElement("div",{className:"loader-message",style:{margin:"auto",color:"rgba(0,0,0,0.33)",fontWeight:"500",fontSize:16}},this.state.loadingMessage))),v.default.createElement(R,{title:c,titleActionBar:l,closeAction:function(){e.props.onRequestTabClose()},contentFill:!0,leftNav:y,className:"edit-object-"+this.state.roleType},v.default.createElement(b.Snackbar,{message:this.state.snackbar||"",open:this.state.snackOpen,autoHideDuration:4e3,ref:"snack",action:"Dismiss",onRequestClose:this.hideSnackBar.bind(this)}),u,a,o)}}]),d);function d(e,t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),o(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,e,t),e.node?this.state=this.nodeToState(e.node):e.idmRole&&(this.state={idmRole:e.idmRole,roleType:"role",currentPane:"info"},this.loadRoleData(!0)),AdminComponents.PluginsLoader.getInstance(this.props.pydio).loadPlugins().then(function(e){r.setState({pluginsRegistry:e})})}e.contextTypes={pydio:i.default.instanceOf(n.default)},e.childContextTypes={messages:i.default.object,getMessage:i.default.func,getPydioRoleMessage:i.default.func,getRootMessage:i.default.func},e.propTypes={node:i.default.instanceOf(AjxpNode),closeEditor:i.default.func,registerCloseCallback:i.default.func},m.default=e,f.exports=m.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./acl/PagesAcls":32,"./acl/WorkspacesAcls":35,"./info/GroupInfo":36,"./info/RoleInfo":37,"./info/UserInfo":38,"./model/Role":39,"./model/User":40,"./params/ParametersPanel":42,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/util/path":"pydio/util/path",react:"react"}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("prop-types")),u=n(e("pydio")),e=n(e("../model/User")),c=u.default.requireLib("form").FormPanel,a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),a(d,[{key:"getPydioRoleMessage",value:function(e){return this.props.pydio.MessageHash["role_editor."+e]||e}},{key:"onParameterChange",value:function(t,e,r){var a=this.props.group,o=this.state.parameters.filter(function(e){return e.name===t}),i=a.getIdmUser(),a=a.getRole();"displayName"===t||"email"===t||"profile"===t?i.Attributes[t]=e:o.length&&o[0].aclKey&&a.setParameter(o[0].aclKey,e)}},{key:"render",value:function(){var e=this.props,t=e.group,r=(e.pydio,this.state.parameters);if(!r)return l.default.createElement("div",null,"Loading...");var a,o={};t&&(e=t.getIdmUser(),a=t.getRole(),t=e.GroupLabel,e.Attributes&&e.Attributes.displayName&&(t=e.Attributes.displayName),o={groupPath:LangUtils.trimRight(e.GroupPath,"/")+"/"+e.GroupLabel,displayName:t},r.map(function(e){e.aclKey&&a.getParameterValue(e.aclKey)&&(o[e.name]=a.getParameterValue(e.aclKey))}));r=[{name:"groupPath",label:this.getPydioRoleMessage("34"),type:"string",readonly:!0},{name:"displayName",label:this.getPydioRoleMessage("35"),type:"string"}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r));return l.default.createElement("div",null,l.default.createElement(c,{parameters:r,onParameterChange:this.onParameterChange.bind(this),values:o,depth:-2}))}}]),d);function d(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,e),this.state={parameters:[]},AdminComponents.PluginsLoader.getInstance(e.pydio).formParameters('//global_param[contains(@scope,"group")]|//param[contains(@scope,"group")]').then(function(e){t.setState({parameters:e})})}a.PropTypes={pydio:s.default.instanceOf(u.default).isRequired,pluginsRegistry:s.default.instanceOf(XMLDocument),group:s.default.instanceOf(e.default)},r.default=a,t.exports=r.default},{"../model/User":40,"prop-types":"prop-types",pydio:"pydio",react:"react"}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("prop-types")),u=n(e("pydio")),e=n(e("../model/Role")),c=u.default.requireLib("form").FormPanel,a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),a(d,[{key:"getPydioRoleMessage",value:function(e){return this.props.pydio.MessageHash["role_editor."+e]||e}},{key:"onParameterChange",value:function(e,t,r){var a=this.props.role,o=a.getIdmRole();"applies"===e?o.AutoApplies=t.split(","):"roleLabel"===e?o.Label=t:"roleForceOverride"===e?o.ForceOverride=t:(e=this.getParameterByName(e)).aclKey&&a.setParameter(e.aclKey,t)}},{key:"getParameterByName",value:function(t){return this.state.parameters.filter(function(e){return e.name===t})[0]}},{key:"render",value:function(){var t=this.props.role,e=this.state.parameters;if(!e)return l.default.createElement("div",null,"Loading...");var r,a,o=[{name:"roleId",label:this.getPydioRoleMessage("31"),type:"string",readonly:!0,description:this.getPydioRoleMessage("role.id.description")},{name:"roleLabel",label:this.getPydioRoleMessage("32"),type:"string",description:this.getPydioRoleMessage("role.label.description")},{name:"applies",label:this.getPydioRoleMessage("33"),type:"select",multiple:!0,choices:"admin|Administrators,standard|Standard,shared|Shared Users,anon|Anonymous",description:this.getPydioRoleMessage("role.autoapply.description")},{name:"roleForceOverride",label:"Always Override",type:"boolean",description:this.getPydioRoleMessage("role.override.description")}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e)),i={applies:[]};return t&&(a=(r=t.getIdmRole()).AutoApplies||[],i={roleId:r.Uuid,applies:a.filter(function(e){return!!e}),roleLabel:r.Label,roleForceOverride:r.ForceOverride||!1},e.map(function(e){e.aclKey&&t.getParameterValue(e.aclKey)&&(i[e.name]=t.getParameterValue(e.aclKey))})),l.default.createElement(c,{parameters:o,onParameterChange:this.onParameterChange.bind(this),values:i,depth:-2})}}]),d);function d(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,e),this.state={parameters:[]},AdminComponents.PluginsLoader.getInstance(e.pydio).formParameters("//global_param[contains(@scope,'role')]|//param[contains(@scope,'role')]").then(function(e){t.setState({parameters:e})})}a.PropTypes={pydio:s.default.instanceOf(u.default).isRequired,pluginsRegistry:s.default.instanceOf(XMLDocument),role:s.default.instanceOf(e.default)},r.default=a,t.exports=r.default},{"../model/Role":39,"prop-types":"prop-types",pydio:"pydio",react:"react"}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var c=n(e("react")),l=n(e("prop-types")),s=n(e("pydio")),d=n(e("../model/User")),p=e("material-ui"),f=n(e("../user/UserRolesPicker")),m=s.default.requireLib("form").FormPanel,a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(y,c["default"].Component),a(y,[{key:"getBinaryContext",value:function(){var e=this.props.user;return"user_id="+e.getIdmUser().Login+(e.getIdmUser().Attributes&&e.getIdmUser().Attributes.avatar?"?"+e.getIdmUser().Attributes.avatar:"")}},{key:"getPydioRoleMessage",value:function(e){return this.props.pydio.MessageHash["role_editor."+e]||e}},{key:"onParameterChange",value:function(t,e,r){var a=this.props.user,o=this.state.parameters.filter(function(e){return e.name===t}),i=a.getIdmUser(),a=a.getRole();"displayName"===t||"email"===t||"profile"===t||"avatar"===t?i.Attributes[t]=e:o.length&&o[0].aclKey&&a.setParameter(o[0].aclKey,e)}},{key:"buttonCallback",value:function(e){var t,r,a,o,i=this.props.user;"update_user_pwd"===e?this.props.pydio.UI.openComponentInModal("AdminPeople","Editor.User.UserPasswordDialog",{user:i}):(r=i.getIdmUser(),a="user_set_lock-lock"===e?"logout":"pass_change",o=[],!r.Attributes.locks||(t=JSON.parse(r.Attributes.locks))&&"object"==typeof t&&(o=t),-1<o.indexOf(a)?(o=o.filter(function(e){return e!==a}),"user_set_lock-lock"===e&&delete r.Attributes.failedConnections):o.push(a),r.Attributes.locks=JSON.stringify(o),i.save())}},{key:"render",value:function(){var e=this,t=this.props,o=t.user,r=t.pydio,i=this.state.parameters;if(!i)return c.default.createElement("div",null,"Loading...");var n={profiles:[]},l=[],s=void 0;o&&function(){var t,e=o.getIdmUser(),r=o.getRole();e.Attributes.locks&&"object"==typeof(l=JSON.parse(e.Attributes.locks)||[])&&void 0===l.length&&(t=[],Object.keys(l).forEach(function(e){!0===l[e]&&t.push(e)}),l=t),s=c.default.createElement(f.default,{profile:e.Attributes?e.Attributes.profile:"",roles:e.Roles,addRole:function(e){return o.addRole(e)},removeRole:function(e){return o.removeRole(e)},switchRoles:function(e,t){return o.switchRoles(e,t)}});var a=e.Attributes||{};n=u({},n,{avatar:a.avatar,displayName:a.displayName,email:a.email,profile:a.profile,login:e.Login}),i.map(function(e){e.aclKey&&r.getParameterValue(e.aclKey)&&(n[e.name]=r.getParameterValue(e.aclKey))})}();t=[{name:"login",label:this.getPydioRoleMessage("21"),description:r.MessageHash["pydio_role.31"],type:"string",readonly:!0},{name:"profile",label:this.getPydioRoleMessage("22"),description:r.MessageHash["pydio_role.32"],type:"select",choices:"admin|Administrator,standard|Standard,shared|Shared"}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(i));return c.default.createElement("div",null,c.default.createElement("h3",{className:"paper-right-title",style:{display:"flex",alignItems:"center"}},c.default.createElement("div",{style:{flex:1}},r.MessageHash["pydio_role.24"],c.default.createElement("div",{className:"section-legend"},r.MessageHash["pydio_role.54"])),c.default.createElement(p.IconMenu,{iconButtonElement:c.default.createElement(p.IconButton,{iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},tooltip:"Actions"},c.default.createElement(p.MenuItem,{primaryText:this.getPydioRoleMessage("25"),onClick:function(){return e.buttonCallback("update_user_pwd")}}),c.default.createElement(p.MenuItem,{primaryText:this.getPydioRoleMessage(-1<l.indexOf("logout")?"27":"26"),onClick:function(){return e.buttonCallback("user_set_lock-lock")}}),c.default.createElement(p.MenuItem,{primaryText:this.getPydioRoleMessage(-1<l.indexOf("pass_change")?"28b":"28"),onClick:function(){return e.buttonCallback("user_set_lock-pass_change")}}))),c.default.createElement(m,{parameters:t,onParameterChange:this.onParameterChange.bind(this),values:n,depth:-2,binary_context:this.getBinaryContext()}),s)}}]),y);function y(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),i(Object.getPrototypeOf(y.prototype),"constructor",this).call(this,e),this.state={parameters:[]},AdminComponents.PluginsLoader.getInstance(e.pydio).formParameters('//global_param[contains(@scope,"user")]|//param[contains(@scope,"user")]').then(function(e){t.setState({parameters:e})})}a.PropTypes={pydio:l.default.instanceOf(s.default).isRequired,pluginsRegistry:l.default.instanceOf(XMLDocument),user:l.default.instanceOf(d.default)},r.default=a,t.exports=r.default},{"../model/User":40,"../user/UserRolesPicker":43,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],16:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=a(e("./GroupInfo")),i=a(e("./RoleInfo")),e=a(e("./UserInfo")),e={GroupInfo:o.default,RoleInfo:i.default,UserInfo:e.default};r.default=e,t.exports=r.default},{"./GroupInfo":13,"./RoleInfo":14,"./UserInfo":15}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}function l(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=n(e("pydio/lang/observable")),u=n(e("pydio/http/api")),c=e("cells-sdk"),d=e("uuid"),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,s["default"]),a(p,[{key:"load",value:function(){return this.loadAcls()}},{key:"isDirty",value:function(){return this.dirty}},{key:"getIdmRole",value:function(){return this.buildProxy(this.idmRole)}},{key:"makeSnapshot",value:function(){var t=this;this.snapshot=c.IdmRole.constructFromObject(JSON.parse(JSON.stringify(this.idmRole))),this.aclSnapshot=[],this.acls.forEach(function(e){t.aclSnapshot.push(c.IdmACL.constructFromObject(JSON.parse(JSON.stringify(e))))})}},{key:"updateParentRoles",value:function(e){var t=this;this.parentRoles=e,this.loadAcls(!0).then(function(){t.notify("update")})}},{key:"loadAcls",value:function(){var e,a=this,t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],r=new c.ACLServiceApi(u.default.getRestClient()),o=new c.RestSearchACLRequest;o.Queries=[];var i=new c.IdmACLSingleQuery;return i.RoleIDs=[],t||(i.RoleIDs=[this.idmRole.Uuid]),(e=i.RoleIDs).push.apply(e,l(this.parentRoles.map(function(e){return e.Uuid}))),o.Queries.push(i),r.searchAcls(o).then(function(e){var r=p.FormatPolicyAclFromStore(e.ACLs||[]);a.parentRoles.length?(t||(a.acls=r.filter(function(e){return e.RoleID===a.idmRole.Uuid})),a.parentRoles.forEach(function(t){a.parentAcls[t.Uuid]=r.filter(function(e){return e.RoleID===t.Uuid})})):a.acls=r,t||a.makeSnapshot()})}},{key:"revert",value:function(){this.idmRole=this.snapshot,this.acls=this.aclSnapshot,this.dirty=!1,this.makeSnapshot(),this.notify("update")}},{key:"save",value:function(){var r=this,e=new c.RoleServiceApi(u.default.getRestClient()),a=new c.ACLServiceApi(u.default.getRestClient());return e.setRole(this.idmRole.Uuid,this.idmRole).then(function(e){r.idmRole=e;var t=new c.RestSearchACLRequest;t.Queries=[];e=new c.IdmACLSingleQuery;return e.RoleIDs=[r.idmRole.Uuid],t.Queries.push(e),a.searchAcls(t).then(function(e){var t=[];return e.ACLs&&e.ACLs.forEach(function(e){t.push(a.deleteAcl(e))}),Promise.all(t).then(function(e){var t=[];return p.FormatPolicyAclToStore(r.acls).forEach(function(e){t.push(a.putAcl(e))}),Promise.all(t).then(function(e){var t=[];e.forEach(function(e){t.push(e)}),r.acls=p.FormatPolicyAclFromStore(t),r.makeSnapshot(),r.dirty=!1,r.notify("update")})})})})}},{key:"setParameter",value:function(t,e){var r,a,o=this,i=arguments.length<=2||void 0===arguments[2]?"PYDIO_REPO_SCOPE_ALL":arguments[2],n=this.acls.filter(function(e){return e.Action.Name===t&&e.WorkspaceID===i});n.length?(r=n[0],a=void 0,o.parentRoles.forEach(function(e){a=o.getAclValue(o.parentAcls[e.Uuid],t,i,a)}),void 0!==a&&a===e?o.acls=o.acls.filter(function(e){return e!==r}):r.Action.Value=JSON.stringify(e)):((n=new c.IdmACL).RoleID=this.idmRole.Uuid,n.WorkspaceID=i,n.Action=new c.IdmACLAction,n.Action.Name=t,n.Action.Value=JSON.stringify(e),this.acls.push(n)),this.dirty=!0,this.notify("update")}},{key:"deleteParameter",value:function(t){this.acls=this.acls.filter(function(e){return e!==t}),this.dirty=!0,this.notify("update")}},{key:"getParameterValue",value:function(t){var r=this,a=arguments.length<=1||void 0===arguments[1]?"PYDIO_REPO_SCOPE_ALL":arguments[1],o=void 0;return this.parentRoles.forEach(function(e){o=r.getAclValue(r.parentAcls[e.Uuid],t,a,o)}),this.getAclValue(this.acls,t,a,o)}},{key:"listParametersAndActions",value:function(){function t(e){return e.Action.Name&&(0===e.Action.Name.indexOf("parameter:")||0===e.Action.Name.indexOf("action:"))}var r=this,a=(a=this.acls||[]).filter(t);return this.parentRoles.forEach(function(e){e=(e=r.parentAcls[e.Uuid]||[]).filter(t).filter(function(t){return!a.filter(function(e){return e.Action.Name===t.Action.Name}).length}).map(function(e){e=c.IdmACL.constructFromObject(JSON.parse(JSON.stringify(e)));return e.INHERITED=!0,e});a=[].concat(l(a),l(e))}),a}},{key:"getAclValue",value:function(e,t,r,a){if(!e)return a;var o=e.filter(function(e){return e.Action.Name===t&&e.WorkspaceID===r});try{return JSON.parse(o[0].Action.Value)}catch(e){return a}}},{key:"getAclString",value:function(e,t){var r,a=this,o=!1,i=void 0,n=void 0;n=e?(r=(r=e.RootNodes)[Object.keys(r).shift()],i=e.UUID,r.Uuid):t;var l=void 0,s=void 0;this.parentRoles.forEach(function(e){e=a._aclStringForAcls(a.parentAcls[e.Uuid],i,n);void 0!==e&&(s=e)});t=this._aclStringForAcls(this.acls,i,n);if(void 0!==t)l=t;else{if(void 0===s)return{aclString:""};l=s,o=!0}return{aclString:Object.keys(l).filter(function(e){return l[e]}).join(","),inherited:o}}},{key:"_aclStringForAcls",value:function(e,r,a){var o={read:!1,write:!1,deny:!1},t=e.filter(function(e){return e.Action.Name&&0===e.Action.Name.indexOf("policy:")&&(!r||e.WorkspaceID===r)&&e.NodeID===a&&"1"===e.Action.Value});return t.length?(o[t[0].Action.Name]=!0,o):(Object.keys(o).forEach(function(t){e.filter(function(e){return e.Action.Name===t&&(!r||e.WorkspaceID===r)&&e.NodeID===a&&"1"===e.Action.Value}).length&&(o[t]|=!0)}),o.read||o.write||o.deny?o:void 0)}},{key:"updateAcl",value:function(a,t,e){var o=this,i=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],n=[],l=!1;t?(n=[t],l=i&&-1<Object.keys(i.RootNodes).indexOf(t)):n=Object.keys(a.RootNodes),this.acls=a?this.acls.filter(function(e){return!(("read"===e.Action.Name||"write"===e.Action.Name||"deny"===e.Action.Name||e.Action.Name&&0===e.Action.Name.indexOf("policy:"))&&e.WorkspaceID===a.UUID&&-1<n.indexOf(e.NodeID)&&"1"===e.Action.Value)}):this.acls.filter(function(e){return!(("read"===e.Action.Name||"write"===e.Action.Name||"deny"===e.Action.Name||e.Action.Name&&0===e.Action.Name.indexOf("policy:"))&&e.NodeID===t&&"1"===e.Action.Value)}),""!==e&&e.split(",").forEach(function(r){n.forEach(function(e){var t=new c.IdmACL;t.NodeID=e,a?t.WorkspaceID=a.UUID:l&&(t.WorkspaceID=i.UUID),t.RoleID=o.idmRole.Uuid,t.Action=c.IdmACLAction.constructFromObject({Name:r,Value:"1"}),o.acls.push(t)})}),this.dirty=!0,this.notify("update")}},{key:"buildProxy",value:function(e){var a=this;return new Proxy(e,{set:function(e,t,r){return e[t]=r,a.dirty=!0,a.notify("update"),!0},get:function(e,t){t=e[t];return!(t instanceof Array)&&t instanceof Object?a.buildProxy(t):t}})}}],[{key:"FormatPolicyAclFromStore",value:function(e){return e.map(function(e){return e.Action&&"policy"===e.Action.Name&&(e.Action.Name="policy:"+e.Action.Value,e.Action.Value="1"),e})}},{key:"FormatPolicyAclToStore",value:function(e){return e.map(function(e){if(e.Action&&0===e.Action.Name.indexOf("policy:")){var t=c.IdmACL.constructFromObject(JSON.parse(JSON.stringify(e)));return t.Action.Name="policy",t.Action.Value=e.Action.Name.split(":")[1],t}return e})}}]),p);function p(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),i(Object.getPrototypeOf(p.prototype),"constructor",this).call(this),this.acls=[],this.dirty=!1,this.parentRoles=t,this.parentAcls={},e?this.idmRole=e:(this.idmRole=new c.IdmRole,this.idmRole.Uuid=(0,d.v4)()),this.makeSnapshot()}r.default=a,t.exports=r.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable",uuid:52}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var l=n(e("pydio/lang/observable")),u=e("cells-sdk"),c=e("uuid"),d=n(e("./Role")),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,l["default"]),a(p,[{key:"load",value:function(){var e=this;this.role.load().then(function(){e.notify("update")})}},{key:"isDirty",value:function(){return this.dirty}},{key:"save",value:function(){var t=this;return PydioApi.getRestClient().getIdmApi().updateIdmUser(this.idmUser).then(function(e){return t.idmUser=e,t.role.isDirty()?t.role.save().then(function(){t.makeSnapshot(),t.dirty=!1,t.notify("update")}):(t.makeSnapshot(),t.dirty=!1,t.notify("update"),Promise.resolve(t))})}},{key:"revert",value:function(){this.idmUser=this.snapshot,this.makeSnapshot(),this.dirty=!1,this.notify("update"),this.role.revert()}},{key:"makeSnapshot",value:function(){this.snapshot=u.IdmUser.constructFromObject(JSON.parse(JSON.stringify(this.idmUser)))}},{key:"getRole",value:function(){return this.role}},{key:"addRole",value:function(t){var r=this,e=this.idmUser.Roles.filter(function(e){return e.Uuid!==r.idmUser.Uuid}),e=[].concat(s(e.filter(function(e){return e.Uuid!==t.Uuid})),[t]);this.idmUser.Roles=[].concat(s(e),[this.idmRole]),this.dirty=!0,this.role.updateParentRoles(e)}},{key:"removeRole",value:function(t){var r=this,e=this.idmUser.Roles.filter(function(e){return e.Uuid!==r.idmUser.Uuid&&e.Uuid!==t.Uuid});this.idmUser.Roles=[].concat(s(e),[this.idmRole]),this.dirty=!0,this.role.updateParentRoles(e)}},{key:"switchRoles",value:function(e,t){for(var r=this,a=this.idmUser.Roles.filter(function(e){return e.Uuid!==r.idmUser.Uuid}),o=void 0,i=void 0,n=void 0,l=0;l<a.length;l++)a[l].Uuid===e?n=a[o=l]:a[l].Uuid===t&&(i=l);a[o]=a[i],a[i]=n,this.idmUser.Roles=[].concat(s(a),[this.idmRole]),this.dirty=!0,this.role.updateParentRoles(a)}},{key:"getIdmUser",value:function(){return this.buildProxy(this.idmUser)}},{key:"buildProxy",value:function(e){var a=this;return new Proxy(e,{set:function(e,t,r){return e[t]=r,a.dirty=!0,a.notify("update"),!0},get:function(e,t){t=e[t];return!(t instanceof Array)&&t instanceof Object?a.buildProxy(t):t}})}}]),p);function p(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),i(Object.getPrototypeOf(p.prototype),"constructor",this).call(this),this.acls=[];var r=[];e?(this.idmUser=e,this.idmUser.Roles&&(this.idmRole=this.idmUser.Roles.filter(function(e){return e.Uuid===t.idmUser.Uuid})[0],this.idmUser.IsGroup||(r=this.idmUser.Roles.filter(function(e){return e.Uuid!==t.idmUser.Uuid}))),this.idmUser.Attributes||(this.idmUser.Attributes={})):(this.idmUser=new u.IdmUser,this.idmUser.Uuid=(0,c.v4)(),this.idmRole=u.IdmRole.constructFromObject({Uuid:this.idmUser.Uuid}),this.idmUser.Roles=[this.idmRole],this.idmUser.Attributes={}),this.role=new d.default(this.idmRole,r),this.role.observe("update",function(){t.dirty|=t.role.isDirty(),t.notify("update")}),this.makeSnapshot()}r.default=a,t.exports=r.default},{"./Role":17,"cells-sdk":"cells-sdk","pydio/lang/observable":"pydio/lang/observable",uuid:52}],19:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=a(e("./Role")),e=a(e("./User")),e={Role:o.default,User:e.default};r.default=e,t.exports=r.default},{"./Role":17,"./User":18}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("create-react-class")),u=n(e("./ParametersPicker")),c=n(e("prop-types")),d=n(e("pydio")),p=e("material-ui/styles"),e=d.default.requireLib("boot"),d=e.ActionDialogMixin,e=e.CancelButtonProviderMixin,f=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,l["default"].Component),a(m,[{key:"render",value:function(){var e=this.props,t=e.getMessage,e=e.muiTheme.palette.primary1Color;return l.default.createElement("div",{style:{backgroundColor:e,color:"white",padding:"0 24px 24px"}},l.default.createElement("h3",{style:{color:"white"}},t("14")),l.default.createElement("div",{className:"legend"},t("15")))}}]),m);function m(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),i(Object.getPrototypeOf(m.prototype),"constructor",this).apply(this,arguments)}f=(0,p.muiThemeable)()(f),c=(0,s.default)({displayName:"ParameterCreate",mixins:[d,e],propTypes:{workspaceScope:c.default.string,showModal:c.default.func,hideModal:c.default.func,pluginsFilter:c.default.func,roleType:c.default.oneOf(["user","group","role"]),createParameter:c.default.func},getDefaultProps:function(){return{dialogPadding:0,dialogTitle:"",dialogSize:"md"}},getInitialState:function(){return{step:1,workspaceScope:this.props.workspaceScope,pluginName:null,paramName:null,actions:{},parameters:{}}},setSelection:function(e,t,r,a){this.setState({pluginName:e,type:t,paramName:r,attributes:a},this.createParameter)},createParameter:function(){this.props.createParameter(this.state.type,this.state.pluginName,this.state.paramName,this.state.attributes),this.props.onDismiss()},render:function(){function e(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r.MessageHash[t+(t?".":"")+e]||e}var t=this.props,r=t.pydio,a=t.actions,t=t.parameters;return l.default.createElement("div",{className:"picker-list"},l.default.createElement(f,{getMessage:e}),l.default.createElement(u.default,{pydio:r,allActions:a,allParameters:t,onSelection:this.setSelection,getMessage:e}))}});r.default=c,t.exports=r.default},{"./ParametersPicker":23,"create-react-class":"create-react-class","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio",react:"react"}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,o=!1,i=void 0;try{for(var n,l=e[Symbol.iterator]();!(a=(n=l.next()).done)&&(r.push(n.value),!t||r.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var y=n(e("react")),l=e("../util/MessagesMixin"),h=(e("cells-sdk"),n(e("pydio/util/xml"))),g=(e("../model/Role"),e("material-ui")),v=n(e("pydio")).default.requireLib("form"),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,y["default"].Component),a(s,[{key:"onChangeParameter",value:function(e,t){var r,a;e!==t&&(r=(a=this.props).role,a=(t=a.acl).Action.Name,r.setParameter(a,e,t.WorkspaceID))}},{key:"deleteParameter",value:function(){var e=this.props,t=e.role,e=e.acl;t.deleteParameter(e)}},{key:"overrideParameter",value:function(){var e=this.props,t=e.role,r=e.acl,a=r.Action.Name,o=a.split(":"),e=f(o,3),o=e[0],o=(e[1],e[2],"action"===o?!1:"");t.setParameter(a,o,r.WorkspaceID)}},{key:"onInputEditMode",value:function(e){this.setState({editMode:e})}},{key:"toggleEditMode",value:function(){this.refs.formElement&&this.refs.formElement.toggleEditMode()}},{key:"toggleActionStatus",value:function(e,t){var r=this.props,a=r.role,r=r.acl;a.setParameter(r.Action.Name,t,r.WorkspaceID)}},{key:"render",value:function(){var e=this.props,t=e.acl,r=e.actions,a=e.parameters,o=e.pydio,i=e.getMessage,n=e.getPydioRoleMessage,l=t.Action.Name.split(":"),s=f(l,3),u=s[0],c=s[1],d=s[2],e=void 0,e="DEFAULT_START_REPOSITORY"===d?t.Action.Value:JSON.parse(t.Action.Value),l=t.INHERITED,s=d,t=void 0;"parameter"===u&&a[c]?(p=a[c].filter(function(e){return e.parameter===d})).length&&(t=p[0]):"action"===u&&r[c]&&(p=r[c].filter(function(e){return e.action===d})).length&&(t=p[0]);c=void 0;if("parameter"===u){var p={type:"string",label:s,name:d};if("user"===(p=t?v.Manager.parameterNodeToHash(t.xmlNode):p).scope)return null;s=p.label,c=v.createFormElement({ref:"formElement",attributes:p,name:d,value:e,onChange:this.onChangeParameter.bind(this),disabled:l,onChangeEditMode:this.onInputEditMode.bind(this),displayContext:"grid"})}else t&&(s=h.default.XPathGetSingleNodeText(t.xmlNode,"gui/@text")||s,o.MessageHash[s]&&(s=o.MessageHash[s])),c=y.default.createElement("div",{className:"role-action-toggle"},y.default.createElement(g.Toggle,{name:this.props.name,onToggle:this.toggleActionStatus.bind(this),toggled:!!e,label:i(e?"2":"3"),labelPosition:"right"}));o=void 0,e={style:{opacity:.2},hoveredStyle:{opacity:1}};return"parameter"===u?this.state.editMode?o=y.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-content-save",tooltip:i("6"),onClick:this.toggleEditMode.bind(this)},e)):(o=y.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-close",tooltip:i("4"),onClick:this.deleteParameter.bind(this)},e)),l&&(o=y.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-content-copy",tooltip:i("5"),onClick:this.overrideParameter.bind(this)},e)))):o=l?y.default.createElement("div",{style:{width:48,height:48}}):y.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-close",tooltip:i("4"),onClick:this.deleteParameter.bind(this)},e)),y.default.createElement("tr",{className:(l?"inherited":"")+(this.state.editMode?" edit-mode":""),style:m({},this.props.style)},y.default.createElement("td",{style:{width:"40%",fontWeight:500}},l?"["+n("38")+"]":""," ",s),y.default.createElement("td",{style:{wordBreak:"break-all"}},c),y.default.createElement("td",{style:{width:50}},o))}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,e),this.state={editMode:!1}}r.default=(0,l.withRoleMessages)(a),t.exports=r.default},{"../model/Role":39,"../util/MessagesMixin":45,"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio","pydio/util/xml":"pydio/util/xml",react:"react"}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],a=!0,o=!1,i=void 0;try{for(var n,l=e[Symbol.iterator]();!(a=(n=l.next()).done)&&(r.push(n.value),!t||r.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var n=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var d=l(e("react")),p=l(e("./ParameterEntry")),f=e("material-ui"),s=e("cells-sdk"),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,d["default"].Component),o(u,[{key:"componentDidMount",value:function(){var t=this;AdminComponents.PluginsLoader.getInstance(this.props.pydio).allPluginsActionsAndParameters().then(function(e){t.setState({actions:e.ACTIONS,parameters:e.PARAMETERS})})}},{key:"onCreateParameter",value:function(e,t,r,a,o){var i=this.props.role,r=t+":"+r+":"+a,a=void 0;"action"===t?a=!1:o&&o.xmlNode&&(a=(o=o.xmlNode).getAttribute("default")?o.getAttribute("default"):"","boolean"===o.getAttribute("type")?a="true"===a:"integer"===o.getAttribute("type")&&(a=parseInt(a))),i.setParameter(r,a,e)}},{key:"addParameter",value:function(o){var i=this,e=this.props,t=e.pydio,r=e.roleType,a=this.state,e=a.actions,a=a.parameters;t.UI.openComponentInModal("AdminPeople","Editor.Params.ParameterCreate",{pydio:t,actions:e,parameters:a,workspaceScope:o,createParameter:function(e,t,r,a){i.onCreateParameter(o,e,t,r,a)},roleType:r})}},{key:"render",value:function(){var o=this,e=this.props,i=e.role,n=e.pydio;if(!i)return null;function l(e){return n.MessageHash["pydio_role."+e]||e}var s=this.state.workspaces,e=i.listParametersAndActions(),u={PYDIO_REPO_SCOPE_ALL:{},PYDIO_REPO_SCOPE_SHARED:{}};e.forEach(function(e){u[e.WorkspaceID]||(u[e.WorkspaceID]={});var t=e.Action.Name.split(":"),t=a(t,3),t=(t[0],t[1],t[2]);u[e.WorkspaceID][t]=e});e=[d.default.createElement(f.MenuItem,{primaryText:l("parameters.scope.selector.title"),value:1}),d.default.createElement(f.MenuItem,{primaryText:l("parameters.scope.all"),onClick:function(){o.addParameter("PYDIO_REPO_SCOPE_ALL")}}),d.default.createElement(f.MenuItem,{primaryText:l("parameters.scope.shared"),onClick:function(){o.addParameter("PYDIO_REPO_SCOPE_SHARED")}}),d.default.createElement(f.Divider,null)].concat(Object.keys(s).map(function(e){return d.default.createElement(f.MenuItem,{primaryText:s[e].Label,onClick:function(){o.addParameter(e)}})}));return d.default.createElement("div",null,d.default.createElement("h3",{className:"paper-right-title",style:{display:"flex"}},d.default.createElement("span",{style:{flex:1,paddingRight:20}},l("46"),d.default.createElement("div",{className:"section-legend"},l("47"))),d.default.createElement("div",{style:{width:160}},d.default.createElement(f.SelectField,{fullWidth:!0,value:1},e))),d.default.createElement("div",{style:{padding:"0 20px"}},Object.keys(u).map(function(r){var e=void 0,a=!1,e="PYDIO_REPO_SCOPE_ALL"===r?l("parameters.scope.all"):"PYDIO_REPO_SCOPE_SHARED"===r?l("parameters.scope.shared"):s[r]?l("parameters.scope.workspace").replace("%s",s[r].Label):l("parameters.scope.workspace").replace("%s",r),t=void 0,t=Object.keys(u[r]).length?Object.keys(u[r]).map(function(e){var t={backgroundColor:a?"#FAFAFA":"white"};return a=!a,d.default.createElement(p.default,c({pydio:n,acl:u[r][e],role:i},o.state,{style:t}))}):d.default.createElement("tr",null,d.default.createElement("td",{colSpan:3,style:{padding:"14px 0"}},l("parameters.empty")));return d.default.createElement("table",{style:{width:"100%",marginBottom:20}},d.default.createElement("tr",{style:{borderBottom:"1px solid #e0e0e0"}},d.default.createElement("td",{colSpan:2,style:{fontSize:15,paddingTop:10}},e),d.default.createElement("td",{style:{width:50}},d.default.createElement(f.IconButton,{iconClassName:"mdi mdi-plus",onClick:function(){o.addParameter(r)},tooltip:l("parameters.custom.add")}))),t)})))}}]),u);function u(e){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),n(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,e),this.state={actions:{},parameters:{},workspaces:{}};var t=new s.WorkspaceServiceApi(PydioApi.getRestClient()),e=new s.RestSearchWorkspaceRequest;e.Queries=[s.IdmWorkspaceSingleQuery.constructFromObject({scope:"ADMIN"})],t.searchWorkspaces(e).then(function(e){var e=e.Workspaces||[],t={};e.forEach(function(e){t[e.UUID]=e}),r.setState({workspaces:t})})}r.default=o,t.exports=r.default},{"./ParameterEntry":21,"cells-sdk":"cells-sdk","material-ui":"material-ui",react:"react"}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},o=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var n=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var v=l(e("react")),u=l(e("pydio/util/lang")),b=l(e("pydio/util/xml")),c=e("material-ui"),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,v["default"].Component),o(d,[{key:"filter",value:function(e){this.setState({filter:e.target.value.toLowerCase()})}},{key:"select",value:function(e,t,r,a){this.props.onSelection(e,t,r,a),this.setState({pluginName:e,type:t,paramName:r})}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.refs.input.focus()},150)}},{key:"render",value:function(){function d(e){return!o||-1!==e.toLowerCase().indexOf(o)}function p(e){if(!o)return e;var t=e.toLowerCase().indexOf(o),r=e.substr(0,t),a=e.substr(t,o.length),t=e.substr(t+o.length);return v.default.createElement("span",null,r,v.default.createElement("span",{className:"highlight"},a),t)}var f=this,e=this.props,m=e.pydio,r=e.allParameters,a=e.allActions,o=this.state.filter,y=this.state.paramName,h=this.state.pluginName,g=this.state.type,t=[],i={};return Object.keys(r).forEach(function(e){var t;i[e]||(i[e]={name:e,label:e,actions:[],params:[]}),(t=i[e].params).push.apply(t,s(r[e]))}),Object.keys(a).forEach(function(e){var t;i[e]||(i[e]={name:e,label:e,actions:[],params:[]}),(t=i[e].actions).push.apply(t,s(a[e]))}),u.default.objectValues(i).map(function(s){var u=[],c=!1,e=s.label||s.name;(d(e)||d(s.name))&&(c=!0,d(e)?e=p(e):d(s.name)&&(e=v.default.createElement("span",null,e," (",p(s.name),")"))),s.params.concat(s.actions).map(function(e){var t=e.action||e.parameter,r=e.label||t,a="";e.action?(r=b.default.XPathGetSingleNodeText(e.xmlNode,"gui/@text")||r,a=f.props.actionsPrefix):(r=e.xmlNode.getAttribute("label")||r,f.props.parametersPrefix&&(a=f.props.parametersPrefix)),m.MessageHash[r]&&(r=m.MessageHash[r]);var o,i,n=d(r),l=d(t);(n||l||c)&&(o=("*"===h||h===s.name)&&e[g]&&y===t,i=r,n?i=p(r):l&&(i=v.default.createElement("span",null,r," (",p(t),") ")),u.push(v.default.createElement("li",{onClick:function(){return f.select(s.name,e.action?"action":"parameter",t,e)},className:(o?"selected ":"")+"parameters-param",key:s.name+"-"+(e.action?"action":"parameter")+"-"+t},a," ",i)))}),u.length&&t.push(v.default.createElement("li",{className:"parameters-plugin",key:s.name},e,v.default.createElement("ul",null,u)))}),v.default.createElement("div",null,v.default.createElement("div",{style:{padding:"0 24px",borderBottom:"1px solid #e0e0e0"}},v.default.createElement(c.TextField,{ref:"input",floatingLabelText:this.props.getMessage("13"),onChange:this.filter.bind(this),fullWidth:!0,underlineShow:!1})),v.default.createElement("div",{className:"parameters-tree-scroller"},v.default.createElement("ul",{className:"parameters-tree"},t)))}}]),d);function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),n(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,a({actionsPrefix:"[a] ",parametersPrefix:""},e)),this.state={filter:null},this.props.initialSelection&&(this.state=a({filter:this.props.initialSelection.paramName},this.props.initialSelection))}r.default=o,t.exports=r.default},{"material-ui":"material-ui","pydio/util/lang":"pydio/util/lang","pydio/util/xml":"pydio/util/xml",react:"react"}],24:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=a(e("./ParameterEntry")),i=a(e("./ParameterCreate")),n=a(e("./ParametersPanel")),o={ParametersPicker:a(e("./ParametersPicker")).default,ParameterCreate:i.default,ParametersPanel:n.default,ParameterEntry:o.default};r.default=o,t.exports=r.default},{"./ParameterCreate":20,"./ParameterEntry":21,"./ParametersPanel":22,"./ParametersPicker":23}],25:[function(f,m,y){!function(r){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};function e(e){return e&&e.__esModule?e:{default:e}}var a=e(f("react")),o=e(f("create-react-class")),i=e(f("prop-types")),n=e(f("pydio")),l=e(f("../model/User")),s=e(f("pydio/util/pass")),u=n.default.requireLib("boot"),c=u.ActionDialogMixin,d=u.CancelButtonProviderMixin,u=u.SubmitButtonProviderMixin,p=n.default.requireLib("hoc").ModernTextField;y.default=(0,o.default)({displayName:"UserPasswordDialog",mixins:[AdminComponents.MessagesConsumerMixin,c,d,u],propTypes:{pydio:i.default.instanceOf(n.default),user:i.default.instanceOf(l.default)},getDefaultProps:function(){return{dialogTitle:pydio.MessageHash["role_editor.25"],dialogSize:"sm"}},getInitialState:function(){var e=s.default.getState();return t({},e)},onChange:function(e,t){var r=this.refs.pass.getValue(),a=this.refs.confirm.getValue(),a=s.default.getState(r,a,this.state);this.setState(a)},submit:function(){var e,t,r=this;this.state.valid?(e=this.refs.pass.getValue(),(t=this.props.user).getIdmUser().Password=e,t.save().then(function(){r.dismiss()})):this.props.pydio.UI.displayMessage("ERROR",this.state.passErrorText||this.state.confirmErrorText)},render:function(){function e(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return r.pydio.MessageHash[t+(t?".":"")+e]||e}return a.default.createElement("div",{style:{width:"100%"}},a.default.createElement(p,{ref:"pass",type:"password",fullWidth:!0,onChange:this.onChange,floatingLabelText:e("523"),errorText:this.state.passErrorText,hintText:this.state.passHintText}),a.default.createElement(p,{ref:"confirm",type:"password",fullWidth:!0,onChange:this.onChange,floatingLabelText:e("199"),errorText:this.state.confirmErrorText}))}}),m.exports=y.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../model/User":40,"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],26:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var u=a(e("react")),o=a(e("create-react-class")),c=e("material-ui"),i=e("../util/MessagesMixin"),n=a(e("prop-types")),l=a(e("pydio/http/api"));r.default=(0,o.default)({displayName:"UserRolesPicker",mixins:[i.RoleMessagesConsumerMixin],propTypes:{profile:n.default.string,roles:n.default.array,addRole:n.default.func,removeRole:n.default.func,switchRoles:n.default.func},getInitialState:function(){return{availableRoles:[]}},componentDidMount:function(){var t=this;l.default.getRestClient().getIdmApi().listRoles().then(function(e){t.setState({availableRoles:e})})},onChange:function(e,t,r){-1!==r&&this.props.addRole(r)},remove:function(t){var e=this.state.availableRoles.filter(function(e){return e.Uuid===t})[0];this.props.removeRole(e)},orderUpdated:function(e,t,r){this.props.switchRoles(e,t)},render:function(){var t=[],r=[],a=[],o=this.context,e=this.props,i=e.roles,n=e.loadingMessage,l=e.profile,e=this.state.availableRoles;i.map(function(e){e.GroupRole?"ROOT_GROUP"===e.Uuid?t.push("/ "+o.getMessage("user.25","ajxp_admin")):t.push(o.getMessage("user.26","ajxp_admin").replace("%s",e.Label||e.Uuid)):e.UserRole?a.push(o.getMessage("user.27","ajxp_admin")):e.AutoApplies&&-1!==e.AutoApplies.indexOf(l)?t.push(e.Label+" [auto]"):r.push({payload:e.Uuid,text:e.Label})}.bind(this));var e=[u.default.createElement(c.MenuItem,{value:-1,primaryText:o.getMessage("20")})].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e.filter(function(e){return-1===i.indexOf(e)}).map(function(e){return u.default.createElement(c.MenuItem,{value:e,primaryText:e.Label||e.Uuid})}))),s={padding:10,fontSize:14,backgroundColor:"#ffffff",borderRadius:2,margin:"8px 0"};return u.default.createElement("div",{className:"user-roles-picker",style:{padding:0,margin:"-30px 20px 40px",backgroundColor:"#f5f5f5",borderRadius:3}},u.default.createElement("div",{style:{paddingLeft:10,marginBottom:-6,display:"flex",alignItems:"center"}},u.default.createElement("div",{style:{flex:1,color:"#a1a1a1",fontSize:16}},o.getMessage("roles.picker.title")," ",n?" ("+o.getMessage("21")+")":""),u.default.createElement("div",{className:"roles-picker-menu",style:{marginBottom:-12}},u.default.createElement(c.DropDownMenu,{underlineStyle:{display:"none"},onChange:this.onChange,value:-1},e))),u.default.createElement("div",{className:"roles-list",style:{margin:"0 8px",paddingBottom:1}},t.map(function(e){return u.default.createElement("div",{key:"group-"+e,style:s},e)}),u.default.createElement(PydioComponents.SortableList,{key:"sortable",values:r,removable:!0,onRemove:this.remove,onOrderUpdated:this.orderUpdated,itemClassName:"role-item role-item-sortable"}),a.map(function(e){return u.default.createElement("div",{key:"user-"+e,style:s},e)})))}}),t.exports=r.default},{"../util/MessagesMixin":45,"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types","pydio/http/api":"pydio/http/api",react:"react"}],27:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=a(e("./UserPasswordDialog")),e=a(e("./UserRolesPicker")),e={UserPasswordDialog:o.default,UserRolesPicker:e.default};r.default=e,t.exports=r.default},{"./UserPasswordDialog":25,"./UserRolesPicker":26}],28:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=a(e("pydio/util/func")),n=a(e("pydio/http/resources-manager"));r.loadEditorClass=function(t,r){if(!(t=void 0===t?"":t))return Promise.resolve(r);var e=t.split("."),a=e.shift(),o=e.join(".");return n.default.loadClass(a).then(function(e){e=i.default.getFunctionByName(o,e);return e||(console.error("Cannot find editor component, using default instead",t),r)}).catch(function(e){return console.error("Cannot find editor component, using default instead",t),r})}},{"pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func"}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={CACHE:null},t.exports=r.default},{}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},o=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e){return e&&e.__esModule?e:{default:e}}var l=e("react"),s=n(l),u=n(e("prop-types")),c=n(e("pydio")),e={contextTypes:{messages:u.default.object,getMessage:u.default.func,getPydioRoleMessage:u.default.func,getRootMessage:u.default.func}},u={childContextTypes:{messages:u.default.object,getMessage:u.default.func,getPydioRoleMessage:u.default.func,getRootMessage:u.default.func},getChildContext:function(){var r=this.context.pydio.MessageHash;return{messages:r,getMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r[t+(t?".":"")+e]||e},getPydioRoleMessage:function(e){return r["role_editor."+e]||e},getRootMessage:function(e){return r[e]||e}}}};r.RoleMessagesConsumerMixin=e,r.RoleMessagesProviderMixin=u,r.withRoleMessages=function(e){return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),o(t,[{key:"render",value:function(){var r=(this.props.pydio||c.default.getInstance()).MessageHash;return s.default.createElement(e,a({},this.props,{getMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r[t+(t?".":"")+e]||e},getPydioRoleMessage:function(e){return r["role_editor."+e]||e},getRootMessage:function(e){return r[e]||e},getAdminMessage:function(e){return r["ajxp_admin."+e]||e}}))}}]),t;function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}}},{"prop-types":"prop-types",pydio:"pydio",react:"react"}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,o=e("./EditorCache"),i=(a=o)&&a.__esModule?a:{default:a},n=e("./MessagesMixin"),e=e("./ClassLoader"),e={EditorCache:i.default,RoleMessagesConsumerMixin:n.RoleMessagesConsumerMixin,withRoleMessages:n.withRoleMessages,loadEditorClass:e.loadEditorClass};r.default=e,t.exports=r.default},{"./ClassLoader":28,"./EditorCache":29,"./MessagesMixin":30}],32:[function(e,t,r){arguments[4][6][0].apply(r,arguments)},{"./WorkspaceAcl":34,"cells-sdk":"cells-sdk",dup:6,"pydio/util/lang":"pydio/util/lang",react:"react"}],33:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{"../util/MessagesMixin":45,dup:7,"material-ui":"material-ui",react:"react"}],34:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"../util/MessagesMixin":45,"./RightsSelector":33,"cells-sdk":"cells-sdk",dup:9,"material-ui":"material-ui",react:"react"}],35:[function(e,t,r){arguments[4][10][0].apply(r,arguments)},{"./WorkspaceAcl":34,"cells-sdk":"cells-sdk",dup:10,pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang",react:"react"}],36:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"../model/User":40,dup:13,"prop-types":"prop-types",pydio:"pydio",react:"react"}],37:[function(e,t,r){arguments[4][14][0].apply(r,arguments)},{"../model/Role":39,dup:14,"prop-types":"prop-types",pydio:"pydio",react:"react"}],38:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{"../model/User":40,"../user/UserRolesPicker":43,dup:15,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],39:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"cells-sdk":"cells-sdk",dup:17,"pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable",uuid:52}],40:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{"./Role":39,"cells-sdk":"cells-sdk",dup:18,"pydio/lang/observable":"pydio/lang/observable",uuid:52}],41:[function(e,t,r){arguments[4][21][0].apply(r,arguments)},{"../model/Role":39,"../util/MessagesMixin":45,"cells-sdk":"cells-sdk",dup:21,"material-ui":"material-ui",pydio:"pydio","pydio/util/xml":"pydio/util/xml",react:"react"}],42:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{"./ParameterEntry":41,"cells-sdk":"cells-sdk",dup:22,"material-ui":"material-ui",react:"react"}],43:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{"../util/MessagesMixin":45,"create-react-class":"create-react-class",dup:26,"material-ui":"material-ui","prop-types":"prop-types","pydio/http/api":"pydio/http/api",react:"react"}],44:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28,"pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func"}],45:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{dup:30,"prop-types":"prop-types",pydio:"pydio",react:"react"}],46:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var u=a(e("react")),o=a(e("create-react-class")),i=a(e("prop-types")),n=a(e("pydio")),f=a(e("pydio/http/api")),l=a(e("pydio/model/node")),s=a(e("pydio/util/lang")),c=n.default.requireLib("hoc").ModernTextField,i=(0,o.default)({displayName:"CreateRoleOrGroupForm",mixins:[AdminComponents.MessagesConsumerMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],propTypes:{type:i.default.oneOf(["group","user","role"]),roleNode:i.default.instanceOf(l.default),openRoleEditor:i.default.func},getTitle:function(){return"group"===this.props.type?this.context.getMessage("ajxp_admin.user.15"):this.context.getMessage("ajxp_admin.user.14")},getPadding:function(){return!0},getSize:function(){return"sm"},dismiss:function(){return this.props.onDismiss()},getInitialState:function(){return{groupId:"",groupIdError:this.context.getMessage("ajxp_admin.user.16.empty"),groupLabel:"",groupLabelError:this.context.getMessage("ajxp_admin.user.17.empty"),roleId:"",roleLabel:"",roleLabelError:this.context.getMessage("ajxp_admin.user.18.empty")}},submit:function(){var e=this,t=this.props,r=t.type,a=t.pydio,o=t.reload,i=void 0,n=this.state,l=n.groupId,s=n.groupIdError,u=n.groupLabel,c=n.groupLabelError,d=n.roleId,p=n.roleIdError,t=n.roleLabel,n=n.roleLabelError;"group"===r?s||c||(a=(i=a.getContextHolder().getSelectedNodes().length?a.getContextHolder().getSelectedNodes()[0]:a.getContextNode()).getPath().replace("/idm/users",""),f.default.getRestClient().getIdmApi().createGroup(a||"/",l,u).then(function(){e.dismiss(),i.reload()})):"role"===r&&(n||p||f.default.getRestClient().getIdmApi().createRole(t,d).then(function(){e.dismiss(),o&&o()}))},update:function(t){var e,r;void 0!==t.groupId?new RegExp(/^[0-9A-Z\-_.:\+]+$/i).test(t.groupId)?""===t.groupId?t.groupIdError=this.context.getMessage("ajxp_admin.user.16.empty"):t.groupIdError="":t.groupIdError=this.context.getMessage("ajxp_admin.user.16.format"):void 0!==t.groupLabel?""===t.groupLabel?t.groupLabelError=this.context.getMessage("ajxp_admin.user.17.empty"):(t.groupLabelError="",r=(e=this.state).groupId,e=e.groupLabel,""!==r&&s.default.computeStringSlug(e)!==r||(t.groupId=s.default.computeStringSlug(t.groupLabel),t.groupIdError="")):void 0!==t.roleLabel?""===t.roleLabel?t.roleLabelError=this.context.getMessage("ajxp_admin.user.18.empty"):t.roleLabelError="":t.roleId&&(0<(void 0===(r=this.props.roles)?[]:r).filter(function(e){return e.Uuid===t.roleId}).length?t.roleIdError=this.context.getMessage("role_editor.31.exists"):t.roleIdError="",t.roleId=s.default.computeStringSlug(t.roleId)),this.setState(t)},render:function(){var r=this,e=this.state,t=e.groupId,a=e.groupIdError,o=e.groupLabel,i=e.groupLabelError,n=e.roleId,l=e.roleIdError,s=e.roleLabel,e=e.roleLabelError;return"group"===this.props.type?u.default.createElement("div",{style:{width:"100%"}},u.default.createElement(c,{value:o,errorText:i,onChange:function(e,t){r.update({groupLabel:t})},fullWidth:!0,floatingLabelText:this.context.getMessage("ajxp_admin.user.17"),onKeyPress:function(e){"Enter"===e.key&&r.submit()}}),u.default.createElement(c,{value:t,errorText:a,onChange:function(e,t){r.update({groupId:t})},fullWidth:!0,floatingLabelText:this.context.getMessage("ajxp_admin.user.16"),onKeyDown:function(e){"Enter"===e.key&&r.submit()}})):u.default.createElement("div",{style:{width:"100%"}},u.default.createElement(c,{value:s,errorText:e,onChange:function(e,t){r.update({roleLabel:t})},floatingLabelText:this.context.getMessage("role_editor.32"),onKeyDown:function(e){"Enter"===e.key&&r.submit()}}),u.default.createElement(c,{value:n,errorText:l,floatingLabelText:this.context.getMessage("role_editor.31.hint"),onChange:function(e,t){r.update({roleId:t})},onKeyDown:function(e){"Enter"===e.key&&r.submit()}}))}});r.default=i,t.exports=r.default},{"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/lang":"pydio/util/lang",react:"react"}],47:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e};function o(e){return e&&e.__esModule?e:{default:e}}var i=o(e("react")),n=o(e("create-react-class")),l=o(e("prop-types")),s=o(e("pydio")),u=o(e("pydio/http/api")),c=o(e("pydio/util/pass")),d=o(e("pydio/model/node")),p=s.default.requireLib("hoc").ModernTextField,l=(0,n.default)({displayName:"CreateUserForm",propTypes:{dataModel:l.default.instanceOf(PydioDataModel),openRoleEditor:l.default.func},mixins:[AdminComponents.MessagesConsumerMixin,PydioReactUI.ActionDialogMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],getDefaultProps:function(){return{dialogSize:"sm",dialogTitleId:"ajxp_admin.user.19"}},getInitialState:function(){var e=c.default.getState();return a({step:1},e)},checkPassword:function(){var e=this.refs.pass.getValue(),t=this.refs.passconf.getValue();this.setState(c.default.getState(e,t,this.state))},checkLogin:function(e,t){t=c.default.isValidLogin(t);this.setState({loginErrorText:t})},submit:function(){var r,a,o,e,i=this;this.state.valid&&!this.state.loginErrorText?(r=this.props.dataModel.getUniqueNode()||this.props.dataModel.getContextNode(),(a=r.getPath()).startsWith("/idm/users")&&(a=a.substr("/idm/users".length)),o=this.refs.user_id.getValue(),e=this.refs.pass.getValue(),u.default.getRestClient().getIdmApi().createUser(a,o,e).then(function(e){i.dismiss(),r.reload();var t=new d.default(a+"/"+o,!0);t.getMetadata().set("ajxp_mime","user"),t.getMetadata().set("IdmUser",e),i.props.openRoleEditor(t)})):this.props.pydio.UI.displayMessage("ERROR",this.state.passErrorText||this.state.confirmErrorText||this.state.loginErrorText)},render:function(){var e=(this.props.dataModel.getUniqueNode()||this.props.dataModel.getContextNode()).getPath(),t=void 0;return e.startsWith("/idm/users")&&(t=(t=e.substr("/idm/users".length))&&i.default.createElement("div",null,this.context.getMessage("ajxp_admin.user.20").replace("%s",t))),i.default.createElement("div",{style:{width:"100%"}},t,i.default.createElement("form",{autoComplete:"off"},i.default.createElement("div",{style:{width:"100%"}},i.default.createElement(p,{ref:"user_id",onChange:this.checkLogin,fullWidth:!0,floatingLabelText:this.context.getMessage("ajxp_admin.user.21"),errorText:this.state.loginErrorText,autoComplete:"nope"})),i.default.createElement("div",null,i.default.createElement(p,{ref:"pass",type:"password",floatingLabelText:this.context.getMessage("ajxp_admin.user.22"),onChange:this.checkPassword,fullWidth:!0,errorText:this.state.passErrorText||this.state.passHintText,autoComplete:"new-password"})),i.default.createElement("div",null,i.default.createElement(p,{ref:"passconf",type:"password",floatingLabelText:this.context.getMessage("ajxp_admin.user.23"),onChange:this.checkPassword,fullWidth:!0,errorText:this.state.confirmErrorText,autoComplete:"confirm-password"}))))}});r.default=l,t.exports=r.default},{"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/pass":"pydio/util/pass",react:"react"}],48:[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var o=a(e("./board/Dashboard")),i=a(e("./board/RolesDashboard")),n=a(e("./board/PoliciesBoard")),l=a(e("./board/Callbacks")),s=a(e("./forms/CreateUserForm")),u=a(e("./forms/CreateRoleOrGroupForm")),c=a(e("./editor/ACL")),d=a(e("./editor/Info")),p=a(e("./editor/Model")),f=a(e("./editor/Params")),m=a(e("./editor/User")),e=a(e("./editor/Util"));window.AdminPeople={Callbacks:l.default,Dashboard:o.default,RolesDashboard:i.default,PoliciesBoard:n.default,Editor:{Model:p.default,Info:d.default,ACL:c.default,Params:f.default,User:m.default,Util:e.default},Forms:{CreateUserForm:s.default,CreateRoleOrGroupForm:u.default}}},{"./board/Callbacks":1,"./board/Dashboard":2,"./board/PoliciesBoard":3,"./board/RolesDashboard":4,"./editor/ACL":11,"./editor/Info":16,"./editor/Model":19,"./editor/Params":24,"./editor/User":27,"./editor/Util":31,"./forms/CreateRoleOrGroupForm":46,"./forms/CreateUserForm":47}],49:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("pydio")),m=n(e("react")),y=n(e("./Rule")),h=e("material-ui"),s=e("uuid"),g=l.default.requireLib("hoc").ModernTextField,a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,m["default"].Component),a(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({policy:e.policy})}},{key:"componentDidMount",value:function(){this.props.newPolicyWithRule&&this.onAddRule(null,this.props.newPolicyWithRule)}},{key:"onNameChange",value:function(e){var t=f({},this.state.policy);t.Name=e,this.props.savePolicy(t)}},{key:"onDescriptionChange",value:function(e){var t=f({},this.state.policy);t.Description=e,this.props.savePolicy(t)}},{key:"saveLabels",value:function(){var e=this.state,t=e.pName,r=e.pDesc,e=e.policy;t&&(e.Name=t),r&&(e.Description=r),this.setState({pName:null,pDesc:null}),this.props.savePolicy(e)}},{key:"onRuleChange",value:function(t){var e=f({},this.state.policy);e.Policies?(e.Policies=e.Policies.filter(function(e){return e.id!==t.id}),e.Policies.push(t)):e.Policies=[t],this.props.savePolicy(e)}},{key:"onRemoveRule",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=f({},this.state.policy);r.Policies=r.Policies.filter(function(e){return e.id!==t.id}),this.props.savePolicy(r,e)}},{key:"onAddRule",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?"":arguments[1],a=f({},this.state.policy);a.Policies||(a.Policies=[]);var o=(0,s.v4)(),i=[],n=[];"acl"===a.ResourceGroup?(i=["policy:"+a.Uuid],n=["acl"]):"oidc"===a.ResourceGroup&&(n=["oidc"]),a.Policies.push({id:o,description:r,actions:[],subjects:i,resources:n,effect:"deny"}),this.setState({policy:a,openRule:o},function(){t.setState({openRule:null})})}},{key:"render",value:function(){function e(e){return i.MessageHash["ajxp_admin.policies."+e]||e}var t,r=this,a=this.props,o=a.readonly,i=a.pydio,n=this.state,l=n.policy,s=n.openRule,u=l.Policies.map(function(e,t){return m.default.createElement(y.default,f({},r.props,{key:e.description,rule:e,isLast:t===l.Policies.length-1,create:s===e.id,onRuleChange:r.onRuleChange.bind(r),onRemoveRule:r.onRemoveRule.bind(r)}))}),c={iconStyle:{fontSize:18,color:"rgba(0,0,0,.33)"},style:{padding:8,width:36,height:36},tooltipPosition:"top-right"},d=m.default.createElement("div",{style:{display:"flex",alignItems:"center"}},m.default.createElement("div",{style:{fontSize:14,fontWeight:500}},"Rules"),!o&&m.default.createElement(h.IconButton,f({iconClassName:"mdi mdi-plus",tooltip:e("rule.create"),onClick:this.onAddRule.bind(this)},c,{tooltipPosition:"bottom-right"}))),p=void 0;return o||(a=r.state,t=a.showLabels,n=a.pName,o=a.pDesc,a=n&&n!==l.Name||o&&o!==l.Description,p=m.default.createElement("div",{style:{marginTop:10,paddingTop:10}},m.default.createElement("div",{style:{display:"flex",alignItems:"center"}},m.default.createElement("div",{style:{fontSize:14,fontWeight:500}},"Edit Labels"),m.default.createElement(h.IconButton,f({iconClassName:"mdi mdi-chevron-"+(t?"down":"right"),tooltip:e("policy.editLabels"),onClick:function(){return r.setState({showLabels:!t})}},c))),m.default.createElement("div",{style:{display:t?"flex":"none"}},m.default.createElement("div",{style:{marginRight:6,flex:1}},m.default.createElement(g,{value:n||l.Name,fullWidth:!0,onChange:function(e,t){r.setState({pName:t})}})),m.default.createElement("div",{style:{marginLeft:6,flex:1}},m.default.createElement(g,{value:o||l.Description,fullWidth:!0,onChange:function(e,t){r.setState({pDesc:t})}})),m.default.createElement("div",{style:{width:80}},m.default.createElement(h.IconButton,{disabled:!a,iconClassName:"mdi mdi-content-save",tooltip:e("policy.saveLabels"),tooltipPosition:"top-center",onClick:function(){r.saveLabels()},iconStyle:{fontSize:20,color:"rgba(0,0,0,"+(a?".43":".10")+")"},style:{padding:14}}))))),m.default.createElement("div",{style:{padding:"12px 24px",backgroundColor:"#f5f5f5"}},d,u,p)}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,e),this.state={policy:e.policy}}r.default=a,t.exports=r.default},{"./Rule":50,"material-ui":"material-ui",pydio:"pydio",react:"react",uuid:52}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(e,t,r){for(var a=!0;a;){var o=e,i=t,n=r,a=!1;null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}o=Object.getPrototypeOf(o);if(null===o)return;e=o,t=i,r=n,a=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=e("material-ui"),u=(n(e("pydio/util/func")),n(e("pydio/http/resources-manager")),e("../editor/util/ClassLoader")),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l["default"].Component),a(c,[{key:"componentDidMount",value:function(){this.props.create&&this.openEditor()}},{key:"openEditor",value:function(){var t=this,e=this.props,r=e.pydio,a=e.policy,o=e.rule,i=e.openRightPane,e=e.rulesEditorClass;return!(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(r.MessageHash["role_editor.19"]))&&(!!e&&((0,u.loadEditorClass)(e,null).then(function(e){i({COMPONENT:e,PROPS:{ref:"editor",policy:a,rule:o,pydio:r,saveRule:t.props.onRuleChange,create:t.props.create,onRequestTabClose:t.closeEditor.bind(t)}})}),!0))}},{key:"closeEditor",value:function(e){var t=this.props,r=t.pydio,t=t.closeRightPane;if(e&&e.isDirty()){if(e.isCreate())return this.props.onRemoveRule(this.props.rule,!0),t(),!0;if(!window.confirm(r.MessageHash["role_editor.19"]))return!1}return t(),!0}},{key:"removeRule",value:function(){var e=this.props,t=e.pydio,r=e.onRemoveRule,a=e.rule;t.UI.openConfirmDialog({message:t.MessageHash["ajxp_admin.policies.rule.delete.confirm"],destructive:[a.description],validCallback:function(){r(a)}})}},{key:"render",value:function(){var e=this.props,t=e.rule,r=e.readonly,a=e.isLast,o="allow"===t.effect?"#33691e":"#d32f2f",e=[];r||(e=[l.default.createElement("span",{className:"mdi mdi-pencil",style:{fontSize:16,color:"rgba(0,0,0,.33)",cursor:"pointer",marginLeft:12},onClick:this.openEditor.bind(this)}),l.default.createElement("span",{className:"mdi mdi-delete",style:{fontSize:16,color:"rgba(0,0,0,.33)",cursor:"pointer",marginLeft:12},onClick:this.removeRule.bind(this)})]);l.default.createElement("div",null,t.description,e);return l.default.createElement("div",{style:{display:"flex",padding:"6px 0 5px",borderBottom:a?null:"1px solid white"}},l.default.createElement(s.FontIcon,{className:"mdi mdi-traffic-light",color:o,style:{fontSize:16,marginRight:10}}),l.default.createElement("div",{style:{flex:1}},t.description,e))}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i(Object.getPrototypeOf(c.prototype),"constructor",this).apply(this,arguments)}r.default=a,t.exports=r.default},{"../editor/util/ClassLoader":44,"material-ui":"material-ui","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func",react:"react"}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;for(var a=[],o=0;o<256;++o)a[o]=(o+256).toString(16).substr(1);function i(e,t){return t=t||0,[a[e[t++]],a[e[t++]],a[e[t++]],a[e[t++]],"-",a[e[t++]],a[e[t++]],"-",a[e[t++]],a[e[t++]],"-",a[e[t++]],a[e[t++]],"-",a[e[t++]],a[e[t++]],a[e[t++]],a[e[t++]],a[e[t++]],a[e[t++]]].join("")}r.default=i,t.exports=r.default},{}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return n.default}});var a=l(e("./v1.js")),o=l(e("./v3.js")),i=l(e("./v4.js")),n=l(e("./v5.js"));function l(e){return e&&e.__esModule?e:{default:e}}},{"./v1.js":56,"./v3.js":57,"./v4.js":59,"./v5.js":60}],53:[function(e,t,r){"use strict";function d(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function l(e,t,r,a,o,i){return d((i=d(d(t,e),d(a,i)))<<(o=o)|i>>>32-o,r)}function p(e,t,r,a,o,i,n){return l(t&r|~t&a,e,t,o,i,n)}function f(e,t,r,a,o,i,n){return l(t&a|r&~a,e,t,o,i,n)}function m(e,t,r,a,o,i,n){return l(t^r^a,e,t,o,i,n)}function y(e,t,r,a,o,i,n){return l(r^(t|~a),e,t,o,i,n)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;function a(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Array(t.length);for(var r=0;r<t.length;r++)e[r]=t.charCodeAt(r)}return function(e){var t,r,a=[],o=32*e.length,i="0123456789abcdef";for(t=0;t<o;t+=8)r=e[t>>5]>>>t%32&255,r=parseInt(i.charAt(r>>>4&15)+i.charAt(15&r),16),a.push(r);return a}(function(e,t){var r,a,o,i,n;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var l=1732584193,s=-271733879,u=-1732584194,c=271733878;for(r=0;r<e.length;r+=16)l=p(a=l,o=s,i=u,n=c,e[r],7,-680876936),c=p(c,l,s,u,e[r+1],12,-389564586),u=p(u,c,l,s,e[r+2],17,606105819),s=p(s,u,c,l,e[r+3],22,-1044525330),l=p(l,s,u,c,e[r+4],7,-176418897),c=p(c,l,s,u,e[r+5],12,1200080426),u=p(u,c,l,s,e[r+6],17,-1473231341),s=p(s,u,c,l,e[r+7],22,-45705983),l=p(l,s,u,c,e[r+8],7,1770035416),c=p(c,l,s,u,e[r+9],12,-1958414417),u=p(u,c,l,s,e[r+10],17,-42063),s=p(s,u,c,l,e[r+11],22,-1990404162),l=p(l,s,u,c,e[r+12],7,1804603682),c=p(c,l,s,u,e[r+13],12,-40341101),u=p(u,c,l,s,e[r+14],17,-1502002290),s=p(s,u,c,l,e[r+15],22,1236535329),l=f(l,s,u,c,e[r+1],5,-165796510),c=f(c,l,s,u,e[r+6],9,-1069501632),u=f(u,c,l,s,e[r+11],14,643717713),s=f(s,u,c,l,e[r],20,-373897302),l=f(l,s,u,c,e[r+5],5,-701558691),c=f(c,l,s,u,e[r+10],9,38016083),u=f(u,c,l,s,e[r+15],14,-660478335),s=f(s,u,c,l,e[r+4],20,-405537848),l=f(l,s,u,c,e[r+9],5,568446438),c=f(c,l,s,u,e[r+14],9,-1019803690),u=f(u,c,l,s,e[r+3],14,-187363961),s=f(s,u,c,l,e[r+8],20,1163531501),l=f(l,s,u,c,e[r+13],5,-1444681467),c=f(c,l,s,u,e[r+2],9,-51403784),u=f(u,c,l,s,e[r+7],14,1735328473),s=f(s,u,c,l,e[r+12],20,-1926607734),l=m(l,s,u,c,e[r+5],4,-378558),c=m(c,l,s,u,e[r+8],11,-2022574463),u=m(u,c,l,s,e[r+11],16,1839030562),s=m(s,u,c,l,e[r+14],23,-35309556),l=m(l,s,u,c,e[r+1],4,-1530992060),c=m(c,l,s,u,e[r+4],11,1272893353),u=m(u,c,l,s,e[r+7],16,-155497632),s=m(s,u,c,l,e[r+10],23,-1094730640),l=m(l,s,u,c,e[r+13],4,681279174),c=m(c,l,s,u,e[r],11,-358537222),u=m(u,c,l,s,e[r+3],16,-722521979),s=m(s,u,c,l,e[r+6],23,76029189),l=m(l,s,u,c,e[r+9],4,-640364487),c=m(c,l,s,u,e[r+12],11,-421815835),u=m(u,c,l,s,e[r+15],16,530742520),s=m(s,u,c,l,e[r+2],23,-995338651),l=y(l,s,u,c,e[r],6,-198630844),c=y(c,l,s,u,e[r+7],10,1126891415),u=y(u,c,l,s,e[r+14],15,-1416354905),s=y(s,u,c,l,e[r+5],21,-57434055),l=y(l,s,u,c,e[r+12],6,1700485571),c=y(c,l,s,u,e[r+3],10,-1894986606),u=y(u,c,l,s,e[r+10],15,-1051523),s=y(s,u,c,l,e[r+1],21,-2054922799),l=y(l,s,u,c,e[r+8],6,1873313359),c=y(c,l,s,u,e[r+15],10,-30611744),u=y(u,c,l,s,e[r+6],15,-1560198380),s=y(s,u,c,l,e[r+13],21,1309151649),l=y(l,s,u,c,e[r+4],6,-145523070),c=y(c,l,s,u,e[r+11],10,-1120210379),u=y(u,c,l,s,e[r+2],15,718787259),s=y(s,u,c,l,e[r+9],21,-343485551),l=d(l,a),s=d(s,o),u=d(u,i),c=d(c,n);return[l,s,u,c]}(function(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var a=8*e.length;for(t=0;t<a;t+=8)r[t>>5]|=(255&e[t/8])<<t%32;return r}(e),8*e.length))}r.default=a,t.exports=r.default},{}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(a)return a(o);throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")};var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);t.exports=r.default},{}],55:[function(e,t,r){"use strict";function g(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;function a(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=new Array(a.length);for(var o=0;o<a.length;o++)e[o]=a.charCodeAt(o)}e.push(128);for(var i=e.length/4+2,n=Math.ceil(i/16),l=new Array(n),o=0;o<n;o++){l[o]=new Array(16);for(var s=0;s<16;s++)l[o][s]=e[64*o+4*s]<<24|e[64*o+4*s+1]<<16|e[64*o+4*s+2]<<8|e[64*o+4*s+3]}for(l[n-1][14]=8*(e.length-1)/Math.pow(2,32),l[n-1][14]=Math.floor(l[n-1][14]),l[n-1][15]=8*(e.length-1)&4294967295,o=0;o<n;o++){for(var u=new Array(80),c=0;c<16;c++)u[c]=l[o][c];for(c=16;c<80;c++)u[c]=g(u[c-3]^u[c-8]^u[c-14]^u[c-16],1);for(var d=r[0],p=r[1],f=r[2],m=r[3],y=r[4],c=0;c<80;c++)var h=Math.floor(c/20),h=g(d,5)+function(e,t,r,a){switch(e){case 0:return t&r^~t&a;case 1:return t^r^a;case 2:return t&r^t&a^r&a;case 3:return t^r^a}}(h,p,f,m)+y+t[h]+u[c]>>>0,y=m,m=f,f=g(p,30)>>>0,p=d,d=h;r[0]=r[0]+d>>>0,r[1]=r[1]+p>>>0,r[2]=r[2]+f>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+y>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}r.default=a,t.exports=r.default},{}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c,d,p=a(e("./rng.js")),f=a(e("./bytesToUuid.js"));function a(e){return e&&e.__esModule?e:{default:e}}var m=0,y=0;e=function(e,t,r){var a=t&&r||0,o=t||[],i=(e=e||{}).node||c,n=void 0!==e.clockseq?e.clockseq:d;null!=i&&null!=n||(s=e.random||(e.rng||p.default)(),null==i&&(i=c=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==n&&(n=d=16383&(s[6]<<8|s[7])));var l=void 0!==e.msecs?e.msecs:(new Date).getTime(),r=void 0!==e.nsecs?e.nsecs:y+1,s=l-m+(r-y)/1e4;if(s<0&&void 0===e.clockseq&&(n=n+1&16383),1e4<=(r=(s<0||m<l)&&void 0===e.nsecs?0:r))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=l,d=n,r=(1e4*(268435455&(l+=122192928e5))+(y=r))%4294967296,o[a++]=r>>>24&255,o[a++]=r>>>16&255,o[a++]=r>>>8&255,o[a++]=255&r,l=l/4294967296*1e4&268435455,o[a++]=l>>>8&255,o[a++]=255&l,o[a++]=l>>>24&15|16,o[a++]=l>>>16&255,o[a++]=n>>>8|128,o[a++]=255&n;for(var u=0;u<6;++u)o[a+u]=i[u];return t||(0,f.default)(o)};r.default=e,t.exports=r.default},{"./bytesToUuid.js":51,"./rng.js":54}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=o(e("./v35.js")),e=o(e("./md5.js"));function o(e){return e&&e.__esModule?e:{default:e}}e=(0,a.default)("v3",48,e.default);r.default=e,t.exports=r.default},{"./md5.js":53,"./v35.js":58}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,s,u){function t(e,t,r,a){var o,i=r&&a||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)),"string"==typeof t&&(o=[],t.replace(/[a-fA-F0-9]{2}/g,function(e){o.push(parseInt(e,16))}),t=o),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(t)||16!==t.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var n=u(t.concat(e));if(n[6]=15&n[6]|s,n[8]=63&n[8]|128,r)for(var l=0;l<16;++l)r[i+l]=n[l];return r||(0,c.default)(n)}try{t.name=e}catch(e){}return t.DNS=o,t.URL=i,t},r.URL=r.DNS=void 0;var a,c=(a=e("./bytesToUuid.js"))&&a.__esModule?a:{default:a};const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=o;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=i},{"./bytesToUuid.js":51}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./rng.js")),l=a(e("./bytesToUuid.js"));function a(e){return e&&e.__esModule?e:{default:e}}e=function(e,t,r){var a=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[a+i]=o[i];return t||(0,l.default)(o)};r.default=e,t.exports=r.default},{"./bytesToUuid.js":51,"./rng.js":54}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=o(e("./v35.js")),e=o(e("./sha1.js"));function o(e){return e&&e.__esModule?e:{default:e}}e=(0,a.default)("v5",80,e.default);r.default=e,t.exports=r.default},{"./sha1.js":55,"./v35.js":58}]},{},[48]);