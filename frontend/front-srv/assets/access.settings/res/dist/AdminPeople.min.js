!function o(a,i,n){function l(r,e){if(!i[r]){if(!a[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(s)return s(r,!0);t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}t=i[r]={exports:{}};a[r][0].call(t.exports,function(e){var t=a[r][1][e];return l(t||e)},t,t.exports,o,a,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,e=0;e<n.length;e++)l(n[e]);return l}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e){return e&&e.__esModule?e:{default:e}}var n=i(e("pydio")),l=i(e("pydio/http/api")),o=(o(s,null,[{key:"deleteAction",value:function(e,t){var o=void 0,t=(o=t&&t.length?t[0]:pydio.getUserSelection()).getUniqueNode(),r=void 0;switch(t.getMetadata().get("ajxp_mime")){case"user_editable":r="settings.34";break;case"group":r="settings.126"}var a,i=function(){};t.getParent()&&(a=t.getParent(),i=function(){a.reload(null,!0)});pydio.UI.openConfirmDialog({message:MessageHash[r],validCallback:function(){var r=o.getSelectedNodes();(function t(){var e;r.length&&(e=r.shift(),l.default.getRestClient().getIdmApi().deleteIdmUser(e.getMetadata().get("IdmUser")).then(function(){i(),t()}).catch(function(e){n.default.getInstance().UI.displayMessage("ERROR",e.message),t()}))})()}})}},{key:"applyDND",value:function(e,t){t.getStep()===PydioComponents.DNDActionParameter.STEP_CAN_DROP?AdminComponents.DNDActionsManager.canDropNodeOnNode(t.getSource(),t.getTarget()):t.getStep()===PydioComponents.DNDActionParameter.STEP_END_DRAG&&AdminComponents.DNDActionsManager.dropNodeOnNode(t.getSource(),t.getTarget())}},{key:"bulkMoveAction",value:function(e,t){var r=n.default.getInstance(),o=t[0].getSelectedNodes();r.UI.openComponentInModal("AdminPeople","TreeGroupsDialog",{pydio:r,dataModel:r.getContextHolder(),submitValue:function(e,r){(function e(){var t;o.length&&(t=o.shift(),AdminComponents.DNDActionsManager.dropNodeOnNode(t,r),e())})()}})}}]),s);function s(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s)}r.default=o,t.exports=r.default},{pydio:"pydio","pydio/http/api":"pydio/http/api"}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};function o(e){return e&&e.__esModule?e:{default:e}}var v=o(e("react")),a=o(e("create-react-class")),i=o(e("prop-types")),b=e("material-ui"),l=o(e("../editor/Editor")),n=o(e("pydio/model/data-model")),s=e("material-ui/styles"),P=o(e("./UsersSearchBox")),u=o(e("pydio/model/node")),c=o(e("./Callbacks")),d=o(e("pydio")),p=e("../editor/util/ClassLoader"),f=d.default.requireLib("boot").JobsStore,i=(0,a.default)({displayName:"Dashboard",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:i.default.instanceOf(n.default).isRequired,rootNode:i.default.instanceOf(u.default).isRequired,currentNode:i.default.instanceOf(u.default).isRequired,accessByName:i.default.func.isRequired,openEditor:i.default.func.isRequired},getInitialState:function(){var e=this.props;return{searchResultData:!1,currentNode:e.currentNode,dataModel:e.dataModel,showAnon:!1}},componentDidMount:function(){var r=this,e=f.getInstance();this._jStoreObserver=function(t){t&&0===t.indexOf("delete-group-")&&e.getJobs().then(function(e){try{"Finished"===e.get(t).Tasks[0].Status&&r.reloadList()}catch(e){}})},e.observe("tasks_updated",this._jStoreObserver)},componentWillUnmounnt:function(){f.getInstance().stopObserving("tasks_updated",this._jStoreObserver)},componentWillReceiveProps:function(e){!this.state.searchResultData&&e.currentNode&&0===e.currentNode.getPath().indexOf("/idm/users")&&this.setState({currentNode:e.currentNode,dataModel:e.dataModel})},reloadList:function(){this.refs.mainlist&&this.refs.mainlist.reload()},renderListUserAvatar:function(e){var t=e.getMetadata().get("IdmUser"),r=this.props.pydio;if(t.Attributes&&t.Attributes.avatar){t=r.Parameters.get("ENDPOINT_REST_API")+"/frontend/binaries/USER/"+t.Login+"?"+t.Attributes.avatar+"&dim=33";return v.default.createElement("div",{style:{width:33,height:33,backgroundImage:"url("+t+")",backgroundSize:"cover",borderRadius:"50%",backgroundPosition:"center",margin:16}})}e=e.isLeaf()?"mdi mdi-account":"mdi mdi-folder";return v.default.createElement(b.FontIcon,{className:e,style:{backgroundColor:"#9e9e9e",color:"white",borderRadius:"50%",margin:16,width:33,height:33,fontSize:18,padding:6,textAlign:"center"}})},renderListEntryFirstLine:function(e){var t=e.getMetadata().get("IdmUser"),r=t.Attributes?t.Attributes.profile:"",o=[],a={display:"inline-block",marginLeft:5,fontSize:14};return"shared"===r?o.push(v.default.createElement("span",{className:"mdi mdi-share-variant",style:g({},a,{color:"#009688"}),title:this.context.getMessage("user.13")})):"admin"===r&&o.push(v.default.createElement("span",{className:"mdi mdi-security",style:g({},a,{color:"#03a9f4"})})),t.Attributes&&t.Attributes.locks&&-1<t.Attributes.locks.indexOf("logout")&&o.push(v.default.createElement("span",{className:"mdi mdi-lock",style:g({},a,{color:"#E53934"})})),v.default.createElement("span",null,e.getLabel()," ",o)},renderListEntrySecondLine:function(e){var t=e.getMetadata().get("IdmUser");if(e.isLeaf()){if("/idm/users"===e.getPath())return this.context.getMessage("user.8");var r=[];r.push(t.Login);var o=t.Attributes||{};o.profile&&r.push("Profile "+o.profile),o.last_connection_readable&&r.push(this.context.getMessage("user.9")+" "+o.last_connection_readable);t=t.Roles;return t&&t.length&&r.push(this.context.getMessage("user.11").replace("%i",t.length)),r.join(" - ")}return this.context.getMessage("user.12")+": "+e.getPath().replace("/idm/users","")},renderListEntrySelector:function(e){return"/idm/users"!==e.getPath()&&e.isLeaf()},displaySearchResults:function(e,t){this.setState({searchResultTerm:e,searchResultData:{term:e,toggleState:this.hideSearchResults},currentNode:t.getContextNode(),dataModel:t})},hideSearchResults:function(){this.setState({searchResultData:!1,currentNode:this.props.currentNode,dataModel:this.props.dataModel})},createUserAction:function(){pydio.UI.openComponentInModal("AdminPeople","Forms.CreateUserForm",{dataModel:this.props.dataModel,openRoleEditor:this.openRoleEditor.bind(this)})},createGroupAction:function(){pydio.UI.openComponentInModal("AdminPeople","Forms.CreateRoleOrGroupForm",{type:"group",openRoleEditor:this.openRoleEditor.bind(this)})},openUsersImporter:function(){pydio.UI.openComponentInModal("EnterprisePeople","UsersImportDialog",{dataModel:this.props.dataModel})},openRoleEditor:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?"activity":arguments[1],o=this.props,a=o.pydio,i=o.rolesEditorClass,o=o.rolesEditorProps;if(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(a.MessageHash["role_editor.19"]))return!1;var n=g({ref:"editor",node:e,pydio:a,initialEditSection:r,onRequestTabClose:this.closeRoleEditor,afterSave:function(){t.reloadList()}},o);(0,p.loadEditorClass)(i,l.default).then(function(e){t.props.openRightPane({COMPONENT:e,PROPS:n})}).catch(function(e){console.log(e)})},closeRoleEditor:function(){if(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(this.props.pydio.MessageHash["role_editor.19"]))return!1;this.props.closeRightPane()},deleteAction:function(e){var t=new n.default;t.setSelectedNodes([e]),c.default.deleteAction(null,[t])},renderNodeActions:function(t){var r=this,e=t.getAjxpMime();if(t.getMetadata().has("IdmUser")&&!t.getMetadata().get("IdmUser").PoliciesContextEditable)return v.default.createElement("div",null);var o={color:"rgba(0,0,0,0.3)",fontSize:20},a=[];return"user_editable"===e||"group"===e?(a.push(v.default.createElement(b.IconButton,{key:"edit",iconClassName:"mdi mdi-pencil",onClick:function(e){e.stopPropagation(),r.openRoleEditor(t)},iconStyle:o})),a.push(v.default.createElement(b.IconButton,{key:"delete",iconClassName:"mdi mdi-delete",onClick:function(e){e.stopPropagation(),r.deleteAction(t)},iconStyle:o}))):"user"===e&&(a.push(v.default.createElement(b.IconButton,{key:"edit",iconClassName:"mdi mdi-pencil",onClick:function(e){e.stopPropagation(),r.openRoleEditor(t)},iconStyle:o})),a.push(v.default.createElement(b.IconButton,{key:"delete",iconClassName:"mdi mdi-delete",disabled:!0,iconStyle:{color:"rgba(0,0,0,0.15)",fontSize:20},onClick:function(e){e.stopPropagation()}}))),v.default.createElement("div",null,a)},filterNodes:function(e){if(!e.getMetadata().has("IdmUser"))return!0;var t=this.state,r=t.showAnon;return!(!t.displaySearchResult&&!r)||"anon"!==(e.getMetadata().get("IdmUser").Attributes||{}).profile},applyFilter:function(e){var t,r=this;"toggle-anon"!==e?((t=this.props.currentNode).getMetadata().set("userProfileFilter",e),t.getMetadata().delete("paginationData"),this.setState({currentNode:t},function(){r.reloadList()})):this.setState({showAnon:!this.state.showAnon})},render:function(){var r=this,e=this.props,t=e.accessByName,o=e.muiTheme,a=e.rootNode,i=e.pydio,n=AdminComponents.AdminStyles(o.palette),l=this.state,s=l.searchResultData,u=l.currentNode,c=l.dataModel,d=l.showAnon,p=v.default.createElement(P.default,{displayResults:this.displaySearchResults,displayResultsState:s,hideResults:this.hideSearchResults,limit:50,textLabel:this.context.getMessage("user.7"),className:"media-small-hide"}),f=[],m=function(){return[]},h=null,y=[];t("Create")&&(m=this.renderNodeActions.bind(this),y=[i.Controller.getActionByName("move"),i.Controller.getActionByName("delete")],h=this.openRoleEditor.bind(this),f=[v.default.createElement(b.FlatButton,g({primary:!0,label:this.context.getMessage("user.1"),onClick:this.createUserAction},n.props.header.flatButton)),v.default.createElement(b.FlatButton,g({primary:!0,label:this.context.getMessage("user.2"),onClick:this.createGroupAction},n.props.header.flatButton))]);e="",l=""===(e=u.getMetadata().has("userProfileFilter")?u.getMetadata().get("userProfileFilter"):e)?"rgba(0,0,0,0.4)":o.palette.accent1Color,t=v.default.createElement(b.IconMenu,{iconButtonElement:v.default.createElement(b.IconButton,{style:{marginRight:-16,marginLeft:8},iconStyle:{color:l},iconClassName:"mdi mdi-filter-variant",tooltip:this.context.getMessage("user.filter.tooltip"),tooltipPosition:"bottom-left"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},value:e,onChange:function(e,t){r.applyFilter(t)},desktop:!0},v.default.createElement(b.MenuItem,{value:"",primaryText:this.context.getMessage("user.filter.all")}),v.default.createElement(b.MenuItem,{value:"!shared",primaryText:this.context.getMessage("user.filter.internal")}),v.default.createElement(b.MenuItem,{value:"shared",primaryText:this.context.getMessage("user.filter.shared")}),v.default.createElement(b.MenuItem,{value:"admin",primaryText:this.context.getMessage("user.filter.admins")}),v.default.createElement(b.Divider,null),v.default.createElement(b.MenuItem,{value:"toggle-anon",primaryText:this.context.getMessage("user.filter.anon"),secondaryText:d?v.default.createElement(b.FontIcon,{className:"mdi mdi-check"}):null})),n=AdminComponents.AdminStyles().body,o=n.block.props,l=n.block.container,e=g({height:48,lineHeight:"48px",fontSize:12,fontWeight:500},n.block.header,{borderBottom:"1px solid "+n.tableMaster.row.borderBottomColor,padding:"0 20px"}),d={width:226,borderRight:"1px solid"+n.tableMaster.row.borderBottomColor,overflowY:"auto",flex:"none"};return!1!==s&&(d=g({},d,{opacity:.6})),v.default.createElement("div",{className:"main-layout-nav-to-stack vertical-layout people-dashboard"},v.default.createElement(AdminComponents.Header,{title:this.context.getMessage("2","settings"),icon:"mdi mdi-account-multiple",actions:f,centerContent:p}),v.default.createElement(b.Paper,g({},o,{style:l,className:"horizontal-layout layout-fill"}),v.default.createElement("div",{className:"hide-on-vertical-layout vertical-layout tab-vertical-layout",style:d},v.default.createElement("div",{style:{flex:1}},v.default.createElement("div",{style:e},this.context.getMessage("user.3")),v.default.createElement(PydioComponents.DNDTreeView,{showRoot:!0,rootLabel:this.context.getMessage("user.5"),node:a,dataModel:this.props.dataModel,className:"users-groups-tree",paddingOffset:10,noPaginator:!0}))),v.default.createElement("div",{zDepth:0,className:"layout-fill vertical-layout people-list"},v.default.createElement(PydioComponents.SimpleList,{ref:"mainlist",pydio:i,node:u,dataModel:c,clearSelectionOnReload:!1,openEditor:h,entryRenderIcon:this.renderListUserAvatar.bind(this),entryRenderFirstLine:this.renderListEntryFirstLine.bind(this),entryRenderSecondLine:this.renderListEntrySecondLine.bind(this),entryEnableSelector:this.renderListEntrySelector.bind(this),entryRenderActions:m,searchResultData:s,elementHeight:PydioComponents.SimpleList.HEIGHT_TWO_LINES,hideToolbar:!1,toolbarStyle:{backgroundColor:n.block.header.backgroundColor,height:48,borderBottom:e.borderBottom},multipleActions:y,additionalActions:t,filterNodes:this.filterNodes.bind(this)}))))}});r.default=i=(0,s.muiThemeable)()(i),r.default=i,t.exports=r.default},{"../editor/Editor":12,"../editor/util/ClassLoader":44,"./Callbacks":1,"./UsersSearchBox":5,"create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node",react:"react"}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};function o(e){return e&&e.__esModule?e:{default:e}}var a=o(e("prop-types")),i=o(e("pydio")),m=o(e("react")),n=o(e("create-react-class")),l=o(e("pydio/model/data-model")),s=o(e("pydio/model/node")),u=o(e("pydio/http/resources-manager")),h=e("material-ui"),c=e("cells-sdk"),d=o(e("pydio/http/api")),p=e("material-ui/styles"),y=e("uuid"),g=o(e("../policies/Policy")),v=i.default.requireLib("components").MaterialTable,b=["acl","rest","oidc"],a=(0,n.default)({displayName:"PoliciesBoard",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:a.default.instanceOf(l.default).isRequired,rootNode:a.default.instanceOf(s.default).isRequired,currentNode:a.default.instanceOf(s.default).isRequired,openEditor:a.default.func.isRequired,openRightPane:a.default.func.isRequired,closeRightPane:a.default.func.isRequired,readonly:a.default.bool},componentWillMount:function(){this.listPolicies()},getInitialState:function(){return{policies:{},popoverOpen:!1,anchorEl:null}},groupByResourcesGroups:function(r){var o=[];return b.map(function(t){var e=r.PolicyGroups.filter(function(e){return(e.ResourceGroup||"rest")===t});e.length&&(e.sort(function(e,t){return e.Name.toLowerCase()<t.Name.toLowerCase()?-1:e.Name.toLowerCase()===t.Name.toLowerCase()?0:1}),o[t]=e)}),o},listPolicies:function(){var t=this;this.setState({loading:!0});var e=new c.PolicyServiceApi(d.default.getRestClient());i.default.startLoading(),e.listPolicies(new c.IdmListPolicyGroupsRequest).then(function(e){i.default.endLoading();e=t.groupByResourcesGroups(e);t.setState({policies:e,loading:!1})}).catch(function(e){i.default.endLoading(),t.setState({error:e,loading:!1})})},savePolicy:function(t,e){var r=this;e?this.listPolicies():u.default.loadClass("EnterpriseSDK").then(function(e){new e.EnterprisePolicyServiceApi(d.default.getRestClient()).putPolicy(t).then(function(){r.listPolicies()}).catch(function(e){r.setState({error:e})})})},deletePolicy:function(t){var r=this,e=this.props.pydio;e.UI.openConfirmDialog({message:e.MessageHash["ajxp_admin.policies.policy.delete.confirm"],destructive:[t.Name],validCallback:function(){u.default.loadClass("EnterpriseSDK").then(function(e){new e.EnterprisePolicyServiceApi(d.default.getRestClient()).deletePolicy(t.Uuid).then(function(){r.listPolicies()}).catch(function(e){r.setState({error:e})})})}})},createPolicy:function(e){var t=this.refs,r=t.newPolicyName,o=t.newPolicyDescription,a=this.state.newPolicyType,t=(0,y.v4)(),r={Uuid:t,Name:r.getValue(),Description:o.getValue(),ResourceGroup:a,Policies:[]},o=f({},this.state.policies);o[a]||(o[a]=[]),o[a].push(r),this.setState({policies:o,popoverOpen:!1,newPolicyId:t,selectedPolicy:t})},openPopover:function(e){var t=this;e.preventDefault(),this.setState({newPolicyType:"acl",popoverOpen:!0,anchorEl:e.currentTarget},function(){setTimeout(function(){t.refs.newPolicyName.focus()},200)})},handleRequestClose:function(){this.setState({popoverOpen:!1})},handleChangePolicyType:function(e,t,r){this.setState({newPolicyType:r})},selectRows:function(e){var t;e.length&&(t=e[0],e=this.state.selectedPolicy,this.setState({selectedPolicy:e===t.Uuid?null:t.Uuid}))},render:function(){function a(e){return o.MessageHash["ajxp_admin.policies."+e]||e}var i=this,e=this.props,t=e.muiTheme,r=e.currentNode,o=e.pydio,e=e.accessByName,n=(n=this.props.readonly)||!e("Create"),e=this.state,l=e.policies,s=e.selectedPolicy,u=e.newPolicyId,c=AdminComponents.AdminStyles(t.palette),d=[{name:"Name",label:a("policy.name"),style:{fontSize:15},sorter:{type:"string",default:!0}},{name:"Rules",label:a("policy.rules"),style:{width:80,textAlign:"center"},headerStyle:{width:80,textAlign:"center"},renderCell:function(e){return e.Policies.length},sorter:{type:"number"}},{name:"Description",label:a("policy.description"),sorter:{type:"string"}}],p=[];n?p.push({iconClassName:"mdi mdi-eye",tooltip:a("policy.display"),onClick:function(e){return i.setState({selectedPolicy:s===e.Uuid?null:e.Uuid})}}):(p.push({iconClassName:"mdi mdi-pencil",tooltip:a("policy.edit"),onClick:function(e){return i.setState({selectedPolicy:s===e.Uuid?null:e.Uuid})}}),p.push({iconClassName:"mdi mdi-delete",tooltip:a("policy.delete"),onClick:function(e){i.deletePolicy(e)}}));e=Object.keys(l).map(function(e){if(n&&"acl"===e)return null;var t=l[e].map(function(e){return e.Uuid===s?f({},e,{expandedRow:m.default.createElement(g.default,f({},i.props,{readonly:n,key:e.Name,policy:e,savePolicy:i.savePolicy.bind(i),deletePolicy:i.deletePolicy.bind(i),newPolicyWithRule:u===e.Uuid?e.Name:null}))}):e}),r=a("type."+e+".title"),o=a("type."+e+".legend");return m.default.createElement("div",null,m.default.createElement(AdminComponents.SubHeader,{title:r,legend:o}),m.default.createElement(h.Paper,f({},c.body.block.props,{style:c.body.block.container}),m.default.createElement(v,{data:t,columns:d,actions:p,onSelectRows:function(e){return i.selectRows(e)},deselectOnClickAway:!0,showCheckboxes:!1,masterStyles:c.body.tableMaster,storageKey:"console.policies."+e+".list"})))}),t=m.default.createElement("div",null,m.default.createElement(h.FlatButton,f({},c.props.header.flatButton,{primary:!0,onClick:this.openPopover.bind(this),label:a("policy.new")})),m.default.createElement(h.Popover,{open:this.state.popoverOpen,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},m.default.createElement("div",null,m.default.createElement("div",{style:{padding:"0 12px"}},m.default.createElement(h.TextField,{floatingLabelText:a("policy.name"),ref:"newPolicyName"}),m.default.createElement("br",null),m.default.createElement(h.TextField,{floatingLabelText:a("policy.description"),ref:"newPolicyDescription"}),m.default.createElement("br",null),m.default.createElement(h.SelectField,{floatingLabelText:a("policy.type"),ref:"newPolicyType",value:this.state.newPolicyType||"rest",onChange:this.handleChangePolicyType.bind(this)},b.map(function(e){return m.default.createElement(h.MenuItem,{value:e,primaryText:a("type."+e+".title")})}))),m.default.createElement(h.Divider,null),m.default.createElement("div",{style:{textAlign:"right",padding:"6px 12px"}},m.default.createElement(h.FlatButton,{label:o.MessageHash[54],onClick:this.handleRequestClose.bind(this)}),m.default.createElement(h.FlatButton,{label:a("policy.create"),onClick:this.createPolicy.bind(this)})))));return m.default.createElement("div",{className:"vertical-layout",style:{height:"100%"}},m.default.createElement(AdminComponents.Header,{title:r.getLabel(),icon:r.getMetadata().get("icon_class"),actions:n?null:t,reloadAction:this.listPolicies.bind(this),loading:this.state.loading}),m.default.createElement("div",{className:"layout-fill"},e))}});r.default=a=(0,p.muiThemeable)()(a),r.default=a,t.exports=r.default},{"../policies/Policy":50,"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node",react:"react",uuid:53}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};function o(e){return e&&e.__esModule?e:{default:e}}var p=o(e("react")),a=o(e("create-react-class")),f=e("material-ui"),l=o(e("../editor/Editor")),i=o(e("pydio/http/api")),n=o(e("pydio")),s=e("../editor/util/ClassLoader"),e=e("material-ui/styles").muiThemeable,m=n.default.requireLib("components").MaterialTable,h=n.default.requireLib("hoc").ModernTextField,a=(0,a.default)({displayName:"RolesDashboard",mixins:[AdminComponents.MessagesConsumerMixin],getInitialState:function(){return{roles:[],loading:!1,showTechnical:!1}},load:function(){var t=this,e=this.state.showTechnical;this.setState({loading:!0}),n.default.startLoading(),i.default.getRestClient().getIdmApi().listRoles(e,0,1e3).then(function(e){n.default.endLoading(),t.setState({roles:e,loading:!1})}).catch(function(e){n.default.endLoading(),t.setState({loading:!1})})},componentDidMount:function(){this.load()},openTableRows:function(e){e.length&&e[0].role.PoliciesContextEditable&&this.openRoleEditor(e[0].role)},openRoleEditor:function(t){var r=this,o=arguments.length<=1||void 0===arguments[1]?"activity":arguments[1],e=this.props,a=e.pydio,i=e.rolesEditorClass,n=e.rolesEditorProps;return!(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(a.MessageHash["role_editor.19"]))&&((0,s.loadEditorClass)(i,l.default).then(function(e){r.props.openRightPane({COMPONENT:e,PROPS:d({ref:"editor",idmRole:t,pydio:a,initialEditSection:o,onRequestTabClose:r.closeRoleEditor},n)})}).catch(function(e){console.log(e)}),!0)},closeRoleEditor:function(){return!(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(this.props.pydio.MessageHash["role_editor.19"]))&&(this.props.closeRightPane(),!0)},deleteAction:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1],o=this.props.pydio;o.UI.openConfirmDialog({message:o.MessageHash["settings.126"],destructive:[r||e],validCallback:function(){i.default.getRestClient().getIdmApi().deleteRole(e).then(function(){t.load()})}})},createRoleAction:function(){var e=this;pydio.UI.openComponentInModal("AdminPeople","Forms.CreateRoleOrGroupForm",{type:"role",roleNode:this.state.currentNode,openRoleEditor:this.openRoleEditor.bind(this),roles:this.state.roles,reload:function(){e.load()}})},computeTableData:function(r){var e=this.state.roles,o=[];return e.map(function(e){var t=e.Label;r&&-1===t.toLowerCase().indexOf(r.toLowerCase())||o.push({role:e,roleId:e.Uuid,roleLabel:t,isDefault:e.AutoApplies.join(", ")||"-",lastUpdated:e.LastUpdated})}),o},render:function(){var r=this,e=this.props,t=e.muiTheme,o=e.accessByName,a=AdminComponents.AdminStyles(t.palette),i=this.state,n=i.searchRoleString,l=i.showTechnical,s=o("Create"),u=null,c=[];s&&(c.push(p.default.createElement(f.FlatButton,d({},a.props.header.flatButton,{primary:!0,label:this.context.getMessage("user.6"),onClick:this.createRoleAction.bind(this)}))),u=this.openTableRows.bind(this)),c.push(p.default.createElement(f.IconMenu,{iconButtonElement:p.default.createElement(f.IconButton,d({iconClassName:"mdi mdi-filter-variant"},a.props.header.iconButton)),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onChange:function(){r.setState({showTechnical:!l},function(){r.load()})}},p.default.createElement(f.MenuItem,{primaryText:this.context.getMessage("dashboard.technical.show","role_editor"),value:"show",rightIcon:l?p.default.createElement(f.FontIcon,{className:"mdi mdi-check"}):null}),p.default.createElement(f.MenuItem,{primaryText:this.context.getMessage("dashboard.technical.hide","role_editor"),value:"hide",rightIcon:l?null:p.default.createElement(f.FontIcon,{className:"mdi mdi-check"})})));e=p.default.createElement("div",{style:{display:"flex"}},p.default.createElement("div",{style:{flex:1}}),p.default.createElement("div",{style:{width:190}},p.default.createElement(h,{fullWidth:!0,hintText:this.context.getMessage("47","role_editor")+"...",value:n||"",onChange:function(e,t){return r.setState({searchRoleString:t})}}))),t=[{name:"roleLabel",label:this.context.getMessage("32","role_editor"),style:{width:"35%",fontSize:15},headerStyle:{width:"35%"},sorter:{type:"string",default:!0}},{name:"lastUpdated",useMoment:!0,label:this.context.getMessage("last_update","role_editor"),hideSmall:!0,sorter:{type:"number"}},{name:"isDefault",label:this.context.getMessage("114","settings"),style:{width:"20%"},headerStyle:{width:"20%"},hideSmall:!0,sorter:{type:"string"}}],i=[];s&&(i.push({iconClassName:"mdi mdi-pencil",tooltip:"Edit",onClick:function(e){r.openRoleEditor(e.role)},disable:function(e){return!e.role.PoliciesContextEditable}}),i.push({iconClassName:"mdi mdi-delete",tooltip:"Delete",onClick:function(e){r.deleteAction(e.role.Uuid,e.role.Label)},disable:function(e){return!e.role.PoliciesContextEditable}}));o=this.computeTableData(n),a=AdminComponents.AdminStyles().body,s=a.tableMaster,n=a.block.props,a=a.block.container;return p.default.createElement("div",{className:"main-layout-nav-to-stack vertical-layout"},p.default.createElement(AdminComponents.Header,{title:this.context.getMessage("69","settings"),icon:"mdi mdi-account-multiple",actions:c,centerContent:e,reloadAction:function(){r.load()},loading:this.state.loading}),p.default.createElement("div",{className:"layout-fill"},p.default.createElement(AdminComponents.SubHeader,{legend:this.context.getMessage("dashboard.description","role_editor")}),p.default.createElement(f.Paper,d({},n,{style:a}),p.default.createElement(m,{data:o,columns:t,actions:i,onSelectRows:u,deselectOnClickAway:!0,showCheckboxes:!1,masterStyles:s,paginate:[10,25,50,100],storageKey:"console.roles.list"}))))}});r.default=a=e()(a),r.default=a,t.exports=r.default},{"../editor/Editor":12,"../editor/util/ClassLoader":44,"create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},a=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var s=l(e("prop-types")),u=l(e("pydio")),c=l(e("react")),d=(e("material-ui"),l(e("lodash.debounce"))),p=l(e("pydio/http/api")),f=l(e("pydio/model/data-model")),m=l(e("pydio/model/node")),h=l(e("pydio/util/lang")),y=u.default.requireLib("hoc").ModernTextField,a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(g,c["default"].Component),a(g,[{key:"displayResultsState",value:function(){this.setState({displayResult:!0})}},{key:"hideResultsState",value:function(){this.setState({displayResult:!1}),this.props.hideResults()}},{key:"triggerSearch",value:function(){var r=this,o=this.state.crtValue;if(o){var a=this.state.dataModel,e=this.props.limit||100;a.getRootNode().setChildren([]);var t=p.default.getRestClient().getIdmApi().listGroups("/",o,!0,0,e),e=p.default.getRestClient().getIdmApi().listUsers("/",o,!0,0,e);Promise.all([t,e]).then(function(e){var t=e[0],e=e[1];t.Groups.map(function(e){var t=e.Attributes&&e.Attributes.displayName?e.Attributes.displayName:e.GroupLabel,t=new m.default("/idm/users"+h.default.trimRight(e.GroupPath,"/")+"/"+e.GroupLabel,!1,t);t.getMetadata().set("IdmUser",e),t.getMetadata().set("ajxp_mime","group"),a.getRootNode().addChild(t)}),e.Users.map(function(e){var t=e.Attributes&&e.Attributes.displayName?e.Attributes.displayName:e.Login,t=new m.default("/idm/users"+e.Login,!0,t);t.getMetadata().set("IdmUser",e),t.getMetadata().set("ajxp_mime","user_editable"),a.getRootNode().addChild(t)}),a.getRootNode().setLoaded(!0),r.displayResultsState(),r.props.displayResults(o,a)})}else{this.hideResultsState();try{this.refs.query.refs.input.blur()}catch(e){}}}},{key:"keyDown",value:function(e){"Enter"===e.key?(e.preventDefault(),this.triggerSearch()):this.searchDebounced()}},{key:"render",value:function(){var r=this,e=this.state.crtValue;return c.default.createElement("div",{className:this.props.className||"",style:o({display:"flex",alignItems:"center"},this.props.style)},c.default.createElement("div",{style:{flex:1}}),c.default.createElement("div",{style:{maxWidth:190}},c.default.createElement("form",{autoComplete:"off"},c.default.createElement(y,{ref:"query",onKeyDown:this.keyDown.bind(this),hintText:this.props.textLabel,fullWidth:!0,value:e,onChange:function(e,t){r.setState({crtValue:t})}}))))}}]),g);function g(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),n(Object.getPrototypeOf(g.prototype),"constructor",this).call(this,e);var t=new f.default;t.setRootNode(new m.default),this.state={dataModel:t,displayResult:e.displayResultsState,crtValue:""},this.searchDebounced=(0,d.default)(this.triggerSearch,350)}a.PropTypes={textLabel:s.default.string,displayResults:s.default.func,hideResults:s.default.func,displayResultsState:s.default.bool,limit:s.default.number,style:s.default.object},r.default=a,t.exports=r.default},{"lodash.debounce":"lodash.debounce","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node","pydio/util/lang":"pydio/util/lang",react:"react"}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("pydio/util/lang")),u=e("cells-sdk"),c=n(e("./WorkspaceAcl")),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),o(d,[{key:"render",value:function(){var t=this.props.role,e=this.state.workspaces;return t?l.default.createElement("div",{style:{backgroundColor:"white"},className:"material-list"},e.map(function(e){return l.default.createElement(c.default,{workspace:e,role:t})})):l.default.createElement("div",null)}}]),d);function d(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,t);function e(e){return t.pydio.MessageHash["pydio_role."+e]||e}var r=[],o=new u.IdmWorkspace;o.UUID="homepage",o.Label=e("workspace.statics.home.title"),o.Description=e("workspace.statics.home.description"),o.Slug="homepage",o.RootNodes={"homepage-ROOT":u.TreeNode.constructFromObject({Uuid:"homepage-ROOT"})},r.push(o),t.showSettings&&((o=new u.IdmWorkspace).UUID="settings",o.Label=e("workspace.statics.settings.title"),o.Description=e("workspace.statics.settings.description"),o.Slug="settings",o.RootNodes={"settings-ROOT":u.TreeNode.constructFromObject({Uuid:"settings-ROOT"})},r.push(o)),r.sort(s.default.arraySorter("Label",!1,!0)),this.state={workspaces:r}}r.default=o,t.exports=r.default},{"./WorkspaceAcl":9,"cells-sdk":"cells-sdk","pydio/util/lang":"pydio/util/lang",react:"react"}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};var n,l=e("react"),s=(n=l)&&n.__esModule?n:{default:n},u=e("material-ui"),e=e("../util/MessagesMixin"),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,s["default"].Component),o(c,[{key:"componentWillReceiveProps",value:function(e){this.setState({acl:e.acl})}},{key:"getAcl",value:function(){return this.state.acl}},{key:"updateAcl",value:function(){var e,t,r,o,a;this.props.disabled||(t=!(e=this.refs.deny.isChecked())&&this.refs.read.isChecked(),r=!e&&this.refs.write.isChecked(),o=void 0,a=[],e?a.push("deny"):(t&&a.push("read"),r&&a.push("write")),o=a.join(","),this.props.onChange&&this.props.onChange(o,this.props.acl),this.setState({acl:o}))}},{key:"handleChangePolicy",value:function(e,t){t="policy:"+t;this.props.onChange?this.props.onChange(t,this.props.acl):this.setState({acl:t})}},{key:"render",value:function(){var e=this.props,t=e.hideDeny,r=e.hideLabels,o=e.disabled,a=e.getMessage,i=this.state.acl||"";if(i.startsWith("policy:"))return s.default.createElement("div",{style:{display:"flex",alignItems:"center",width:132,height:40}},"Custom policy");e={width:44};return s.default.createElement("div",{style:{display:"flex",alignItems:"center",width:132,height:40}},s.default.createElement(u.Checkbox,{ref:"read",label:r?"":a("react.5a","ajxp_admin"),value:"read",onCheck:this.updateAcl.bind(this),disabled:o||-1<i.indexOf("deny"),checked:-1===i.indexOf("deny")&&-1!==i.indexOf("read"),style:e}),s.default.createElement(u.Checkbox,{ref:"write",label:r?"":a("react.5b","ajxp_admin"),value:"write",onCheck:this.updateAcl.bind(this),disabled:o||-1<i.indexOf("deny"),checked:-1===i.indexOf("deny")&&-1!==i.indexOf("write"),style:e}),!t&&s.default.createElement(u.Checkbox,{ref:"deny",label:r?"":a("react.5","ajxp_admin"),value:"-",disabled:o,onCheck:this.updateAcl.bind(this),checked:-1!==i.indexOf("deny"),style:e}))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,e),this.state={acl:e.acl}}r.default=(0,e.withRoleMessages)(o),t.exports=r.default},{"../util/MessagesMixin":45,"material-ui":"material-ui",react:"react"}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};var n,l=e("react"),s=(n=l)&&n.__esModule?n:{default:n},e=e("../util/MessagesMixin"),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,s["default"].Component),o(u,[{key:"render",value:function(){var e=this.props.getMessage,t=void 0;switch(this.props.acl){case"read,write":t=e("8");break;case"read":t=e("9");break;case"write":t=e("10");break;case"PYDIO_VALUE_CLEAR":t=e("11");break;default:t=e("12")}return s.default.createElement("span",{className:"summary-rights summary"},t)}}]),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,arguments)}r.default=(0,e.withRoleMessages)(o),t.exports=r.default},{"../util/MessagesMixin":45,react:"react"}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=e("../util/MessagesMixin"),u=n(e("./RightsSelector")),o=(e("cells-sdk"),e("material-ui"),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l["default"].Component),o(c,[{key:"onAclChange",value:function(e,t){var r=this.props,o=r.role,r=r.workspace;o.updateAcl(r,null,e)}},{key:"render",value:function(){var e=this.props,t=e.workspace,r=e.role,o=e.getPydioRoleMessage;if(!t.RootNodes||!Object.keys(t.RootNodes).length)return l.default.createElement(PydioComponents.ListEntry,{className:"workspace-acl-entry",firstLine:l.default.createElement("span",{style:{textDecoration:"line-through",color:"#ef9a9a"}},t.Label+" ("+o("workspace.roots.invalid")+")")});e=r.getAclString(t),r=e.aclString,e=e.inherited,r=l.default.createElement(u.default,{acl:r,onChange:this.onAclChange.bind(this),hideLabels:!0}),o=t.Label+(e?" ("+o("38")+")":"");return l.default.createElement(PydioComponents.ListEntry,{className:(e?"workspace-acl-entry-inherited ":"")+"workspace-acl-entry",firstLine:o,actions:r})}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i(Object.getPrototypeOf(c.prototype),"constructor",this).apply(this,arguments)}r.default=(0,s.withRoleMessages)(o),t.exports=r.default},{"../util/MessagesMixin":45,"./RightsSelector":7,"cells-sdk":"cells-sdk","material-ui":"material-ui",react:"react"}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("pydio/http/api")),u=n(e("pydio/util/lang")),c=e("cells-sdk"),d=n(e("./WorkspaceAcl")),p=n(e("pydio")),f=p.default.requireLib("components").MaterialTable,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,l["default"].Component),o(m,[{key:"render",value:function(){var e=this.props,t=e.role,r=e.advancedAcl,o=this.state,a=o.workspaces,e=o.loading;if(!t)return l.default.createElement("div",null);o=[{name:"acl",label:"",style:{paddingLeft:0,paddingRight:0},renderCell:function(e){return l.default.createElement(d.default,{workspace:e,role:t,advancedAcl:r})}}];return l.default.createElement("div",{className:"material-list"},l.default.createElement(f,{data:a,columns:o,hideHeaders:!0,paginate:[10,25,50,100],defaultPageSize:25,showCheckboxes:!1,emptyStateString:e?p.default.getInstance().MessageHash["ajxp_admin.loading"]:""}))}}]),m);function m(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),i(Object.getPrototypeOf(m.prototype),"constructor",this).call(this,e),this.state={loading:!0,workspaces:[]};var r=new c.WorkspaceServiceApi(s.default.getRestClient()),e=new c.RestSearchWorkspaceRequest;e.Queries=[c.IdmWorkspaceSingleQuery.constructFromObject({scope:"ADMIN"})],r.searchWorkspaces(e).then(function(e){e=e.Workspaces||[];e.sort(u.default.arraySorter("Label",!1,!0)),t.setState({workspaces:e,loading:!1})}).catch(function(e){t.setState({loading:!1})})}r.default=o,t.exports=r.default},{"./WorkspaceAcl":9,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang",react:"react"}],11:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("./PagesAcls")),i=o(e("./RightsSelector")),n=o(e("./RightsSummary")),l=o(e("./WorkspaceAcl")),e=o(e("./WorkspacesAcls")),l={PagesAcls:a.default,RightsSelector:i.default,RightsSummary:n.default,WorkspacesAcls:e.default,WorkspaceAcl:l.default};r.default=l,t.exports=r.default},{"./PagesAcls":6,"./RightsSelector":7,"./RightsSummary":8,"./WorkspaceAcl":9,"./WorkspacesAcls":10}],12:[function(m,h,y){!function(t){"use strict";Object.defineProperty(y,"__esModule",{value:!0});var e=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function r(e){return e&&e.__esModule?e:{default:e}}var i=r(m("prop-types")),n=r(m("pydio")),l=r(m("./model/Role")),s=r(m("./model/User")),g=r(m("./acl/WorkspacesAcls")),v=r(m("./acl/PagesAcls")),b=r(m("react")),u=r(m("pydio/util/path")),P=m("material-ui"),c=m("material-ui/styles"),O=r(m("./info/RoleInfo")),E=r(m("./info/UserInfo")),M=r(m("./info/GroupInfo")),R=r(m("./params/ParametersPanel")),d=AdminComponents,k=d.PaperEditorLayout,p=(d.PaperEditorNavEntry,d.PaperEditorNavHeader,d.PluginsLoader),x=d.AdminStyles,e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,b["default"].Component),e(f,[{key:"componentWillReceiveProps",value:function(e){var t=this,r=this.props,o=r.node,r=r.idmRole;e.node===o&&e.idmRole===r||(e.node?this.setState(this.nodeToState(e.node)):e.idmRole&&this.setState({idmRole:e.idmRole,roleType:"role",currentPane:"info"},function(){t.loadRoleData(!0)}))}},{key:"nodeToState",value:function(e){var t=this,r="group"===e.getAjxpMime()?"group":"user",o=void 0,a=e.getMetadata().get("IdmUser");return(o=new s.default(a)).observe("update",function(){t.forceUpdate()}),o.load(),{observableUser:o,roleLabel:u.default.getBasename(e.getPath()),roleType:r,dirty:!1,currentPane:"info",localModalContent:{}}}},{key:"loadRoleData",value:function(e){var t=this;e&&this.setState({loadingMessage:this.getMessage("loading","ajxp_admin")});var e=this.state.idmRole,r=new l.default(e);r.load().then(function(){t.setState({loadingMessage:null,observableRole:r}),r.observe("update",function(){t.forceUpdate()})})}},{key:"getChildContext",value:function(){var r=this.context.pydio.MessageHash;return{messages:r,getMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r[t+(t?".":"")+e]||e},getPydioRoleMessage:function(e){return r["role_editor."+e]||e},getRootMessage:function(e){return r[e]||e}}}},{key:"getMessage",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return this.getChildContext().getMessage(e,t)}},{key:"getPydioRoleMessage",value:function(e){return this.getChildContext().getMessage(e,"role_editor")}},{key:"getRootMessage",value:function(e){return this.getChildContext().getMessage(e,"")}},{key:"setSelectedPane",value:function(e){this.setState({currentPane:e})}},{key:"componentDidMount",value:function(){var e=this;this.loadRoleData(!0),this.props.registerCloseCallback&&this.props.registerCloseCallback(function(){if(e.state&&e.state.dirty&&!t.confirm(e.getPydioRoleMessage("19")))return!1})}},{key:"showModal",value:function(e){this.setState({modal:e})}},{key:"hideModal",value:function(){this.setState({modal:null})}},{key:"logAction",value:function(e){this.setState({snackbar:e,snackOpen:!0})}},{key:"hideSnackBar",value:function(){this.setState({snackOpen:!1})}},{key:"render",value:function(){var t=this,e=this.props,r=e.advancedAcl,o=e.pydio,a=e.muiTheme,i=this.state,n=i.observableRole,l=i.observableUser,s=i.pluginsRegistry,u=i.currentPane,c=i.modal,d="",p="",f=this.getMessage("24"),m=void 0,h=!1;"user"===this.state.roleType?(d=(y=l.getIdmUser()).Attributes&&y.Attributes.displayName?y.Attributes.displayName:y.Login,h="admin"===y.Attributes.profile,m=b.default.createElement(E.default,{user:l,pydio:o,pluginsRegistry:s})):"group"===this.state.roleType?(p=this.getMessage("26"),f=this.getMessage("27"),d=l.getIdmUser().GroupLabel,l.getIdmUser().Attributes&&l.getIdmUser().Attributes.displayName&&(d=l.getIdmUser().Attributes.displayName),m=b.default.createElement(M.default,{group:l,pydio:o,pluginsRegistry:s})):"role"===this.state.roleType&&(d=n?n.getIdmRole().Label:"...",p=this.getMessage("28"),f=this.getMessage("29"),h=!0,m=b.default.createElement(O.default,{role:n,pydio:o,pluginsRegistry:s}));var e=!0,i=function(){},y=function(){};l?(e=!l.isDirty(),i=function(){l.save().then(t.props.afterSave)},y=function(){l.revert()}):n&&(e=!n.isDirty(),i=function(){n.save(t.props.afterSave)},y=function(){n.revert()});s=[k.actionButton(this.getMessage("plugins.6","ajxp_admin"),"mdi mdi-undo",y,e),k.actionButton(this.getRootMessage("53"),"mdi mdi-content-save",i,e)],y=[{value:"info",label:f},{value:"workspaces",label:this.getMessage("35")},{value:"pages",label:this.getMessage("36")},{value:"params",label:this.getMessage("38")}],i=[],e=function(e){return u===e?"layout-fill":""},f=function(e){return u===e?{overflow:"auto"}:{height:0,overflow:"hidden"}};i.push(b.default.createElement("div",{key:"info",className:"avatar-provider "+e("info"),style:f("info")},p&&!this.state.loadingMessage?b.default.createElement("h3",{className:"paper-right-title"},p):null,m)),"workspaces"===u?i.push(b.default.createElement("div",{key:"workspaces",className:e("workspaces"),style:f("workspaces")},b.default.createElement("h3",{className:"paper-right-title"},this.getRootMessage("250"),b.default.createElement("div",{className:"section-legend"},this.getMessage("43")),b.default.createElement("div",{className:"read-write-header"},b.default.createElement("span",{className:"header-read"},this.getMessage("react.5a","ajxp_admin")),b.default.createElement("span",{className:"header-write"},this.getMessage("react.5b","ajxp_admin")),b.default.createElement("span",{className:"header-deny"},this.getMessage("react.5","ajxp_admin"))),b.default.createElement("br",null)),b.default.createElement(g.default,{key:"workspaces-list",role:l?l.getRole():n,roleType:this.state.roleType,advancedAcl:r,showModal:this.showModal.bind(this),hideModal:this.hideModal.bind(this)}))):"pages"===u?i.push(b.default.createElement("div",{key:"pages",className:e("pages"),style:f("pages")},b.default.createElement("h3",{className:"paper-right-title"},this.getMessage("44"),b.default.createElement("div",{className:"section-legend"},this.getMessage("45")),b.default.createElement("div",{className:"read-write-header"},b.default.createElement("span",{className:"header-read"},this.getMessage("react.5a","ajxp_admin")),b.default.createElement("span",{className:"header-write"},this.getMessage("react.5b","ajxp_admin")),b.default.createElement("span",{className:"header-deny"},this.getMessage("react.5","ajxp_admin"))),b.default.createElement("br",null)),b.default.createElement(v.default,{key:"pages-list",role:l?l.getRole():n,roleType:this.state.roleType,advancedAcl:r,showModal:this.showModal.bind(this),hideModal:this.hideModal.bind(this),showSettings:h,pydio:o}))):"params"===u&&i.push(b.default.createElement("div",{key:"params",className:e("params"),style:f("params")},b.default.createElement(R.default,{pydio:o,role:l?l.getRole():n,roleType:this.state.roleType})));o=null;return this.state.loadingMessage&&(o=b.default.createElement("div",{className:"loader-container layout-fill vertical-layout"},b.default.createElement("div",{className:"loader-message",style:{margin:"auto",color:"rgba(0,0,0,0.33)",fontWeight:"500",fontSize:16}},this.state.loadingMessage))),b.default.createElement(k,{title:d,titleLeftIcon:"mdi mdi-account",titleActionBar:s,closeAction:function(){t.props.onRequestTabClose()},contentFill:!0,leftNavItems:y,leftNavSelected:u,leftNavChange:function(e){t.setSelectedPane(e)},className:"edit-object-"+this.state.roleType},b.default.createElement(P.Snackbar,{message:this.state.snackbar||"",open:this.state.snackOpen,autoHideDuration:4e3,ref:"snack",action:"Dismiss",onRequestClose:this.hideSnackBar.bind(this)}),c,o,i,x(a.palette).formSimpleCss())}}]),f);function f(e,t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a(Object.getPrototypeOf(f.prototype),"constructor",this).call(this,e,t),e.node?this.state=this.nodeToState(e.node):e.idmRole&&(this.state={idmRole:e.idmRole,roleType:"role",currentPane:"info"},this.loadRoleData(!0)),p.getInstance(this.props.pydio).loadPlugins().then(function(e){r.setState({pluginsRegistry:e})})}e.contextTypes={pydio:i.default.instanceOf(n.default)},e.childContextTypes={messages:i.default.object,getMessage:i.default.func,getPydioRoleMessage:i.default.func,getRootMessage:i.default.func},e.propTypes={node:i.default.instanceOf(AjxpNode),closeEditor:i.default.func,registerCloseCallback:i.default.func},y.default=e=(0,c.muiThemeable)()(e),y.default=e,h.exports=y.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./acl/PagesAcls":32,"./acl/WorkspacesAcls":35,"./info/GroupInfo":36,"./info/RoleInfo":37,"./info/UserInfo":38,"./model/Role":39,"./model/User":40,"./params/ParametersPanel":42,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/util/path":"pydio/util/path",react:"react"}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("prop-types")),u=n(e("pydio")),e=n(e("../model/User")),c=u.default.requireLib("form").FormPanel,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),o(d,[{key:"getPydioRoleMessage",value:function(e){return this.props.pydio.MessageHash["role_editor."+e]||e}},{key:"onParameterChange",value:function(t,e,r){var o=this.props.group,a=this.state.parameters.filter(function(e){return e.name===t}),i=o.getIdmUser(),o=o.getRole();"displayName"===t||"email"===t||"profile"===t?i.Attributes[t]=e:a.length&&a[0].aclKey&&o.setParameter(a[0].aclKey,e)}},{key:"render",value:function(){var e=this.props,t=e.group,r=(e.pydio,this.state.parameters);if(!r)return l.default.createElement("div",null,"Loading...");var o,a={};t&&(e=t.getIdmUser(),o=t.getRole(),t=e.GroupLabel,e.Attributes&&e.Attributes.displayName&&(t=e.Attributes.displayName),a={groupPath:LangUtils.trimRight(e.GroupPath,"/")+"/"+e.GroupLabel,displayName:t},r.map(function(e){e.aclKey&&o.getParameterValue(e.aclKey)&&(a[e.name]=o.getParameterValue(e.aclKey))}));r=[{name:"groupPath",label:this.getPydioRoleMessage("34"),type:"string",readonly:!0},{name:"displayName",label:this.getPydioRoleMessage("35"),type:"string"}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r));return l.default.createElement("div",null,l.default.createElement(c,{parameters:r,onParameterChange:this.onParameterChange.bind(this),values:a,depth:-2}))}}]),d);function d(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,e),this.state={parameters:[]},AdminComponents.PluginsLoader.getInstance(e.pydio).formParameters('//global_param[contains(@scope,"group")]|//param[contains(@scope,"group")]').then(function(e){t.setState({parameters:e})})}o.PropTypes={pydio:s.default.instanceOf(u.default).isRequired,pluginsRegistry:s.default.instanceOf(XMLDocument),group:s.default.instanceOf(e.default)},r.default=o,t.exports=r.default},{"../model/User":40,"prop-types":"prop-types",pydio:"pydio",react:"react"}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("prop-types")),u=n(e("pydio")),e=n(e("../model/Role")),c=u.default.requireLib("form").FormPanel,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,l["default"].Component),o(d,[{key:"getPydioRoleMessage",value:function(e){return this.props.pydio.MessageHash["role_editor."+e]||e}},{key:"onParameterChange",value:function(e,t,r){var o=this.props.role,a=o.getIdmRole();"applies"===e?a.AutoApplies=t.split(","):"roleLabel"===e?a.Label=t:"roleForceOverride"===e?a.ForceOverride=t:(e=this.getParameterByName(e)).aclKey&&o.setParameter(e.aclKey,t)}},{key:"getParameterByName",value:function(t){return this.state.parameters.filter(function(e){return e.name===t})[0]}},{key:"render",value:function(){var t=this.props.role,e=this.state.parameters;if(!e)return l.default.createElement("div",null,"Loading...");var r,o,a=[{name:"roleId",label:this.getPydioRoleMessage("31"),type:"string",readonly:!0,description:this.getPydioRoleMessage("role.id.description")},{name:"roleLabel",label:this.getPydioRoleMessage("32"),type:"string",description:this.getPydioRoleMessage("role.label.description")},{name:"applies",label:this.getPydioRoleMessage("33"),type:"select",multiple:!0,choices:"admin|Administrators,standard|Standard,shared|Shared Users,anon|Anonymous",description:this.getPydioRoleMessage("role.autoapply.description")},{name:"roleForceOverride",label:"Always Override",type:"boolean",description:this.getPydioRoleMessage("role.override.description")}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e)),i={applies:[]};return t&&(o=(r=t.getIdmRole()).AutoApplies||[],i={roleId:r.Uuid,applies:o.filter(function(e){return!!e}),roleLabel:r.Label,roleForceOverride:r.ForceOverride||!1},e.map(function(e){e.aclKey&&t.getParameterValue(e.aclKey)&&(i[e.name]=t.getParameterValue(e.aclKey))})),l.default.createElement(c,{parameters:a,onParameterChange:this.onParameterChange.bind(this),values:i,depth:-2,variant:"v2"})}}]),d);function d(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),i(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,e),this.state={parameters:[]},AdminComponents.PluginsLoader.getInstance(e.pydio).formParameters("//global_param[contains(@scope,'role')]|//param[contains(@scope,'role')]").then(function(e){t.setState({parameters:e})})}o.PropTypes={pydio:s.default.instanceOf(u.default).isRequired,pluginsRegistry:s.default.instanceOf(XMLDocument),role:s.default.instanceOf(e.default)},r.default=o,t.exports=r.default},{"../model/Role":39,"prop-types":"prop-types",pydio:"pydio",react:"react"}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var c=n(e("react")),l=n(e("prop-types")),s=n(e("pydio")),d=n(e("../model/User")),p=e("material-ui"),f=n(e("../user/UserRolesPicker")),m=s.default.requireLib("form").FormPanel,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(h,c["default"].Component),o(h,[{key:"getBinaryContext",value:function(){var e=this.props.user;return"user_id="+e.getIdmUser().Login+(e.getIdmUser().Attributes&&e.getIdmUser().Attributes.avatar?"?"+e.getIdmUser().Attributes.avatar:"")}},{key:"getPydioRoleMessage",value:function(e){return this.props.pydio.MessageHash["role_editor."+e]||e}},{key:"onParameterChange",value:function(t,e,r){var o=this.props.user,a=this.state.parameters.filter(function(e){return e.name===t}),i=o.getIdmUser(),o=o.getRole();"displayName"===t||"email"===t||"profile"===t||"avatar"===t?i.Attributes[t]=e:a.length&&a[0].aclKey&&o.setParameter(a[0].aclKey,e)}},{key:"buttonCallback",value:function(e){var t,r,o,a,i=this.props.user;"update_user_pwd"===e?this.props.pydio.UI.openComponentInModal("AdminPeople","Editor.User.UserPasswordDialog",{user:i}):(r=i.getIdmUser(),o="user_set_lock-lock"===e?"logout":"pass_change",a=[],!r.Attributes.locks||(t=JSON.parse(r.Attributes.locks))&&"object"==typeof t&&(a=t),-1<a.indexOf(o)?(a=a.filter(function(e){return e!==o}),"user_set_lock-lock"===e&&delete r.Attributes.failedConnections):a.push(o),r.Attributes.locks=JSON.stringify(a),i.save())}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,r=t.pydio,t=this.state,i=t.parameters,o=t.showLegends;if(!i)return c.default.createElement("div",null,"Loading...");var n={profiles:[]},l=[],s=void 0;a&&function(){var t,e=a.getIdmUser(),r=a.getRole();e.Attributes.locks&&"object"==typeof(l=JSON.parse(e.Attributes.locks)||[])&&void 0===l.length&&(t=[],Object.keys(l).forEach(function(e){!0===l[e]&&t.push(e)}),l=t),s=c.default.createElement(f.default,{profile:e.Attributes?e.Attributes.profile:"",roles:e.Roles,addRole:function(e){return a.addRole(e)},removeRole:function(e){return a.removeRole(e)},switchRoles:function(e,t){return a.switchRoles(e,t)}});var o=e.Attributes||{};n=u({},n,{avatar:o.avatar,displayName:o.displayName,email:o.email,profile:o.profile,login:e.Login}),i.map(function(e){e.aclKey&&r.getParameterValue(e.aclKey)&&(n[e.name]=r.getParameterValue(e.aclKey))})}();t=[{name:"login",label:this.getPydioRoleMessage("21"),description:r.MessageHash["pydio_role.31"],type:"string",readonly:!0},{name:"profile",label:this.getPydioRoleMessage("22"),description:r.MessageHash["pydio_role.32"],type:"select",choices:"admin|Administrator,standard|Standard,shared|Shared"}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(i));return c.default.createElement("div",null,c.default.createElement("h3",{className:"paper-right-title",style:{display:"flex",alignItems:"center",paddingLeft:26,paddingRight:26}},c.default.createElement("div",{style:{flex:1}},r.MessageHash["pydio_role.24"],c.default.createElement("div",{className:"section-legend"},r.MessageHash["pydio_role.54"])),c.default.createElement("div",{style:{lineHeight:"24px"}},c.default.createElement(p.IconButton,{iconClassName:"mdi mdi-help-circle-outline",tooltip:"Show/hide form legends",tooltipPosition:"bottom-left",onClick:function(){e.setState({showLegends:!o})}}),c.default.createElement(p.IconMenu,{iconButtonElement:c.default.createElement(p.IconButton,{primary:!0,tooltip:"Security Actions",tooltipPosition:"bottom-left",iconClassName:"mdi mdi-lock"+(-1<l.indexOf("logout")?"-open":""),iconStyle:{color:-1<l.indexOf("logout")?"#e53935":""}}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},tooltip:"Actions"},c.default.createElement(p.MenuItem,{primaryText:this.getPydioRoleMessage("25"),onClick:function(){return e.buttonCallback("update_user_pwd")}}),c.default.createElement(p.MenuItem,{primaryText:this.getPydioRoleMessage(-1<l.indexOf("logout")?"27":"26"),onClick:function(){return e.buttonCallback("user_set_lock-lock")}}),c.default.createElement(p.MenuItem,{primaryText:this.getPydioRoleMessage(-1<l.indexOf("pass_change")?"28b":"28"),onClick:function(){return e.buttonCallback("user_set_lock-pass_change")}})))),c.default.createElement(m,{parameters:t,onParameterChange:this.onParameterChange.bind(this),values:n,depth:-2,variant:"v2",variantShowLegend:o,binary_context:this.getBinaryContext()}),s)}}]),h);function h(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),i(Object.getPrototypeOf(h.prototype),"constructor",this).call(this,e),this.state={parameters:[]},AdminComponents.PluginsLoader.getInstance(e.pydio).formParameters('//global_param[contains(@scope,"user")]|//param[contains(@scope,"user")]').then(function(e){t.setState({parameters:e})})}o.PropTypes={pydio:l.default.instanceOf(s.default).isRequired,pluginsRegistry:l.default.instanceOf(XMLDocument),user:l.default.instanceOf(d.default)},r.default=o,t.exports=r.default},{"../model/User":40,"../user/UserRolesPicker":43,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],16:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("./GroupInfo")),i=o(e("./RoleInfo")),e=o(e("./UserInfo")),e={GroupInfo:a.default,RoleInfo:i.default,UserInfo:e.default};r.default=e,t.exports=r.default},{"./GroupInfo":13,"./RoleInfo":14,"./UserInfo":15}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}function l(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=n(e("pydio/lang/observable")),u=n(e("pydio/http/api")),c=e("cells-sdk"),d=e("uuid"),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,s["default"]),o(p,[{key:"load",value:function(){return this.loadAcls()}},{key:"isDirty",value:function(){return this.dirty}},{key:"getIdmRole",value:function(){return this.buildProxy(this.idmRole)}},{key:"makeSnapshot",value:function(){var t=this;this.snapshot=c.IdmRole.constructFromObject(JSON.parse(JSON.stringify(this.idmRole))),this.aclSnapshot=[],this.acls.forEach(function(e){t.aclSnapshot.push(c.IdmACL.constructFromObject(JSON.parse(JSON.stringify(e))))})}},{key:"updateParentRoles",value:function(e){var t=this;this.parentRoles=e,this.loadAcls(!0).then(function(){t.notify("update")})}},{key:"loadAcls",value:function(){var e,o=this,t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],r=new c.ACLServiceApi(u.default.getRestClient()),a=new c.RestSearchACLRequest;a.Queries=[];var i=new c.IdmACLSingleQuery;return i.RoleIDs=[],t||(i.RoleIDs=[this.idmRole.Uuid]),(e=i.RoleIDs).push.apply(e,l(this.parentRoles.map(function(e){return e.Uuid}))),a.Queries.push(i),r.searchAcls(a).then(function(e){var r=p.FormatPolicyAclFromStore(e.ACLs||[]);o.parentRoles.length?(t||(o.acls=r.filter(function(e){return e.RoleID===o.idmRole.Uuid})),o.parentRoles.forEach(function(t){o.parentAcls[t.Uuid]=r.filter(function(e){return e.RoleID===t.Uuid})})):o.acls=r,t||o.makeSnapshot()})}},{key:"revert",value:function(){this.idmRole=this.snapshot,this.acls=this.aclSnapshot,this.dirty=!1,this.makeSnapshot(),this.notify("update")}},{key:"save",value:function(){var a=this,e=new c.RoleServiceApi(u.default.getRestClient()),i=new c.ACLServiceApi(u.default.getRestClient());return e.setRole(this.idmRole.Uuid,this.idmRole).then(function(e){a.idmRole=e;var o=new c.RestSearchACLRequest;o.Queries=[];e=new c.IdmACLSingleQuery;return e.RoleIDs=[a.idmRole.Uuid],o.Queries.push(e),i.searchAcls(o).then(function(e){var t=e.ACLs||[],e=p.FormatPolicyAclToStore(a.acls),e=a.diffAcls(t,e),r=e.inserts,e=e.deletes;return Promise.all(e.map(function(e){return i.deleteAcl(e)})).then(function(){return Promise.all(r.map(function(e){return i.putAcl(e)})).then(function(e){return i.searchAcls(o).then(function(e){a.acls=p.FormatPolicyAclFromStore(e.ACLs||[]),a.makeSnapshot(),a.dirty=!1,a.notify("update")})})})})})}},{key:"diffAcls",value:function(e,r){var o=this,t=e.filter(function(t){return!r.find(function(e){return o.equals(t,e)})});return{inserts:r.filter(function(t){return!e.find(function(e){return o.equals(t,e)})}),deletes:t}}},{key:"equals",value:function(e,t){return e.NodeID===t.NodeID&&e.Action.Name===t.Action.Name&&e.Action.Value===t.Action.Value&&e.WorkspaceID===t.WorkspaceID}},{key:"setParameter",value:function(t,e){var r,o,a=this,i=arguments.length<=2||void 0===arguments[2]?"PYDIO_REPO_SCOPE_ALL":arguments[2],n=this.acls.filter(function(e){return e.Action.Name===t&&e.WorkspaceID===i});n.length?(r=n[0],o=void 0,a.parentRoles.forEach(function(e){o=a.getAclValue(a.parentAcls[e.Uuid],t,i,o)}),void 0!==o&&o===e?a.acls=a.acls.filter(function(e){return e!==r}):r.Action.Value=JSON.stringify(e)):((n=new c.IdmACL).RoleID=this.idmRole.Uuid,n.WorkspaceID=i,n.Action=new c.IdmACLAction,n.Action.Name=t,n.Action.Value=JSON.stringify(e),this.acls.push(n)),this.dirty=!0,this.notify("update")}},{key:"deleteParameter",value:function(t){this.acls=this.acls.filter(function(e){return e!==t}),this.dirty=!0,this.notify("update")}},{key:"getParameterValue",value:function(t){var r=this,o=arguments.length<=1||void 0===arguments[1]?"PYDIO_REPO_SCOPE_ALL":arguments[1],a=void 0;return this.parentRoles.forEach(function(e){a=r.getAclValue(r.parentAcls[e.Uuid],t,o,a)}),this.getAclValue(this.acls,t,o,a)}},{key:"listParametersAndActions",value:function(){function t(e){return e.Action.Name&&(0===e.Action.Name.indexOf("parameter:")||0===e.Action.Name.indexOf("action:"))}var r=this,o=(o=this.acls||[]).filter(t);return this.parentRoles.forEach(function(e){e=(e=r.parentAcls[e.Uuid]||[]).filter(t).filter(function(t){return!o.filter(function(e){return e.Action.Name===t.Action.Name}).length}).map(function(e){e=c.IdmACL.constructFromObject(JSON.parse(JSON.stringify(e)));return e.INHERITED=!0,e});o=[].concat(l(o),l(e))}),o}},{key:"getAclValue",value:function(e,t,r,o){if(!e)return o;var a=e.filter(function(e){return e.Action.Name===t&&e.WorkspaceID===r});try{return JSON.parse(a[0].Action.Value)}catch(e){return o}}},{key:"getAclString",value:function(e,t){var r,o=this,a=!1,i=void 0,n=void 0;n=e?(r=(r=e.RootNodes)[Object.keys(r).shift()],i=e.UUID,r.Uuid):t;var l=void 0,s=void 0;this.parentRoles.forEach(function(e){e=o._aclStringForAcls(o.parentAcls[e.Uuid],i,n);void 0!==e&&(s=e)});t=this._aclStringForAcls(this.acls,i,n);if(void 0!==t)l=t;else{if(void 0===s)return{aclString:""};l=s,a=!0}return{aclString:Object.keys(l).filter(function(e){return l[e]}).join(","),inherited:a}}},{key:"_aclStringForAcls",value:function(e,r,o){var a={read:!1,write:!1,deny:!1},t=e.filter(function(e){return e.Action.Name&&0===e.Action.Name.indexOf("policy:")&&(!r||e.WorkspaceID===r)&&e.NodeID===o&&"1"===e.Action.Value});return t.length?(a[t[0].Action.Name]=!0,a):(Object.keys(a).forEach(function(t){e.filter(function(e){return e.Action.Name===t&&(!r||e.WorkspaceID===r)&&e.NodeID===o&&"1"===e.Action.Value}).length&&(a[t]|=!0)}),a.read||a.write||a.deny?a:void 0)}},{key:"updateAcl",value:function(o,t,e){var a=this,i=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],n=[],l=!1;t?(n=[t],l=i&&-1<Object.keys(i.RootNodes).indexOf(t)):n=Object.keys(o.RootNodes),this.acls=o?this.acls.filter(function(e){return!(("read"===e.Action.Name||"write"===e.Action.Name||"deny"===e.Action.Name||e.Action.Name&&0===e.Action.Name.indexOf("policy:"))&&e.WorkspaceID===o.UUID&&-1<n.indexOf(e.NodeID)&&"1"===e.Action.Value)}):this.acls.filter(function(e){return!(("read"===e.Action.Name||"write"===e.Action.Name||"deny"===e.Action.Name||e.Action.Name&&0===e.Action.Name.indexOf("policy:"))&&e.NodeID===t&&"1"===e.Action.Value)}),""!==e&&e.split(",").forEach(function(r){n.forEach(function(e){var t=new c.IdmACL;t.NodeID=e,o?t.WorkspaceID=o.UUID:l&&(t.WorkspaceID=i.UUID),t.RoleID=a.idmRole.Uuid,t.Action=c.IdmACLAction.constructFromObject({Name:r,Value:"1"}),a.acls.push(t)})}),this.dirty=!0,this.notify("update")}},{key:"buildProxy",value:function(e){var o=this;return new Proxy(e,{set:function(e,t,r){return e[t]=r,o.dirty=!0,o.notify("update"),!0},get:function(e,t){t=e[t];return!(t instanceof Array)&&t instanceof Object?o.buildProxy(t):t}})}}],[{key:"FormatPolicyAclFromStore",value:function(e){return e.map(function(e){return e.Action&&"policy"===e.Action.Name&&(e.Action.Name="policy:"+e.Action.Value,e.Action.Value="1"),e})}},{key:"FormatPolicyAclToStore",value:function(e){return e.map(function(e){if(e.Action&&0===e.Action.Name.indexOf("policy:")){var t=c.IdmACL.constructFromObject(JSON.parse(JSON.stringify(e)));return t.Action.Name="policy",t.Action.Value=e.Action.Name.split(":")[1],t}return e})}}]),p);function p(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),i(Object.getPrototypeOf(p.prototype),"constructor",this).call(this),this.acls=[],this.dirty=!1,this.parentRoles=t,this.parentAcls={},e?this.idmRole=e:(this.idmRole=new c.IdmRole,this.idmRole.Uuid=(0,d.v4)()),this.makeSnapshot()}r.default=o,t.exports=r.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable",uuid:53}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var l=n(e("pydio/lang/observable")),u=e("cells-sdk"),c=e("uuid"),d=n(e("./Role")),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,l["default"]),o(p,[{key:"load",value:function(){var e=this;this.role.load().then(function(){e.notify("update")})}},{key:"isDirty",value:function(){return this.dirty}},{key:"save",value:function(){var t=this;return PydioApi.getRestClient().getIdmApi().updateIdmUser(this.idmUser).then(function(e){return t.idmUser=e,t.role.isDirty()?t.role.save().then(function(){t.makeSnapshot(),t.dirty=!1,t.notify("update")}):(t.makeSnapshot(),t.dirty=!1,t.notify("update"),Promise.resolve(t))})}},{key:"revert",value:function(){this.idmUser=this.snapshot,this.makeSnapshot(),this.dirty=!1,this.notify("update"),this.role.revert()}},{key:"makeSnapshot",value:function(){this.snapshot=u.IdmUser.constructFromObject(JSON.parse(JSON.stringify(this.idmUser)))}},{key:"getRole",value:function(){return this.role}},{key:"addRole",value:function(t){var r=this,e=this.idmUser.Roles.filter(function(e){return e.Uuid!==r.idmUser.Uuid}),e=[].concat(s(e.filter(function(e){return e.Uuid!==t.Uuid})),[t]);this.idmUser.Roles=[].concat(s(e),[this.idmRole]),this.dirty=!0,this.role.updateParentRoles(e)}},{key:"removeRole",value:function(t){var r=this,e=this.idmUser.Roles.filter(function(e){return e.Uuid!==r.idmUser.Uuid&&e.Uuid!==t.Uuid});this.idmUser.Roles=[].concat(s(e),[this.idmRole]),this.dirty=!0,this.role.updateParentRoles(e)}},{key:"switchRoles",value:function(e,t){for(var r=this,o=this.idmUser.Roles.filter(function(e){return e.Uuid!==r.idmUser.Uuid}),a=void 0,i=void 0,n=void 0,l=0;l<o.length;l++)o[l].Uuid===e?n=o[a=l]:o[l].Uuid===t&&(i=l);o[a]=o[i],o[i]=n,this.idmUser.Roles=[].concat(s(o),[this.idmRole]),this.dirty=!0,this.role.updateParentRoles(o)}},{key:"getIdmUser",value:function(){return this.buildProxy(this.idmUser)}},{key:"buildProxy",value:function(e){var o=this;return new Proxy(e,{set:function(e,t,r){return e[t]=r,o.dirty=!0,o.notify("update"),!0},get:function(e,t){t=e[t];return!(t instanceof Array)&&t instanceof Object?o.buildProxy(t):t}})}}]),p);function p(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),i(Object.getPrototypeOf(p.prototype),"constructor",this).call(this),this.acls=[];var r=[];e?(this.idmUser=e,this.idmUser.Roles&&(this.idmRole=this.idmUser.Roles.filter(function(e){return e.Uuid===t.idmUser.Uuid})[0],this.idmUser.IsGroup||(r=this.idmUser.Roles.filter(function(e){return e.Uuid!==t.idmUser.Uuid}))),this.idmUser.Attributes||(this.idmUser.Attributes={})):(this.idmUser=new u.IdmUser,this.idmUser.Uuid=(0,c.v4)(),this.idmRole=u.IdmRole.constructFromObject({Uuid:this.idmUser.Uuid}),this.idmUser.Roles=[this.idmRole],this.idmUser.Attributes={}),this.role=new d.default(this.idmRole,r),this.role.observe("update",function(){t.dirty|=t.role.isDirty(),t.notify("update")}),this.makeSnapshot()}r.default=o,t.exports=r.default},{"./Role":17,"cells-sdk":"cells-sdk","pydio/lang/observable":"pydio/lang/observable",uuid:53}],19:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("./Role")),e=o(e("./User")),e={Role:a.default,User:e.default};r.default=e,t.exports=r.default},{"./Role":17,"./User":18}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=n(e("create-react-class")),u=n(e("./ParametersPicker")),c=n(e("prop-types")),d=n(e("pydio")),p=e("material-ui/styles"),e=d.default.requireLib("boot"),d=e.ActionDialogMixin,e=e.CancelButtonProviderMixin,f=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,l["default"].Component),o(m,[{key:"render",value:function(){var e=this.props,t=e.getMessage,e=e.muiTheme.palette.primary1Color;return l.default.createElement("div",{style:{backgroundColor:e,color:"white",padding:"0 24px 24px"}},l.default.createElement("h3",{style:{color:"white"}},t("14")),l.default.createElement("div",{className:"legend"},t("15")))}}]),m);function m(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),i(Object.getPrototypeOf(m.prototype),"constructor",this).apply(this,arguments)}f=(0,p.muiThemeable)()(f),c=(0,s.default)({displayName:"ParameterCreate",mixins:[d,e],propTypes:{workspaceScope:c.default.string,showModal:c.default.func,hideModal:c.default.func,pluginsFilter:c.default.func,roleType:c.default.oneOf(["user","group","role"]),createParameter:c.default.func},getDefaultProps:function(){return{dialogPadding:0,dialogTitle:"",dialogSize:"md"}},getInitialState:function(){return{step:1,workspaceScope:this.props.workspaceScope,pluginName:null,paramName:null,actions:{},parameters:{}}},setSelection:function(e,t,r,o){this.setState({pluginName:e,type:t,paramName:r,attributes:o},this.createParameter)},createParameter:function(){this.props.createParameter(this.state.type,this.state.pluginName,this.state.paramName,this.state.attributes),this.props.onDismiss()},render:function(){function e(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r.MessageHash[t+(t?".":"")+e]||e}var t=this.props,r=t.pydio,o=t.actions,t=t.parameters;return l.default.createElement("div",{className:"picker-list"},l.default.createElement(f,{getMessage:e}),l.default.createElement(u.default,{pydio:r,allActions:o,allParameters:t,onSelection:this.setSelection,getMessage:e}))}});r.default=c,t.exports=r.default},{"./ParametersPicker":23,"create-react-class":"create-react-class","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio",react:"react"}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,a=!1,i=void 0;try{for(var n,l=e[Symbol.iterator]();!(o=(n=l.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var h=n(e("react")),l=e("../util/MessagesMixin"),y=(e("cells-sdk"),n(e("pydio/util/xml"))),g=(e("../model/Role"),e("material-ui")),v=n(e("pydio")).default.requireLib("form"),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(s,h["default"].Component),o(s,[{key:"onChangeParameter",value:function(e,t){var r,o;e!==t&&(r=(o=this.props).role,o=(t=o.acl).Action.Name,r.setParameter(o,e,t.WorkspaceID))}},{key:"deleteParameter",value:function(){var e=this.props,t=e.role,e=e.acl;t.deleteParameter(e)}},{key:"overrideParameter",value:function(){var e=this.props,t=e.role,r=e.acl,o=r.Action.Name,a=o.split(":"),e=f(a,3),a=e[0],a=(e[1],e[2],"action"===a?!1:"");t.setParameter(o,a,r.WorkspaceID)}},{key:"onInputEditMode",value:function(e){this.setState({editMode:e})}},{key:"toggleEditMode",value:function(){this.refs.formElement&&this.refs.formElement.toggleEditMode()}},{key:"toggleActionStatus",value:function(e,t){var r=this.props,o=r.role,r=r.acl;o.setParameter(r.Action.Name,t,r.WorkspaceID)}},{key:"render",value:function(){var e=this.props,t=e.acl,r=e.actions,o=e.parameters,a=e.pydio,i=e.getMessage,n=e.getPydioRoleMessage,l=t.Action.Name.split(":"),s=f(l,3),u=s[0],c=s[1],d=s[2],e=void 0,e="DEFAULT_START_REPOSITORY"===d?t.Action.Value:JSON.parse(t.Action.Value),l=t.INHERITED,s=d,t=void 0;"parameter"===u&&o[c]?(p=o[c].filter(function(e){return e.parameter===d})).length&&(t=p[0]):"action"===u&&r[c]&&(p=r[c].filter(function(e){return e.action===d})).length&&(t=p[0]);c=void 0;if("parameter"===u){var p={type:"string",label:s,name:d};if("user"===(p=t?v.Manager.parameterNodeToHash(t.xmlNode):p).scope)return null;s=p.label,c=v.createFormElement({ref:"formElement",attributes:p,name:d,value:e,onChange:this.onChangeParameter.bind(this),disabled:l,onChangeEditMode:this.onInputEditMode.bind(this),displayContext:"grid"})}else t&&(s=y.default.XPathGetSingleNodeText(t.xmlNode,"gui/@text")||s,a.MessageHash[s]&&(s=a.MessageHash[s])),c=h.default.createElement("div",{className:"role-action-toggle"},h.default.createElement(g.Toggle,{name:this.props.name,onToggle:this.toggleActionStatus.bind(this),toggled:!!e,label:i(e?"2":"3"),labelPosition:"right"}));a=void 0,e={style:{opacity:.2},hoveredStyle:{opacity:1}};return"parameter"===u?this.state.editMode?a=h.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-content-save",tooltip:i("6"),onClick:this.toggleEditMode.bind(this)},e)):(a=h.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-close",tooltip:i("4"),onClick:this.deleteParameter.bind(this)},e)),l&&(a=h.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-content-copy",tooltip:i("5"),onClick:this.overrideParameter.bind(this)},e)))):a=l?h.default.createElement("div",{style:{width:48,height:48}}):h.default.createElement(g.IconButton,m({iconClassName:"mdi mdi-close",tooltip:i("4"),onClick:this.deleteParameter.bind(this)},e)),h.default.createElement("tr",{className:(l?"inherited":"")+(this.state.editMode?" edit-mode":""),style:m({},this.props.style)},h.default.createElement("td",{style:{width:"40%",fontWeight:500}},l?"["+n("38")+"]":""," ",s),h.default.createElement("td",{style:{wordBreak:"break-all"}},c),h.default.createElement("td",{style:{width:50}},a))}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,e),this.state={editMode:!1}}r.default=(0,l.withRoleMessages)(o),t.exports=r.default},{"../model/Role":39,"../util/MessagesMixin":45,"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio","pydio/util/xml":"pydio/util/xml",react:"react"}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,a=!1,i=void 0;try{for(var n,l=e[Symbol.iterator]();!(o=(n=l.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}var d=l(e("react")),p=l(e("./ParameterEntry")),f=e("material-ui"),s=e("cells-sdk"),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,d["default"].Component),a(u,[{key:"componentDidMount",value:function(){var t=this;AdminComponents.PluginsLoader.getInstance(this.props.pydio).allPluginsActionsAndParameters().then(function(e){t.setState({actions:e.ACTIONS,parameters:e.PARAMETERS})})}},{key:"onCreateParameter",value:function(e,t,r,o,a){var i=this.props.role,r=t+":"+r+":"+o,o=void 0;"action"===t?o=!1:a&&a.xmlNode&&(o=(a=a.xmlNode).getAttribute("default")?a.getAttribute("default"):"","boolean"===a.getAttribute("type")?o="true"===o:"integer"===a.getAttribute("type")&&(o=parseInt(o))),i.setParameter(r,o,e)}},{key:"addParameter",value:function(a){var i=this,e=this.props,t=e.pydio,r=e.roleType,o=this.state,e=o.actions,o=o.parameters;t.UI.openComponentInModal("AdminPeople","Editor.Params.ParameterCreate",{pydio:t,actions:e,parameters:o,workspaceScope:a,createParameter:function(e,t,r,o){i.onCreateParameter(a,e,t,r,o)},roleType:r})}},{key:"render",value:function(){var a=this,e=this.props,i=e.role,n=e.pydio;if(!i)return null;function l(e){return n.MessageHash["pydio_role."+e]||e}var s=this.state.workspaces,e=i.listParametersAndActions(),u={PYDIO_REPO_SCOPE_ALL:{},PYDIO_REPO_SCOPE_SHARED:{}};e.forEach(function(e){u[e.WorkspaceID]||(u[e.WorkspaceID]={});var t=e.Action.Name.split(":"),t=o(t,3),t=(t[0],t[1],t[2]);u[e.WorkspaceID][t]=e});e=[d.default.createElement(f.MenuItem,{primaryText:l("parameters.scope.selector.title"),value:1}),d.default.createElement(f.MenuItem,{primaryText:l("parameters.scope.all"),onClick:function(){a.addParameter("PYDIO_REPO_SCOPE_ALL")}}),d.default.createElement(f.MenuItem,{primaryText:l("parameters.scope.shared"),onClick:function(){a.addParameter("PYDIO_REPO_SCOPE_SHARED")}}),d.default.createElement(f.Divider,null)].concat(Object.keys(s).map(function(e){return d.default.createElement(f.MenuItem,{primaryText:s[e].Label,onClick:function(){a.addParameter(e)}})}));return d.default.createElement("div",null,d.default.createElement("h3",{className:"paper-right-title",style:{display:"flex"}},d.default.createElement("span",{style:{flex:1,paddingRight:20}},l("46"),d.default.createElement("div",{className:"section-legend"},l("47"))),d.default.createElement("div",{style:{width:160}},d.default.createElement(f.SelectField,{fullWidth:!0,value:1},e))),d.default.createElement("div",{style:{padding:"0 20px",backgroundColor:"white"}},Object.keys(u).map(function(r){var e=void 0,o=!1,e="PYDIO_REPO_SCOPE_ALL"===r?l("parameters.scope.all"):"PYDIO_REPO_SCOPE_SHARED"===r?l("parameters.scope.shared"):s[r]?l("parameters.scope.workspace").replace("%s",s[r].Label):l("parameters.scope.workspace").replace("%s",r),t=void 0,t=Object.keys(u[r]).length?Object.keys(u[r]).map(function(e){var t={backgroundColor:o?"#FAFAFA":"white"};return o=!o,d.default.createElement(p.default,c({pydio:n,acl:u[r][e],role:i},a.state,{style:t}))}):d.default.createElement("tr",null,d.default.createElement("td",{colSpan:3,style:{padding:"14px 0"}},l("parameters.empty")));return d.default.createElement("table",{style:{width:"100%",marginBottom:20}},d.default.createElement("tr",{style:{borderBottom:"1px solid #e0e0e0"}},d.default.createElement("td",{colSpan:2,style:{fontSize:15,paddingTop:10}},e),d.default.createElement("td",{style:{width:50}},d.default.createElement(f.IconButton,{iconClassName:"mdi mdi-plus",onClick:function(){a.addParameter(r)},tooltip:l("parameters.custom.add")}))),t)})))}}]),u);function u(e){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),n(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,e),this.state={actions:{},parameters:{},workspaces:{}};var t=new s.WorkspaceServiceApi(PydioApi.getRestClient()),e=new s.RestSearchWorkspaceRequest;e.Queries=[s.IdmWorkspaceSingleQuery.constructFromObject({scope:"ADMIN"})],t.searchWorkspaces(e).then(function(e){var e=e.Workspaces||[],t={};e.forEach(function(e){t[e.UUID]=e}),r.setState({workspaces:t})})}r.default=a,t.exports=r.default},{"./ParameterEntry":21,"cells-sdk":"cells-sdk","material-ui":"material-ui",react:"react"}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},a=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function l(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var v=l(e("react")),u=l(e("pydio/util/lang")),b=l(e("pydio/util/xml")),c=e("material-ui"),a=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(d,v["default"].Component),a(d,[{key:"filter",value:function(e){this.setState({filter:e.target.value.toLowerCase()})}},{key:"select",value:function(e,t,r,o){this.props.onSelection(e,t,r,o),this.setState({pluginName:e,type:t,paramName:r})}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.refs.input.focus()},150)}},{key:"render",value:function(){function d(e){return!a||-1!==e.toLowerCase().indexOf(a)}function p(e){if(!a)return e;var t=e.toLowerCase().indexOf(a),r=e.substr(0,t),o=e.substr(t,a.length),t=e.substr(t+a.length);return v.default.createElement("span",null,r,v.default.createElement("span",{className:"highlight"},o),t)}var f=this,e=this.props,m=e.pydio,r=e.allParameters,o=e.allActions,a=this.state.filter,h=this.state.paramName,y=this.state.pluginName,g=this.state.type,t=[],i={};return Object.keys(r).forEach(function(e){var t;i[e]||(i[e]={name:e,label:e,actions:[],params:[]}),(t=i[e].params).push.apply(t,s(r[e]))}),Object.keys(o).forEach(function(e){var t;i[e]||(i[e]={name:e,label:e,actions:[],params:[]}),(t=i[e].actions).push.apply(t,s(o[e]))}),u.default.objectValues(i).map(function(s){var u=[],c=!1,e=s.label||s.name;(d(e)||d(s.name))&&(c=!0,d(e)?e=p(e):d(s.name)&&(e=v.default.createElement("span",null,e," (",p(s.name),")"))),s.params.concat(s.actions).map(function(e){var t=e.action||e.parameter,r=e.label||t,o="";e.action?(r=b.default.XPathGetSingleNodeText(e.xmlNode,"gui/@text")||r,o=f.props.actionsPrefix):(r=e.xmlNode.getAttribute("label")||r,f.props.parametersPrefix&&(o=f.props.parametersPrefix)),m.MessageHash[r]&&(r=m.MessageHash[r]);var a,i,n=d(r),l=d(t);(n||l||c)&&(a=("*"===y||y===s.name)&&e[g]&&h===t,i=r,n?i=p(r):l&&(i=v.default.createElement("span",null,r," (",p(t),") ")),u.push(v.default.createElement("li",{onClick:function(){return f.select(s.name,e.action?"action":"parameter",t,e)},className:(a?"selected ":"")+"parameters-param",key:s.name+"-"+(e.action?"action":"parameter")+"-"+t},o," ",i)))}),u.length&&t.push(v.default.createElement("li",{className:"parameters-plugin",key:s.name},e,v.default.createElement("ul",null,u)))}),v.default.createElement("div",null,v.default.createElement("div",{style:{padding:"0 24px",borderBottom:"1px solid #e0e0e0"}},v.default.createElement(c.TextField,{ref:"input",floatingLabelText:this.props.getMessage("13"),onChange:this.filter.bind(this),fullWidth:!0,underlineShow:!1})),v.default.createElement("div",{className:"parameters-tree-scroller"},v.default.createElement("ul",{className:"parameters-tree"},t)))}}]),d);function d(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),n(Object.getPrototypeOf(d.prototype),"constructor",this).call(this,o({actionsPrefix:"[a] ",parametersPrefix:""},e)),this.state={filter:null},this.props.initialSelection&&(this.state=o({filter:this.props.initialSelection.paramName},this.props.initialSelection))}r.default=a,t.exports=r.default},{"material-ui":"material-ui","pydio/util/lang":"pydio/util/lang","pydio/util/xml":"pydio/util/xml",react:"react"}],24:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("./ParameterEntry")),i=o(e("./ParameterCreate")),n=o(e("./ParametersPanel")),a={ParametersPicker:o(e("./ParametersPicker")).default,ParameterCreate:i.default,ParametersPanel:n.default,ParameterEntry:a.default};r.default=a,t.exports=r.default},{"./ParameterCreate":20,"./ParameterEntry":21,"./ParametersPanel":22,"./ParametersPicker":23}],25:[function(f,m,h){!function(r){"use strict";Object.defineProperty(h,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};function e(e){return e&&e.__esModule?e:{default:e}}var o=e(f("react")),a=e(f("create-react-class")),i=e(f("prop-types")),n=e(f("pydio")),l=e(f("../model/User")),s=e(f("pydio/util/pass")),u=n.default.requireLib("boot"),c=u.ActionDialogMixin,d=u.CancelButtonProviderMixin,u=u.SubmitButtonProviderMixin,p=n.default.requireLib("hoc").ModernTextField;h.default=(0,a.default)({displayName:"UserPasswordDialog",mixins:[AdminComponents.MessagesConsumerMixin,c,d,u],propTypes:{pydio:i.default.instanceOf(n.default),user:i.default.instanceOf(l.default)},getDefaultProps:function(){return{dialogTitle:pydio.MessageHash["role_editor.25"],dialogSize:"sm"}},getInitialState:function(){var e=s.default.getState();return t({},e)},onChange:function(e,t){var r=this.refs.pass.getValue(),o=this.refs.confirm.getValue(),o=s.default.getState(r,o,this.state);this.setState(o)},submit:function(){var e,t,r=this;this.state.valid?(e=this.refs.pass.getValue(),(t=this.props.user).getIdmUser().Password=e,t.save().then(function(){r.dismiss()})):this.props.pydio.UI.displayMessage("ERROR",this.state.passErrorText||this.state.confirmErrorText)},render:function(){function e(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return r.pydio.MessageHash[t+(t?".":"")+e]||e}return o.default.createElement("div",{style:{width:"100%"}},o.default.createElement(p,{ref:"pass",type:"password",fullWidth:!0,onChange:this.onChange,floatingLabelText:e("523"),errorText:this.state.passErrorText,hintText:this.state.passHintText}),o.default.createElement(p,{ref:"confirm",type:"password",fullWidth:!0,onChange:this.onChange,floatingLabelText:e("199"),errorText:this.state.confirmErrorText}))}}),m.exports=h.default}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../model/User":40,"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],26:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var u=o(e("react")),a=o(e("create-react-class")),c=e("material-ui"),i=e("../util/MessagesMixin"),n=o(e("prop-types")),l=o(e("pydio/http/api"));r.default=(0,a.default)({displayName:"UserRolesPicker",mixins:[i.RoleMessagesConsumerMixin],propTypes:{profile:n.default.string,roles:n.default.array,addRole:n.default.func,removeRole:n.default.func,switchRoles:n.default.func},getInitialState:function(){return{availableRoles:[]}},componentDidMount:function(){var t=this;l.default.getRestClient().getIdmApi().listRoles().then(function(e){t.setState({availableRoles:e})})},onChange:function(e,t,r){-1!==r&&this.props.addRole(r)},remove:function(t){var e=this.state.availableRoles.filter(function(e){return e.Uuid===t})[0];this.props.removeRole(e)},orderUpdated:function(e,t,r){this.props.switchRoles(e,t)},render:function(){var t=[],r=[],o=[],a=this.context,e=this.props,i=e.roles,n=e.loadingMessage,l=e.profile,e=this.state.availableRoles;i.map(function(e){e.GroupRole?"ROOT_GROUP"===e.Uuid?t.push("/ "+a.getMessage("user.25","ajxp_admin")):t.push(a.getMessage("user.26","ajxp_admin").replace("%s",e.Label||e.Uuid)):e.UserRole?o.push(a.getMessage("user.27","ajxp_admin")):e.AutoApplies&&-1!==e.AutoApplies.indexOf(l)?t.push(e.Label+" [auto]"):r.push({payload:e.Uuid,text:e.Label})}.bind(this));var e=[u.default.createElement(c.MenuItem,{value:-1,primaryText:a.getMessage("20")})].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e.filter(function(e){return-1===i.indexOf(e)}).map(function(e){return u.default.createElement(c.MenuItem,{value:e,primaryText:e.Label||e.Uuid})}))),s={padding:10,fontSize:14,backgroundColor:"rgb(246 246 248)",borderRadius:2,margin:"8px 0"};return u.default.createElement("div",{className:"user-roles-picker",style:{padding:0,paddingBottom:12,margin:"-30px 20px 40px",backgroundColor:"white",borderRadius:6,border:"1px solid #dfe3e5"}},u.default.createElement("div",{style:{paddingLeft:16,display:"flex",alignItems:"center"}},u.default.createElement("div",{style:{flex:1,fontSize:16}},a.getMessage("roles.picker.title")," ",n?" ("+a.getMessage("21")+")":""),u.default.createElement("div",{className:"roles-picker-menu",style:{marginBottom:-12}},u.default.createElement(c.DropDownMenu,{underlineStyle:{display:"none"},onChange:this.onChange,value:-1},e))),u.default.createElement("div",{className:"roles-list",style:{margin:"0 16px",paddingBottom:1}},t.map(function(e){return u.default.createElement("div",{key:"group-"+e,style:s},e)}),u.default.createElement(PydioComponents.SortableList,{key:"sortable",values:r,removable:!0,onRemove:this.remove,onOrderUpdated:this.orderUpdated,itemClassName:"role-item role-item-sortable"}),o.map(function(e){return u.default.createElement("div",{key:"user-"+e,style:s},e)})))}}),t.exports=r.default},{"../util/MessagesMixin":45,"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types","pydio/http/api":"pydio/http/api",react:"react"}],27:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("./UserPasswordDialog")),e=o(e("./UserRolesPicker")),e={UserPasswordDialog:a.default,UserRolesPicker:e.default};r.default=e,t.exports=r.default},{"./UserPasswordDialog":25,"./UserRolesPicker":26}],28:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=o(e("pydio/util/func")),l=o(e("pydio/http/resources-manager"));r.loadEditorClass=function(r,o){if(!(r=void 0===r?"":r))return Promise.resolve(o);var e=r.split("."),a=e.shift(),i=e.join(".");return l.default.loadClass(a).then(function(e){var t=n.default.getFunctionByName(i,e);if(t)return t;if("object"==typeof e&&e[a]){e=n.default.getFunctionByName(i,e[a]);if(e)return e}if(o)return console.error("Cannot find editor component, using default instead",r,o),o;throw new Error("cannot find editor component")}).catch(function(e){if(o)return console.error("Cannot find editor component, using default instead",r,o),o;throw e})}},{"pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func"}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={CACHE:null},t.exports=r.default},{}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},a=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e){return e&&e.__esModule?e:{default:e}}var l=e("react"),s=n(l),u=n(e("prop-types")),c=n(e("pydio")),e={contextTypes:{messages:u.default.object,getMessage:u.default.func,getPydioRoleMessage:u.default.func,getRootMessage:u.default.func}},u={childContextTypes:{messages:u.default.object,getMessage:u.default.func,getPydioRoleMessage:u.default.func,getRootMessage:u.default.func},getChildContext:function(){var r=this.context.pydio.MessageHash;return{messages:r,getMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r[t+(t?".":"")+e]||e},getPydioRoleMessage:function(e){return r["role_editor."+e]||e},getRootMessage:function(e){return r[e]||e}}}};r.RoleMessagesConsumerMixin=e,r.RoleMessagesProviderMixin=u,r.withRoleMessages=function(e){return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),a(t,[{key:"render",value:function(){var r=(this.props.pydio||c.default.getInstance()).MessageHash;return s.default.createElement(e,o({},this.props,{getMessage:function(e){var t=arguments.length<=1||void 0===arguments[1]?"pydio_role":arguments[1];return r[t+(t?".":"")+e]||e},getPydioRoleMessage:function(e){return r["role_editor."+e]||e},getRootMessage:function(e){return r[e]||e},getAdminMessage:function(e){return r["ajxp_admin."+e]||e}}))}}]),t;function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}}},{"prop-types":"prop-types",pydio:"pydio",react:"react"}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o,a=e("./EditorCache"),i=(o=a)&&o.__esModule?o:{default:o},n=e("./MessagesMixin"),e=e("./ClassLoader"),e={EditorCache:i.default,RoleMessagesConsumerMixin:n.RoleMessagesConsumerMixin,withRoleMessages:n.withRoleMessages,loadEditorClass:e.loadEditorClass};r.default=e,t.exports=r.default},{"./ClassLoader":28,"./EditorCache":29,"./MessagesMixin":30}],32:[function(e,t,r){arguments[4][6][0].apply(r,arguments)},{"./WorkspaceAcl":34,"cells-sdk":"cells-sdk",dup:6,"pydio/util/lang":"pydio/util/lang",react:"react"}],33:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{"../util/MessagesMixin":45,dup:7,"material-ui":"material-ui",react:"react"}],34:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{"../util/MessagesMixin":45,"./RightsSelector":33,"cells-sdk":"cells-sdk",dup:9,"material-ui":"material-ui",react:"react"}],35:[function(e,t,r){arguments[4][10][0].apply(r,arguments)},{"./WorkspaceAcl":34,"cells-sdk":"cells-sdk",dup:10,pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang",react:"react"}],36:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"../model/User":40,dup:13,"prop-types":"prop-types",pydio:"pydio",react:"react"}],37:[function(e,t,r){arguments[4][14][0].apply(r,arguments)},{"../model/Role":39,dup:14,"prop-types":"prop-types",pydio:"pydio",react:"react"}],38:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{"../model/User":40,"../user/UserRolesPicker":43,dup:15,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],39:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"cells-sdk":"cells-sdk",dup:17,"pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable",uuid:53}],40:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{"./Role":39,"cells-sdk":"cells-sdk",dup:18,"pydio/lang/observable":"pydio/lang/observable",uuid:53}],41:[function(e,t,r){arguments[4][21][0].apply(r,arguments)},{"../model/Role":39,"../util/MessagesMixin":45,"cells-sdk":"cells-sdk",dup:21,"material-ui":"material-ui",pydio:"pydio","pydio/util/xml":"pydio/util/xml",react:"react"}],42:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{"./ParameterEntry":41,"cells-sdk":"cells-sdk",dup:22,"material-ui":"material-ui",react:"react"}],43:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{"../util/MessagesMixin":45,"create-react-class":"create-react-class",dup:26,"material-ui":"material-ui","prop-types":"prop-types","pydio/http/api":"pydio/http/api",react:"react"}],44:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28,"pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func"}],45:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{dup:30,"prop-types":"prop-types",pydio:"pydio",react:"react"}],46:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var u=o(e("react")),a=o(e("create-react-class")),i=o(e("prop-types")),n=o(e("pydio")),m=o(e("pydio/http/api")),l=o(e("pydio/model/node")),s=o(e("pydio/util/lang")),c=n.default.requireLib("hoc").ModernTextField,i=(0,a.default)({displayName:"CreateRoleOrGroupForm",mixins:[AdminComponents.MessagesConsumerMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],propTypes:{type:i.default.oneOf(["group","user","role"]),roleNode:i.default.instanceOf(l.default),openRoleEditor:i.default.func},getTitle:function(){return"group"===this.props.type?this.context.getMessage("ajxp_admin.user.15"):this.context.getMessage("ajxp_admin.user.14")},getPadding:function(){return!0},getSize:function(){return"sm"},dismiss:function(){return this.props.onDismiss()},getInitialState:function(){return{groupId:"",groupIdError:this.context.getMessage("ajxp_admin.user.16.empty"),groupLabel:"",groupLabelError:this.context.getMessage("ajxp_admin.user.17.empty"),roleId:"",roleLabel:"",roleLabelError:this.context.getMessage("ajxp_admin.user.18.empty")}},submit:function(){var o=this,e=this.props,t=e.type,a=e.pydio,r=e.reload,i=void 0,n=this.state,l=n.groupId,s=n.groupIdError,u=n.groupLabel,c=n.groupLabelError,d=n.roleId,p=n.roleIdError,f=n.roleLabel,e=n.roleLabelError;if("group"===t){n=function(){if(s||c)return{v:void 0};var t=(i=a.getContextHolder().getSelectedNodes().length?a.getContextHolder().getSelectedNodes()[0]:a.getContextNode()).getPath().replace("/idm/users",""),r=m.default.getRestClient().getIdmApi();r.userOrGroupByIdentifier(t,l).then(function(e){e?o.setState({groupIdError:"Found group or user with same identifier!"}):r.createGroup(t||"/",l,u).then(function(){o.dismiss(),i.reload()})})}();if("object"==typeof n)return n.v}else"role"===t&&(e||p||m.default.getRestClient().getIdmApi().createRole(f,d).then(function(){o.dismiss(),r&&r()}))},update:function(t){var e,r;void 0!==t.groupId?new RegExp(/^[0-9A-Z\-_.:\+]+$/i).test(t.groupId)?""===t.groupId?t.groupIdError=this.context.getMessage("ajxp_admin.user.16.empty"):t.groupIdError="":t.groupIdError=this.context.getMessage("ajxp_admin.user.16.format"):void 0!==t.groupLabel?""===t.groupLabel?t.groupLabelError=this.context.getMessage("ajxp_admin.user.17.empty"):(t.groupLabelError="",r=(e=this.state).groupId,e=e.groupLabel,""!==r&&s.default.computeStringSlug(e)!==r||(t.groupId=s.default.computeStringSlug(t.groupLabel),t.groupIdError="")):void 0!==t.roleLabel?""===t.roleLabel?t.roleLabelError=this.context.getMessage("ajxp_admin.user.18.empty"):t.roleLabelError="":t.roleId&&(0<(void 0===(r=this.props.roles)?[]:r).filter(function(e){return e.Uuid===t.roleId}).length?t.roleIdError=this.context.getMessage("role_editor.31.exists"):t.roleIdError="",t.roleId=s.default.computeStringSlug(t.roleId)),this.setState(t)},render:function(){var r=this,e=this.state,t=e.groupId,o=e.groupIdError,a=e.groupLabel,i=e.groupLabelError,n=e.roleId,l=e.roleIdError,s=e.roleLabel,e=e.roleLabelError;return"group"===this.props.type?u.default.createElement("div",{style:{width:"100%"}},u.default.createElement(c,{value:a,errorText:i,onChange:function(e,t){r.update({groupLabel:t})},fullWidth:!0,floatingLabelText:this.context.getMessage("ajxp_admin.user.17"),onKeyPress:function(e){"Enter"===e.key&&r.submit()}}),u.default.createElement(c,{value:t,errorText:o,onChange:function(e,t){r.update({groupId:t})},fullWidth:!0,floatingLabelText:this.context.getMessage("ajxp_admin.user.16"),onKeyDown:function(e){"Enter"===e.key&&r.submit()}})):u.default.createElement("div",{style:{width:"100%"}},u.default.createElement(c,{value:s,errorText:e,onChange:function(e,t){r.update({roleLabel:t})},floatingLabelText:this.context.getMessage("role_editor.32"),onKeyDown:function(e){"Enter"===e.key&&r.submit()}}),u.default.createElement(c,{value:n,errorText:l,floatingLabelText:this.context.getMessage("role_editor.31.hint"),onChange:function(e,t){r.update({roleId:t})},onKeyDown:function(e){"Enter"===e.key&&r.submit()}}))}});r.default=i,t.exports=r.default},{"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/lang":"pydio/util/lang",react:"react"}],47:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};function a(e){return e&&e.__esModule?e:{default:e}}var i=a(e("react")),n=a(e("create-react-class")),l=a(e("prop-types")),s=a(e("pydio")),u=a(e("pydio/http/api")),c=a(e("pydio/util/pass")),d=a(e("pydio/model/node")),p=s.default.requireLib("hoc").ModernTextField,l=(0,n.default)({displayName:"CreateUserForm",propTypes:{dataModel:l.default.instanceOf(PydioDataModel),openRoleEditor:l.default.func},mixins:[AdminComponents.MessagesConsumerMixin,PydioReactUI.ActionDialogMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],getDefaultProps:function(){return{dialogSize:"sm",dialogTitleId:"ajxp_admin.user.19"}},getInitialState:function(){var e=c.default.getState();return o({step:1},e)},checkPassword:function(){var e=this.refs.pass.getValue(),t=this.refs.passconf.getValue();this.setState(c.default.getState(e,t,this.state))},checkLogin:function(e,t){t=c.default.isValidLogin(t);this.setState({loginErrorText:t})},submit:function(){var r,o,a,e,i=this;this.state.valid&&!this.state.loginErrorText?(r=this.props.dataModel.getUniqueNode()||this.props.dataModel.getContextNode(),(o=r.getPath()).startsWith("/idm/users")&&(o=o.substr("/idm/users".length)),a=this.refs.user_id.getValue(),e=this.refs.pass.getValue(),u.default.getRestClient().getIdmApi().createUser(o,a,e).then(function(e){i.dismiss(),r.reload();var t=new d.default(o+"/"+a,!0);t.getMetadata().set("ajxp_mime","user"),t.getMetadata().set("IdmUser",e),i.props.openRoleEditor(t)})):this.props.pydio.UI.displayMessage("ERROR",this.state.passErrorText||this.state.confirmErrorText||this.state.loginErrorText)},render:function(){var e=(this.props.dataModel.getUniqueNode()||this.props.dataModel.getContextNode()).getPath(),t=void 0;return e.startsWith("/idm/users")&&(t=(t=e.substr("/idm/users".length))&&i.default.createElement("div",null,this.context.getMessage("ajxp_admin.user.20").replace("%s",t))),i.default.createElement("div",{style:{width:"100%"}},t,i.default.createElement("form",{autoComplete:"off"},i.default.createElement("div",{style:{width:"100%"}},i.default.createElement(p,{ref:"user_id",onChange:this.checkLogin,fullWidth:!0,floatingLabelText:this.context.getMessage("ajxp_admin.user.21"),errorText:this.state.loginErrorText,autoComplete:"nope"})),i.default.createElement("div",null,i.default.createElement(p,{ref:"pass",type:"password",floatingLabelText:this.context.getMessage("ajxp_admin.user.22"),onChange:this.checkPassword,fullWidth:!0,errorText:this.state.passErrorText||this.state.passHintText,autoComplete:"new-password"})),i.default.createElement("div",null,i.default.createElement(p,{ref:"passconf",type:"password",floatingLabelText:this.context.getMessage("ajxp_admin.user.23"),onChange:this.checkPassword,fullWidth:!0,errorText:this.state.confirmErrorText,autoComplete:"confirm-password"}))))}});r.default=l,t.exports=r.default},{"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/pass":"pydio/util/pass",react:"react"}],48:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var a=o(e("react")),i=o(e("pydio")),n=o(e("prop-types")),l=o(e("create-react-class")),s=o(e("pydio/model/data-model")),u=e("material-ui"),c=i.default.requireLib("hoc"),d=c.ModernTextField,p=(c.ModernSelectField,i.default.requireLib("components").FoldersTree),f=i.default.requireLib("boot"),e=f.ActionDialogMixin,c=f.CancelButtonProviderMixin,f=f.SubmitButtonProviderMixin,f=(0,l.default)({propTypes:{dataModel:n.default.instanceOf(s.default),submitValue:n.default.func.isRequired},mixins:[e,c,f],getDefaultProps:function(){return{dialogTitle:"Move",dialogIsModal:!0,dialogScrollBody:!0}},submit:function(){var e=this.state,t=e.selectedNode,e=e.selectedPath;this.props.submitValue(e,t),this.dismiss()},getInitialState:function(){return{selectedNode:this.props.dataModel.getContextNode(),selectedPath:"/"}},onNodeSelected:function(e){var t=this.props.dataModel;e.load(t.getAjxpNodeProvider());t=t.getContextNode().getPath(),t=new RegExp("^"+t),t=e.getPath().replace(t,"");this.setState({selectedNode:e,selectedPath:t})},render:function(){var e=this.state.selectedPath;return a.default.createElement("div",{style:{width:"100%"}},a.default.createElement("div",{style:{fontSize:13}},i.default.getMessages()["ajxp_admin.user.moveto.hint"]),a.default.createElement(u.Paper,{zDepth:0,style:{height:300,overflowX:"auto",color:"#546E7A",fontSize:14,padding:"6px 0px",backgroundColor:"rgb(246, 246, 248)",marginTop:4}},a.default.createElement("div",{style:{marginTop:-41,marginLeft:-21}},a.default.createElement(p,{pydio:this.props.pydio,dataModel:this.props.dataModel,rootNode:this.props.dataModel.getContextNode(),onNodeSelected:this.onNodeSelected,showRoot:!0,draggable:!1}))),a.default.createElement("div",null,a.default.createElement(d,{variant:"v2",fullWidth:!0,hintText:this.props.pydio.MessageHash[373],ref:"input",value:e,disabled:!1,onChange:function(){}})))}});r.default=f,t.exports=r.default},{"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],49:[function(e,t,r){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var a=o(e("./board/Dashboard")),i=o(e("./board/RolesDashboard")),n=o(e("./board/PoliciesBoard")),l=o(e("./board/Callbacks")),s=o(e("./forms/CreateUserForm")),u=o(e("./forms/CreateRoleOrGroupForm")),c=o(e("./forms/TreeGroupsDialog")),d=o(e("./editor/ACL")),p=o(e("./editor/Info")),f=o(e("./editor/Model")),m=o(e("./editor/Params")),h=o(e("./editor/User")),e=o(e("./editor/Util"));window.AdminPeople={Callbacks:l.default,Dashboard:a.default,RolesDashboard:i.default,PoliciesBoard:n.default,Editor:{Model:f.default,Info:p.default,ACL:d.default,Params:m.default,User:h.default,Util:e.default},Forms:{CreateUserForm:s.default,CreateRoleOrGroupForm:u.default},TreeGroupsDialog:c.default}},{"./board/Callbacks":1,"./board/Dashboard":2,"./board/PoliciesBoard":3,"./board/RolesDashboard":4,"./editor/ACL":11,"./editor/Info":16,"./editor/Model":19,"./editor/Params":24,"./editor/User":27,"./editor/Util":31,"./forms/CreateRoleOrGroupForm":46,"./forms/CreateUserForm":47,"./forms/TreeGroupsDialog":48}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("pydio")),m=n(e("react")),h=n(e("./Rule")),y=e("material-ui"),s=e("uuid"),g=l.default.requireLib("hoc").ModernTextField,o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,m["default"].Component),o(u,[{key:"componentWillReceiveProps",value:function(e){this.setState({policy:e.policy})}},{key:"componentDidMount",value:function(){this.props.newPolicyWithRule&&this.onAddRule(null,this.props.newPolicyWithRule)}},{key:"onNameChange",value:function(e){var t=f({},this.state.policy);t.Name=e,this.props.savePolicy(t)}},{key:"onDescriptionChange",value:function(e){var t=f({},this.state.policy);t.Description=e,this.props.savePolicy(t)}},{key:"saveLabels",value:function(){var e=this.state,t=e.pName,r=e.pDesc,e=e.policy;t&&(e.Name=t),r&&(e.Description=r),this.setState({pName:null,pDesc:null}),this.props.savePolicy(e)}},{key:"onRuleChange",value:function(t){var e=f({},this.state.policy);e.Policies?(e.Policies=e.Policies.filter(function(e){return e.id!==t.id}),e.Policies.push(t)):e.Policies=[t],this.props.savePolicy(e)}},{key:"onRemoveRule",value:function(t){var e=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],r=f({},this.state.policy);r.Policies=r.Policies.filter(function(e){return e.id!==t.id}),this.props.savePolicy(r,e)}},{key:"onAddRule",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?"":arguments[1],o=f({},this.state.policy);o.Policies||(o.Policies=[]);var a=(0,s.v4)(),i=[],n=[];"acl"===o.ResourceGroup?(i=["policy:"+o.Uuid],n=["acl"]):"oidc"===o.ResourceGroup&&(n=["oidc"]),o.Policies.push({id:a,description:r,actions:[],subjects:i,resources:n,effect:"deny"}),this.setState({policy:o,openRule:a},function(){t.setState({openRule:null})})}},{key:"render",value:function(){function e(e){return i.MessageHash["ajxp_admin.policies."+e]||e}var t,r=this,o=this.props,a=o.readonly,i=o.pydio,n=this.state,l=n.policy,s=n.openRule,u=l.Policies.map(function(e,t){return m.default.createElement(h.default,f({},r.props,{key:e.description,rule:e,isLast:t===l.Policies.length-1,create:s===e.id,onRuleChange:r.onRuleChange.bind(r),onRemoveRule:r.onRemoveRule.bind(r)}))}),c={iconStyle:{fontSize:18,color:"rgba(0,0,0,.33)"},style:{padding:8,width:36,height:36},tooltipPosition:"top-right"},d=m.default.createElement("div",{style:{display:"flex",alignItems:"center"}},m.default.createElement("div",{style:{fontSize:14,fontWeight:500}},"Rules"),!a&&m.default.createElement(y.IconButton,f({iconClassName:"mdi mdi-plus",tooltip:e("rule.create"),onClick:this.onAddRule.bind(this)},c,{tooltipPosition:"bottom-right"}))),p=void 0;return a||(o=r.state,t=o.showLabels,n=o.pName,a=o.pDesc,o=n&&n!==l.Name||a&&a!==l.Description,p=m.default.createElement("div",{style:{marginTop:10,paddingTop:10}},m.default.createElement("div",{style:{display:"flex",alignItems:"center"}},m.default.createElement("div",{style:{fontSize:14,fontWeight:500}},"Edit Labels"),m.default.createElement(y.IconButton,f({iconClassName:"mdi mdi-chevron-"+(t?"down":"right"),tooltip:e("policy.editLabels"),onClick:function(){return r.setState({showLabels:!t})}},c))),m.default.createElement("div",{style:{display:t?"flex":"none"}},m.default.createElement("div",{style:{marginRight:6,flex:1}},m.default.createElement(g,{value:n||l.Name,fullWidth:!0,onChange:function(e,t){r.setState({pName:t})}})),m.default.createElement("div",{style:{marginLeft:6,flex:1}},m.default.createElement(g,{value:a||l.Description,fullWidth:!0,onChange:function(e,t){r.setState({pDesc:t})}})),m.default.createElement("div",{style:{width:80}},m.default.createElement(y.IconButton,{disabled:!o,iconClassName:"mdi mdi-content-save",tooltip:e("policy.saveLabels"),tooltipPosition:"top-center",onClick:function(){r.saveLabels()},iconStyle:{fontSize:20,color:"rgba(0,0,0,"+(o?".43":".10")+")"},style:{padding:14}}))))),m.default.createElement("div",{style:{padding:"12px 24px",backgroundColor:"#f5f5f5"}},d,u,p)}}]),u);function u(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,e),this.state={policy:e.policy}}r.default=o,t.exports=r.default},{"./Rule":51,"material-ui":"material-ui",pydio:"pydio",react:"react",uuid:53}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var i=function(e,t,r){for(var o=!0;o;){var a=e,i=t,n=r,o=!1;null===a&&(a=Function.prototype);var l=Object.getOwnPropertyDescriptor(a,i);if(void 0!==l){if("value"in l)return l.value;var s=l.get;return void 0===s?void 0:s.call(n)}a=Object.getPrototypeOf(a);if(null===a)return;e=a,t=i,r=n,o=!0,l=void 0}};function n(e){return e&&e.__esModule?e:{default:e}}var l=n(e("react")),s=e("material-ui"),u=(n(e("pydio/util/func")),n(e("pydio/http/resources-manager")),e("../editor/util/ClassLoader")),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,l["default"].Component),o(c,[{key:"componentDidMount",value:function(){this.props.create&&this.openEditor()}},{key:"openEditor",value:function(){var t=this,e=this.props,r=e.pydio,o=e.policy,a=e.rule,i=e.openRightPane,e=e.rulesEditorClass;return!(this.refs.editor&&this.refs.editor.isDirty()&&!window.confirm(r.MessageHash["role_editor.19"]))&&(!!e&&((0,u.loadEditorClass)(e,null).then(function(e){i({COMPONENT:e,PROPS:{ref:"editor",policy:o,rule:a,pydio:r,saveRule:t.props.onRuleChange,create:t.props.create,onRequestTabClose:t.closeEditor.bind(t)}})}).catch(function(e){console.error(e)}),!0))}},{key:"closeEditor",value:function(e){var t=this.props,r=t.pydio,t=t.closeRightPane;if(e&&e.isDirty()){if(e.isCreate())return this.props.onRemoveRule(this.props.rule,!0),t(),!0;if(!window.confirm(r.MessageHash["role_editor.19"]))return!1}return t(),!0}},{key:"removeRule",value:function(){var e=this.props,t=e.pydio,r=e.onRemoveRule,o=e.rule;t.UI.openConfirmDialog({message:t.MessageHash["ajxp_admin.policies.rule.delete.confirm"],destructive:[o.description],validCallback:function(){r(o)}})}},{key:"render",value:function(){var e=this.props,t=e.rule,r=e.readonly,o=e.isLast,a="allow"===t.effect?"#33691e":"#d32f2f",e=[];r||(e=[l.default.createElement("span",{className:"mdi mdi-pencil",style:{fontSize:16,color:"rgba(0,0,0,.33)",cursor:"pointer",marginLeft:12},onClick:this.openEditor.bind(this)}),l.default.createElement("span",{className:"mdi mdi-delete",style:{fontSize:16,color:"rgba(0,0,0,.33)",cursor:"pointer",marginLeft:12},onClick:this.removeRule.bind(this)})]);l.default.createElement("div",null,t.description,e);return l.default.createElement("div",{style:{display:"flex",padding:"6px 0 5px",borderBottom:o?null:"1px solid white"}},l.default.createElement(s.FontIcon,{className:"mdi mdi-traffic-light",color:a,style:{fontSize:16,marginRight:10}}),l.default.createElement("div",{style:{flex:1}},t.description,e))}}]),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i(Object.getPrototypeOf(c.prototype),"constructor",this).apply(this,arguments)}r.default=o,t.exports=r.default},{"../editor/util/ClassLoader":44,"material-ui":"material-ui","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func",react:"react"}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;for(var o=[],a=0;a<256;++a)o[a]=(a+256).toString(16).substr(1);function i(e,t){return t=t||0,[o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]]].join("")}r.default=i,t.exports=r.default},{}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return n.default}});var o=l(e("./v1.js")),a=l(e("./v3.js")),i=l(e("./v4.js")),n=l(e("./v5.js"));function l(e){return e&&e.__esModule?e:{default:e}}},{"./v1.js":57,"./v3.js":58,"./v4.js":60,"./v5.js":61}],54:[function(e,t,r){"use strict";function d(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function l(e,t,r,o,a,i){return d((i=d(d(t,e),d(o,i)))<<(a=a)|i>>>32-a,r)}function p(e,t,r,o,a,i,n){return l(t&r|~t&o,e,t,a,i,n)}function f(e,t,r,o,a,i,n){return l(t&o|r&~o,e,t,a,i,n)}function m(e,t,r,o,a,i,n){return l(t^r^o,e,t,a,i,n)}function h(e,t,r,o,a,i,n){return l(r^(t|~o),e,t,a,i,n)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;function o(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Array(t.length);for(var r=0;r<t.length;r++)e[r]=t.charCodeAt(r)}return function(e){var t,r,o=[],a=32*e.length,i="0123456789abcdef";for(t=0;t<a;t+=8)r=e[t>>5]>>>t%32&255,r=parseInt(i.charAt(r>>>4&15)+i.charAt(15&r),16),o.push(r);return o}(function(e,t){var r,o,a,i,n;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var l=1732584193,s=-271733879,u=-1732584194,c=271733878;for(r=0;r<e.length;r+=16)l=p(o=l,a=s,i=u,n=c,e[r],7,-680876936),c=p(c,l,s,u,e[r+1],12,-389564586),u=p(u,c,l,s,e[r+2],17,606105819),s=p(s,u,c,l,e[r+3],22,-1044525330),l=p(l,s,u,c,e[r+4],7,-176418897),c=p(c,l,s,u,e[r+5],12,1200080426),u=p(u,c,l,s,e[r+6],17,-1473231341),s=p(s,u,c,l,e[r+7],22,-45705983),l=p(l,s,u,c,e[r+8],7,1770035416),c=p(c,l,s,u,e[r+9],12,-1958414417),u=p(u,c,l,s,e[r+10],17,-42063),s=p(s,u,c,l,e[r+11],22,-1990404162),l=p(l,s,u,c,e[r+12],7,1804603682),c=p(c,l,s,u,e[r+13],12,-40341101),u=p(u,c,l,s,e[r+14],17,-1502002290),s=p(s,u,c,l,e[r+15],22,1236535329),l=f(l,s,u,c,e[r+1],5,-165796510),c=f(c,l,s,u,e[r+6],9,-1069501632),u=f(u,c,l,s,e[r+11],14,643717713),s=f(s,u,c,l,e[r],20,-373897302),l=f(l,s,u,c,e[r+5],5,-701558691),c=f(c,l,s,u,e[r+10],9,38016083),u=f(u,c,l,s,e[r+15],14,-660478335),s=f(s,u,c,l,e[r+4],20,-405537848),l=f(l,s,u,c,e[r+9],5,568446438),c=f(c,l,s,u,e[r+14],9,-1019803690),u=f(u,c,l,s,e[r+3],14,-187363961),s=f(s,u,c,l,e[r+8],20,1163531501),l=f(l,s,u,c,e[r+13],5,-1444681467),c=f(c,l,s,u,e[r+2],9,-51403784),u=f(u,c,l,s,e[r+7],14,1735328473),s=f(s,u,c,l,e[r+12],20,-1926607734),l=m(l,s,u,c,e[r+5],4,-378558),c=m(c,l,s,u,e[r+8],11,-2022574463),u=m(u,c,l,s,e[r+11],16,1839030562),s=m(s,u,c,l,e[r+14],23,-35309556),l=m(l,s,u,c,e[r+1],4,-1530992060),c=m(c,l,s,u,e[r+4],11,1272893353),u=m(u,c,l,s,e[r+7],16,-155497632),s=m(s,u,c,l,e[r+10],23,-1094730640),l=m(l,s,u,c,e[r+13],4,681279174),c=m(c,l,s,u,e[r],11,-358537222),u=m(u,c,l,s,e[r+3],16,-722521979),s=m(s,u,c,l,e[r+6],23,76029189),l=m(l,s,u,c,e[r+9],4,-640364487),c=m(c,l,s,u,e[r+12],11,-421815835),u=m(u,c,l,s,e[r+15],16,530742520),s=m(s,u,c,l,e[r+2],23,-995338651),l=h(l,s,u,c,e[r],6,-198630844),c=h(c,l,s,u,e[r+7],10,1126891415),u=h(u,c,l,s,e[r+14],15,-1416354905),s=h(s,u,c,l,e[r+5],21,-57434055),l=h(l,s,u,c,e[r+12],6,1700485571),c=h(c,l,s,u,e[r+3],10,-1894986606),u=h(u,c,l,s,e[r+10],15,-1051523),s=h(s,u,c,l,e[r+1],21,-2054922799),l=h(l,s,u,c,e[r+8],6,1873313359),c=h(c,l,s,u,e[r+15],10,-30611744),u=h(u,c,l,s,e[r+6],15,-1560198380),s=h(s,u,c,l,e[r+13],21,1309151649),l=h(l,s,u,c,e[r+4],6,-145523070),c=h(c,l,s,u,e[r+11],10,-1120210379),u=h(u,c,l,s,e[r+2],15,718787259),s=h(s,u,c,l,e[r+9],21,-343485551),l=d(l,o),s=d(s,a),u=d(u,i),c=d(c,n);return[l,s,u,c]}(function(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var o=8*e.length;for(t=0;t<o;t+=8)r[t>>5]|=(255&e[t/8])<<t%32;return r}(e),8*e.length))}r.default=o,t.exports=r.default},{}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(o)return o(a);throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")};var o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),a=new Uint8Array(16);t.exports=r.default},{}],56:[function(e,t,r){"use strict";function g(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;function o(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var o=unescape(encodeURIComponent(e));e=new Array(o.length);for(var a=0;a<o.length;a++)e[a]=o.charCodeAt(a)}e.push(128);for(var i=e.length/4+2,n=Math.ceil(i/16),l=new Array(n),a=0;a<n;a++){l[a]=new Array(16);for(var s=0;s<16;s++)l[a][s]=e[64*a+4*s]<<24|e[64*a+4*s+1]<<16|e[64*a+4*s+2]<<8|e[64*a+4*s+3]}for(l[n-1][14]=8*(e.length-1)/Math.pow(2,32),l[n-1][14]=Math.floor(l[n-1][14]),l[n-1][15]=8*(e.length-1)&4294967295,a=0;a<n;a++){for(var u=new Array(80),c=0;c<16;c++)u[c]=l[a][c];for(c=16;c<80;c++)u[c]=g(u[c-3]^u[c-8]^u[c-14]^u[c-16],1);for(var d=r[0],p=r[1],f=r[2],m=r[3],h=r[4],c=0;c<80;c++)var y=Math.floor(c/20),y=g(d,5)+function(e,t,r,o){switch(e){case 0:return t&r^~t&o;case 1:return t^r^o;case 2:return t&r^t&o^r&o;case 3:return t^r^o}}(y,p,f,m)+h+t[y]+u[c]>>>0,h=m,m=f,f=g(p,30)>>>0,p=d,d=y;r[0]=r[0]+d>>>0,r[1]=r[1]+p>>>0,r[2]=r[2]+f>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+h>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}r.default=o,t.exports=r.default},{}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c,d,p=o(e("./rng.js")),f=o(e("./bytesToUuid.js"));function o(e){return e&&e.__esModule?e:{default:e}}var m=0,h=0;e=function(e,t,r){var o=t&&r||0,a=t||[],i=(e=e||{}).node||c,n=void 0!==e.clockseq?e.clockseq:d;null!=i&&null!=n||(s=e.random||(e.rng||p.default)(),null==i&&(i=c=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==n&&(n=d=16383&(s[6]<<8|s[7])));var l=void 0!==e.msecs?e.msecs:(new Date).getTime(),r=void 0!==e.nsecs?e.nsecs:h+1,s=l-m+(r-h)/1e4;if(s<0&&void 0===e.clockseq&&(n=n+1&16383),1e4<=(r=(s<0||m<l)&&void 0===e.nsecs?0:r))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");m=l,d=n,r=(1e4*(268435455&(l+=122192928e5))+(h=r))%4294967296,a[o++]=r>>>24&255,a[o++]=r>>>16&255,a[o++]=r>>>8&255,a[o++]=255&r,l=l/4294967296*1e4&268435455,a[o++]=l>>>8&255,a[o++]=255&l,a[o++]=l>>>24&15|16,a[o++]=l>>>16&255,a[o++]=n>>>8|128,a[o++]=255&n;for(var u=0;u<6;++u)a[o+u]=i[u];return t||(0,f.default)(a)};r.default=e,t.exports=r.default},{"./bytesToUuid.js":52,"./rng.js":55}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("./v35.js")),e=a(e("./md5.js"));function a(e){return e&&e.__esModule?e:{default:e}}e=(0,o.default)("v3",48,e.default);r.default=e,t.exports=r.default},{"./md5.js":54,"./v35.js":59}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,s,u){function t(e,t,r,o){var a,i=r&&o||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)),"string"==typeof t&&(a=[],t.replace(/[a-fA-F0-9]{2}/g,function(e){a.push(parseInt(e,16))}),t=a),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(t)||16!==t.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var n=u(t.concat(e));if(n[6]=15&n[6]|s,n[8]=63&n[8]|128,r)for(var l=0;l<16;++l)r[i+l]=n[l];return r||(0,c.default)(n)}try{t.name=e}catch(e){}return t.DNS=a,t.URL=i,t},r.URL=r.DNS=void 0;var o,c=(o=e("./bytesToUuid.js"))&&o.__esModule?o:{default:o};const a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=a;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=i},{"./bytesToUuid.js":52}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./rng.js")),l=o(e("./bytesToUuid.js"));function o(e){return e&&e.__esModule?e:{default:e}}e=function(e,t,r){var o=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var i=0;i<16;++i)t[o+i]=a[i];return t||(0,l.default)(a)};r.default=e,t.exports=r.default},{"./bytesToUuid.js":52,"./rng.js":55}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=a(e("./v35.js")),e=a(e("./sha1.js"));function a(e){return e&&e.__esModule?e:{default:e}}e=(0,o.default)("v5",80,e.default);r.default=e,t.exports=r.default},{"./sha1.js":56,"./v35.js":59}]},{},[49]);